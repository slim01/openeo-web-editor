(function(t){function e(e){for(var i,a,r=e[0],c=e[1],l=e[2],h=0,d=[];h<r.length;h++)a=r[h],o[a]&&d.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(d.length)d.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,r=1;r<s.length;r++){var c=s[r];0!==o[c]&&(i=!1)}i&&(n.splice(e--,1),t=a(a.s=s[0]))}return t}var i={},o={app:0},n=[];function a(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=i,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(s,i,function(e){return t[e]}.bind(null,i));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/openeo-web-editor/demo/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"00b6":function(t,e,s){"use strict";var i=s("d89e"),o=s.n(i);o.a},"0791":function(t,e,s){"use strict";var i=s("22f1"),o=s.n(i);o.a},"18b7":function(t,e,s){},1999:function(t,e,s){},"19bb":function(t,e,s){"use strict";var i=s("51d8"),o=s.n(i);o.a},"1da2":function(t,e,s){},"22d7":function(t,e,s){"use strict";var i=s("b52e"),o=s.n(i);o.a},"22f1":function(t,e,s){},"2d07":function(t,e,s){"use strict";var i=s("5ebb"),o=s.n(i);o.a},"39fd":function(t,e,s){},"3bcc":function(t,e,s){"use strict";var i=s("785f"),o=s.n(i);o.a},"468d":function(t,e,s){},"4e87":function(t,e,s){},"51d8":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("097d");var i,o,n,a,r=s("2b0e"),c={serverUrl:"",allowServerChange:!0,defaultScript:""},l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"container"}},[s("div",{attrs:{id:"ide"}},[s("BackendPanel",{attrs:{connection:t.connection}}),s("div",{staticClass:"uiBox tabs",attrs:{id:"processGraphContent"}},[s("div",{staticClass:"tabsHeader"},[s("button",{staticClass:"tabItem",attrs:{name:"graphTab"},on:{click:t.changeProcessGraphTab}},[s("i",{staticClass:"fas fa-code-branch"}),t._v(" Visual Model Builder")]),s("button",{staticClass:"tabItem",attrs:{name:"sourceTab"},on:{click:t.changeProcessGraphTab}},[s("i",{staticClass:"fas fa-code"}),t._v(" Process Graph")]),s("div",{staticClass:"tabsActions"},[this.supports("startJob")?s("button",{attrs:{title:"Run current process graph and view results"},on:{click:t.executeProcessGraph}},[s("i",{staticClass:"fas fa-play"})]):t._e()])]),s("div",{staticClass:"tabsBody"},[s("div",{staticClass:"tabContent",attrs:{id:"graphTab"}},[s("GraphBuilderEnvironment",{ref:"graphBuilder",attrs:{active:t.isVisualBuilderActive}})],1),s("div",{staticClass:"tabContent",attrs:{id:"sourceTab"}},[s("SourceEnvironment",{ref:"sourceEditor",attrs:{active:!t.isVisualBuilderActive}})],1)])]),s("div",{directives:[{name:"show",rawName:"v-show",value:this.connection,expression:"this.connection"}],staticClass:"uiBox tabs",attrs:{id:"userContent"}},[s("div",{staticClass:"tabsHeader"},[t.supportsJobs()?s("button",{staticClass:"tabItem",attrs:{name:"jobsTab"},on:{click:t.changeUserTab}},[s("i",{staticClass:"fas fa-tasks"}),t._v(" Batch Jobs")]):t._e(),t.supportsServices()?s("button",{staticClass:"tabItem",attrs:{name:"servicesTab"},on:{click:t.changeUserTab}},[s("i",{staticClass:"fas fa-cloud"}),t._v(" Web Services")]):t._e(),t.supportsProcessGraphs()?s("button",{staticClass:"tabItem",attrs:{name:"processGraphsTab"},on:{click:t.changeUserTab}},[s("i",{staticClass:"fas fa-code-branch"}),t._v(" Process Graphs")]):t._e(),t.supportsFiles()?s("button",{staticClass:"tabItem",attrs:{name:"filesTab"},on:{click:t.changeUserTab}},[s("i",{staticClass:"fas fa-file"}),t._v(" Files")]):t._e(),s("button",{staticClass:"tabItem",attrs:{name:"accountTab"},on:{click:t.changeUserTab}},[s("i",{staticClass:"fas fa-user"}),t._v(" Account")])]),s("div",{staticClass:"tabsBody"},[t.supportsJobs()?s("div",{staticClass:"tabContent",attrs:{id:"jobsTab"}},[s("JobPanel",{attrs:{connection:t.connection}})],1):t._e(),t.supportsServices()?s("div",{staticClass:"tabContent",attrs:{id:"servicesTab"}},[s("ServicePanel",{attrs:{connection:t.connection}})],1):t._e(),t.supportsProcessGraphs()?s("div",{staticClass:"tabContent",attrs:{id:"processGraphsTab"}},[s("ProcessGraphPanel",{attrs:{connection:t.connection}})],1):t._e(),t.supportsFiles()?s("div",{staticClass:"tabContent",attrs:{id:"filesTab"}},[s("FilePanel",{attrs:{connection:t.connection}})],1):t._e(),s("div",{staticClass:"tabContent",attrs:{id:"accountTab"}},[s("AccountPanel",{attrs:{connection:t.connection}})],1)])]),t._m(0)],1),s("div",{attrs:{id:"viewer"}},[s("div",{staticClass:"uiBox tabs"},[s("div",{staticClass:"tabsHeader"},[s("button",{staticClass:"tabItem tabActive",attrs:{name:"mapTab"},on:{click:t.changeViewerTab}},[s("i",{staticClass:"fas fa-map"}),t._v(" Map")]),s("button",{staticClass:"tabItem",attrs:{name:"imageTab"},on:{click:t.changeViewerTab}},[s("i",{staticClass:"fas fa-image"}),t._v(" Images")]),s("button",{staticClass:"tabItem",attrs:{name:"dataTab"},on:{click:t.changeViewerTab}},[s("i",{staticClass:"fas fa-database"}),t._v(" Data")])]),s("div",{staticClass:"tabsBody"},[s("div",{staticClass:"tabContent tabActive",attrs:{id:"mapTab"}},[s("MapViewer",{ref:"mapViewer"})],1),s("div",{staticClass:"tabContent",attrs:{id:"imageTab"}},[s("ImageViewer",{ref:"imageViewer"})],1),s("div",{staticClass:"tabContent",attrs:{id:"dataTab"}},[s("DataViewer",{ref:"dataViewer"})],1)])])]),s("vue-snotify"),s("Modal")],1)},u=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("footer",[i("a",{attrs:{href:"http://www.openeo.org",target:"_blank"}},[i("img",{attrs:{src:s("cf05"),id:"openeoLogo"}})])])}],h=s("7618"),d=(s("a481"),s("7f7f"),new r["a"]),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dataPanel",attrs:{id:"filePanel"}},[s("h3",[t._v("User '"+t._s(t.userName)+"'")]),t.me.storage?[s("h4",[t._v("Storage")]),s("div",{staticClass:"percent"},[s("div",{staticClass:"used",style:"width: "+this.storageUsedPercent+"%"})]),s("div",[t._v("Used "+t._s(t.formatMegabyte(this.storageUsed))+" of "+t._s(t.formatMegabyte(this.me.storage.quota))+".")])]:t._e(),t.me.budget?[s("h4",[t._v("Budget")]),t._v("\n\t\t"+t._s(t.formatCurrency(t.me.budget))+"\n\t")]:t._e(),Array.isArray(t.me.links)&&t.me.links.length>0?[s("h4",[t._v("Additional resources")]),s("LinkList",{attrs:{links:t.me.links}})]:t._e()],2)},f=[],v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dataTable",attrs:{id:t.id}},[s("div",{staticClass:"dataTableMenu"},[s("div",{staticClass:"dataTableToolbar"},[t._t("toolbar")],2),t.data.length>0?s("div",{staticClass:"dataTableFilter"},[s("i",{staticClass:"fas fa-search filter-icon"}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filterValue,expression:"filterValue"}],attrs:{type:"text",placeholder:"Search term"},domProps:{value:t.filterValue},on:{input:function(e){e.target.composing||(t.filterValue=e.target.value)}}}),s("button",{attrs:{disabled:!t.hasFilter},on:{click:t.clearFilter}},[s("i",{staticClass:"fas fa-times-circle"})])]):t._e()]),t.data.length>0||"undefined"==typeof t.noDataMessage||""==t.noDataMessage?s("table",[s("tr",t._l(t.columns,function(e,i){return s("th",{directives:[{name:"show",rawName:"v-show",value:!e.hide,expression:"!col.hide"}],key:i,class:i},[t._v(t._s(e.name))])}),0),t._l(t.view,function(e,i){return s("tr",{key:i},t._l(t.columns,function(i,o){return s("td",{directives:[{name:"show",rawName:"v-show",value:!i.hide,expression:"!col.hide"}],key:o,class:o,attrs:{"data-value":!!i.stylable&&t.value(e,i,o)}},[t._t(o,[t._v("\n\t\t\t\t\t"+t._s(t.formattedValue(e,i,o))+"\n\t\t\t\t")],{row:e,col:i,id:o})],2)}),0)}),t.data.length>0&&0==t.view.length?s("tr",{staticClass:"noSearchResults"},[s("td",{attrs:{colspan:t.columnCount}},[t._v("Sorry, no element matches your search criteria.")])]):t._e()],2):t._e(),0==t.data.length?s("div",{staticClass:"noDataMessage"},[t._v(t._s(t.noDataMessage))]):t._e()])},m=[],b=(s("55dd"),s("6b54"),s("20d6"),s("a745")),g=s.n(b),y=s("a4bb"),w=s.n(y),k={name:"DataTable",props:["id","columns","dataSource"],data:function(){return{data:[],view:[],filterValue:null,primaryKey:null,noDataMessage:"No data specified."}},watch:{data:function(t,e){this.updateView()},filterValue:function(t,e){this.updateView()}},computed:{columnCount:function(){return w()(this.columns).length},hasFilter:function(){return"string"===typeof this.filterValue&&this.filterValue.length>0}},created:function(){this.determinePrimaryKey()},methods:{determinePrimaryKey:function(){for(var t in this.columns)if(this.columns[t].primaryKey){this.primaryKey=t;break}},setNoData:function(t){this.data=[],"string"!=typeof t?"object"!=Object(h["a"])(t)||("object"===Object(h["a"])(t.data)&&"object"===Object(h["a"])(t.config)&&"object"===Object(h["a"])(t.headers)&&(t=t.data),"object"!==Object(h["a"])(t)||"string"!==typeof t.message)?(console.log(t),this.noDataMessage="Sorry, an unknown error has occured."):this.noDataMessage=t.message:this.noDataMessage=t},retrieveData:function(){var t=this;this.setNoData("Loading data..."),this.data=[],"function"===typeof this.dataSource?this.dataSource().then(function(e){g()(e)?0==e.length?t.setNoData(""):t.setData(e):t.setNoData("Invalid response from data source.")}).catch(function(e){t.setNoData(e)}):g()(this.dataSource)?0==this.dataSource.length?this.setNoData(""):this.setData(this.dataSource):this.setNoData("No valid data source specified.")},setData:function(t){this.noDataMessage=void 0,this.data=t},removeData:function(t){var e=this;if(null===this.primaryKey)throw new Error("No primary key specified.");this.data=this.data.filter(function(s){return s[e.primaryKey]!=t}),0==this.data.length&&this.setNoData("")},addData:function(t){if(!t.hasOwnProperty(this.primaryKey))throw new Error("Object does not contain a value for the primary key.");this.data.push(t)},replaceData:function(t){var e=this;if(null===this.primaryKey)throw new Error("No primary key specified.");if(!t.hasOwnProperty(this.primaryKey))throw new Error("Object does not contain a value for the primary key.");var s=this.data.findIndex(function(s){return s[e.primaryKey]==t[e.primaryKey]});s>=0?this.$set(this.data,s,t):this.data.push(t)},value:function(t,e,s){var i;return i="object"===Object(h["a"])(t)?t[s]:t,"object"===Object(h["a"])(e)&&"function"===typeof e.computedValue&&(i=e.computedValue(t,i)),i},formattedValue:function(t,e,s){return this.format(this.value(t,e,s),e)},sort:function(){},filter:function(){var t=this;if(this.hasFilter){var e=this.filterValue.toLowerCase();this.view=this.view.filter(function(s){for(var i in s){var o=t.columns[i];if(!("undefined"===typeof o||o.hasOwnProperty("filterable")&&!1===o.filterable)){var n=t.value(s,o,i);if(("number"===typeof n||"string"===typeof n||"boolean"===typeof n)&&(n=n.toString(),-1!==n.toLowerCase().indexOf(e)))return!0}}return!1})}},clearFilter:function(){this.filterValue="",this.updateView()},updateView:function(){g()(this.data)?(this.view=this.data,this.data.length>0&&(this.filter(),this.sort())):this.view=[]},format:function(t,e){return"string"===typeof e.format?"function"===typeof this["format"+e.format]?t=this["format"+e.format](t,e):console.log(e.format+" is an invalid formatter."):"function"===typeof e.format&&(t=e.format.call(this,t,e)),t},formatFileSize:function(t,e){if(!t)return"";var s=0==t?0:Math.floor(Math.log(t)/Math.log(1024));return 1*(t/Math.pow(1024,s)).toFixed(2)+" "+["B","kB","MB","GB","TB"][s]},formatDateTime:function(t,e){return this.$utils.formatDateTime(t)},formatUpperCase:function(t,e){return"string"===typeof t?t.toUpperCase():t}}},C=k,S=(s("6224"),s("2877")),x=Object(S["a"])(C,v,m,!1,null,null,null),_=x.exports,P={props:["connection"],methods:{supports:function(t){return this.connection&&this.connection.capabilitiesObject&&this.connection.capabilitiesObject.hasFeature(t)}}},T=P,M=Object(S["a"])(T,i,o,!1,null,null,null),D=M.exports,F={mixins:[D],components:{DataTable:_},data:function(){return{columns:{}}},computed:{userId:{get:function(){return this.connection?this.connection.getUserId():null}}},watch:{userId:function(t,e){t!==e&&this.updateData()}},created:function(){d.$on("serverChanged",this.updateData)},mounted:function(){window.setInterval(this.executeWatchers,5e3)},methods:{updateData:function(){},updateTable:function(t,e,s){this.$refs.table&&(this.supports("createJob")||this.supports("listJobs")?"string"!==typeof this.userId&&"number"!==typeof this.userId?this.$refs.table.setNoData("Please authenticate to use this feature."):this.$refs.table.retrieveData():this.$refs.table.setNoData("Sorry, this feature is not supported by the server."))}}},j=F,O=Object(S["a"])(j,n,a,!1,null,null,null),E=O.exports,I=s("4845"),U={name:"AccountPanel",mixins:[E],components:{LinkList:I["a"]},data:function(){return{me:{}}},created:function(){d.$on("serverChanged",this.updateData)},watch:{userId:function(t,e){null!==t&&this.updateData()}},computed:{userName:{get:function(){return this.userId?this.userId:"Guest"}},storageUsed:{get:function(){return"object"!==Object(h["a"])(this.me.storage)||null===this.me.storage?null:this.me.storage.quota-this.me.storage.free}},storageUsedPercent:{get:function(){return"object"!==Object(h["a"])(this.me.storage)||null===this.me.storage?null:Math.round(this.storageUsed/this.me.storage.quota*100)}}},methods:{updateData:function(){var t=this;this.connection&&this.supports("describeAccount")&&this.userId&&this.connection.describeAccount().then(function(e){return t.me=e}).catch(function(e){t.$utils.exception(t,e,"Sorry, could not load account information.")})},formatMegabyte:function(t){return Math.round(t/1048576)+" MB"},formatCurrency:function(t){var e="";return this.connection&&this.connection.capabilitiesObject&&null!==this.connection.capabilitiesObject.currency()&&(e=" "+this.connection.capabilitiesObject.currency()),t+e}}},N=U,V=(s("f012"),Object(S["a"])(N,p,f,!1,null,"24cebd1e",null)),B=V.exports,J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"uiBox dataPanel",attrs:{id:"backendPanel"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.$config.allowServerChange,expression:"$config.allowServerChange"}],staticClass:"server-toolbar"},[s("h3",[t._v("Server:")]),s("input",{directives:[{name:"model",rawName:"v-model.lazy.trim",value:t.serverUrl,expression:"serverUrl",modifiers:{lazy:!0,trim:!0}}],attrs:{id:"serverUrl",list:"serverUrls"},domProps:{value:t.serverUrl},on:{change:function(e){t.serverUrl=e.target.value.trim()},blur:function(e){t.$forceUpdate()}}}),s("button",{attrs:{title:"Select previously used server"},on:{click:t.showServerSelector}},[s("i",{staticClass:"fas fa-book"})]),s("button",{attrs:{title:"Change server"},on:{click:t.updateServerUrlFromInput}},[s("i",{staticClass:"fas fa-check"})]),s("button",{attrs:{title:"Get server information"},on:{click:t.getServerInfo}},[s("i",{staticClass:"fas fa-info"})])]),t.showCollectionSelector()&&t.showProcessSelector()?s("div",{staticClass:"discovery-toolbar"},[t.showCollectionSelector()?s("div",{staticClass:"collections-toolbar"},[s("span",[t._v("Collections:")]),s("select",{ref:"collection",attrs:{id:"collection"}},t._l(t.collections,function(e){return s("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.name))])}),0),s("button",{attrs:{id:"insertCollection",title:"Insert into script"},on:{click:t.insertCollection}},[s("i",{staticClass:"fas fa-plus"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("describeCollection"),expression:"supports('describeCollection')"}],attrs:{title:"Show details"},on:{click:t.showSelectedCollectionInfo}},[s("i",{staticClass:"fas fa-info"})])]):t._e(),t.showProcessSelector()?s("div",{staticClass:"processes-toolbar"},[s("span",[t._v("Processes:")]),s("select",{ref:"processes",attrs:{id:"processes"}},t._l(t.processes,function(e){return s("option",{key:e.name,attrs:{title:e.summary?e.summary:""},domProps:{value:e.name}},[t._v(t._s(e.name))])}),0),s("button",{attrs:{id:"insertProcesses",title:"Insert into script"},on:{click:t.insertProcess}},[s("i",{staticClass:"fas fa-plus"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("listProcesses"),expression:"supports('listProcesses')"}],attrs:{title:"Show details"},on:{click:t.showSelectedProcessInfo}},[s("i",{staticClass:"fas fa-info"})])]):t._e()]):t._e()])},G=[],A=(s("7514"),s("f499")),R=s.n(A),z={name:"BackendPanel",mixins:[D],data:function(){return{processes:[],collections:[],serverUrls:[],serverUrl:""}},watch:{serverUrls:function(t,e){localStorage.setItem("serverUrls",R()(t))}},created:function(){d.$on("changeServerUrl",this.changeServer),d.$on("serverChanged",this.discoverData),d.$on("showCollectionInfo",this.showCollectionInfo),d.$on("showProcessInfo",this.showProcessInfo)},mounted:function(){var t=localStorage.getItem("serverUrls");null!==t&&(this.serverUrls=JSON.parse(t));var e=this.$utils.param("server");this.$config.allowServerChange&&this.$utils.isUrl(e)?d.$emit("changeServerUrl",e):this.$utils.isUrl(this.$config.serverUrl)&&d.$emit("changeServerUrl",this.$config.serverUrl)},methods:{showCollectionSelector:function(){return this.supports("listCollections")&&this.collections.length>0},showProcessSelector:function(){return this.supports("listProcesses")&&this.processes.length>0},showServerSelector:function(){var t=this;d.$emit("showComponentModal","Select previously used server","List",{dataSource:this.serverUrls,actions:[{callback:function(e){return t.updateServerUrlTo(e)||!0},icon:"check",title:"Select this server"},{callback:function(e){return t.serverUrls.splice(t.serverUrls.indexOf(e),1)},icon:"trash",title:"Delete entry from history"}]})},changeServer:function(t){this.serverUrl=t,-1===this.serverUrls.indexOf(t)&&this.serverUrls.push(t)},discoverData:function(){var t=this;this.supports("listCollections")&&this.connection.listCollections().then(this.setDiscoveredCollections).catch(function(e){return t.setDiscoveredCollections([])}),this.supports("listProcesses")&&this.connection.listProcesses().then(this.setDiscoveredProcesses).catch(function(e){return t.setDiscoveredProcesses([])})},updateServerUrlFromInput:function(){"string"===typeof this.serverUrl&&this.serverUrl.length>0?this.connection&&this.serverUrl==this.connection.getBaseUrl()||d.$emit("changeServerUrl",this.serverUrl):this.$utils.error(this,"Please specify a valid server URL.")},updateServerUrlTo:function(t){this.serverUrl=t,this.updateServerUrlFromInput()},getServerInfo:function(){if(this.connection){var t={url:this.connection.getBaseUrl(),capabilities:this.connection.capabilitiesObject._data,services:this.connection.supportedServices,formats:this.connection.supportedOutputFormats};d.$emit("showComponentModal","Server information","ServerInfoPanel",t)}else this.$utils.info(this,"Not connected yet.")},showSelectedCollectionInfo:function(){this.showCollectionInfo(this.$refs.collection.value)},showCollectionInfo:function(t){var e=this;this.connection.describeCollection(t).then(function(s){d.$emit("showComponentModal",t,"CollectionPanel",{collection:s,version:e.connection.capabilitiesObject.version()})}).catch(function(t){return e.$utils.error(e,"Sorry, can't load collection details.")})},showSelectedProcessInfo:function(){this.showProcessInfo(this.$refs.processes.value)},showProcessInfo:function(t){var e=this.processes.find(function(e){return e.name==t});d.$emit("showComponentModal",t,"ProcessPanel",{process:e,version:this.connection.capabilitiesObject.version()})},insertCollection:function(){d.$emit("addCollectionToEditor",this.$refs.collection.value)},insertProcess:function(){d.$emit("addProcessToEditor",this.$refs.processes.value)},setDiscoveredCollections:function(t){for(var e in this.collections=[],t.collections)"undefined"!==typeof t.collections[e].name&&this.collections.push(t.collections[e]);d.$emit("propagateCollections",this.collections)},setDiscoveredProcesses:function(t){for(var e in this.processes=[],t.processes)"undefined"!==typeof t.processes[e].name&&this.processes.push(t.processes[e]);d.$emit("propagateProcesses",this.processes)}}},H=z,W=(s("00b6"),Object(S["a"])(H,J,G,!1,null,"2d7cdb49",null)),Y=W.exports,q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"dataViewer"}},[t.isText()?s("span",[t._v(t._s(t.nl2br(t.content)))]):s("ObjectTree",{attrs:{data:t.content}})],1)},X=[],K=s("0a37"),Q={name:"DataViewer",components:{ObjectTree:K["a"]},data:function(){return{content:null}},mounted:function(){this.reset()},methods:{isText:function(){return"string"===typeof this.content},reset:function(){this.content="Nothing to show."},showJson:function(t){this.content=t,d.$emit("showDataViewer")},showText:function(t){this.content=t,d.$emit("showDataViewer")},showBlob:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(null==s&&(s=t.type),s){case"application/json":this.$utils.blobToText(t,function(t){var s=JSON.parse(t.target.result);e.showJson(s)});break;case"text/plain":this.$utils.blobToText(t,function(t){e.showText(t.target.result)});break}},nl2br:function(t){return"undefined"===typeof t||null===t?"":(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")}}},Z=Q,tt=(s("c6f2"),Object(S["a"])(Z,q,X,!1,null,"3d91bf7a",null)),et=tt.exports,st=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"FilePanel"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.supports("uploadFile"),expression:"supports('uploadFile')"}],staticClass:"addFile"},[s("input",{attrs:{type:"file",name:"uploadUserFile",id:"uploadUserFile"}}),s("button",{directives:[{name:"show",rawName:"v-show",value:!t.uploadProgress,expression:"!uploadProgress"}],attrs:{title:"Add new file",id:"uploadUserFileBtn"},on:{click:function(e){t.uploadFile()}}},[s("i",{staticClass:"fas fa-upload"})])]),s("div",{staticClass:"percent"},[s("div",{staticClass:"used",class:{error:t.uploadErrored},style:"width: "+this.uploadProgress+"%; opacity: "+this.uploadFadeOut})]),s("DataTable",{ref:"table",attrs:{dataSource:t.listFiles,columns:t.columns},scopedSlots:t._u([{key:"actions",fn:function(e){return[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("downloadFile"),expression:"supports('downloadFile')"}],attrs:{title:"Download"},on:{click:function(s){t.downloadFile(e.row)}}},[s("i",{staticClass:"fas fa-download"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("deleteFile"),expression:"supports('deleteFile')"}],attrs:{title:"Delete"},on:{click:function(s){t.deleteFile(e.row)}}},[s("i",{staticClass:"fas fa-trash"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{attrs:{title:"Refresh files"},on:{click:function(e){t.updateData()}}},[s("i",{staticClass:"fas fa-sync-alt"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:!t.subscribed,expression:"!subscribed"}],attrs:{title:"Subscribe to all changes to the file directory"},on:{click:function(e){t.subscribeToFileChanges()}}},[s("i",{staticClass:"fas fa-bell"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.subscribed,expression:"subscribed"}],attrs:{title:"Unsubscribe from all changes to the file directory"},on:{click:function(e){t.unsubscribeFromFileChanges()}}},[s("i",{staticClass:"fas fa-bell-slash"})])])],2)],1)},it=[],ot={name:"FilePanel",mixins:[E],data:function(){return{columns:{name:{name:"Path / Name",primaryKey:!0},size:{name:"Size",format:"FileSize",filterable:!1},modified:{name:"Last modified",format:"DateTime"},actions:{name:"Actions",filterable:!1}},subscribed:!1,uploadProgress:0,uploadErrored:!1,uploadFadeOut:1}},methods:{listFiles:function(){return this.connection.listFiles()},updateData:function(){this.updateTable(this.$refs.table,"listFiles","uploadFile")},uploadFile:function(){var t=this,e=document.getElementById("uploadUserFile"),s=e.files[0];this.connection.createFile(s.name).then(function(e){return e.uploadFile(s,function(e){t.uploadProgress=e})}).then(function(i){i.setAll({name:s.name,size:s.size,modified:(new Date).toISOString()}),t.$refs.table.replaceData(i),t.uploadProgress=100,t.fadeOutUploadProgress(),e.value="",t.$utils.ok(t,"File upload completed.")}).catch(function(e){console.log(e),t.fadeOutUploadProgress(),t.$utils.exception(t,e,"Sorry, file upload failed.")})},fadeOutUploadProgress:function(){var t=this,e=setInterval(function(){t.uploadFadeOut-=.05,t.uploadFadeOut<0&&(t.uploadProgress=0,t.uploadFadeOut=1,clearInterval(e))},100)},downloadFile:function(t){this.$utils.info(this,"File requested. Please wait..."),t.downloadFile(t.name)},deleteFile:function(t){var e=this;t.deleteFile().then(function(s){e.$refs.table.removeData(t.name)}).catch(function(t){e.$utils.error(e,"Sorry, could not delete file.")})},subscribeToFileChanges:function(){this.connection.subscribe("openeo.files",{},function(t,e){console.log("File change: "+R()(t))}),this.subscribed=!0},unsubscribeFromFileChanges:function(t){this.connection.unsubscribe("openeo.files",{}),this.subscribed=!1}}},nt=ot,at=(s("9961"),Object(S["a"])(nt,st,it,!1,null,null,null)),rt=at.exports,ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"imageContainer",attrs:{id:"imageViewer"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:"text"==t.visibleContent,expression:"visibleContent == 'text'"}],ref:"emptyMsg"}),s("canvas",{directives:[{name:"show",rawName:"v-show",value:"canvas"==t.visibleContent,expression:"visibleContent == 'canvas'"}],ref:"canvas"}),s("img",{directives:[{name:"show",rawName:"v-show",value:"image"==t.visibleContent,expression:"visibleContent == 'image'"}],ref:"image"})])},lt=[],ut={name:"ImageViewer",data:function(){return{script:null,visibleContent:"text"}},mounted:function(){this.reset()},methods:{reset:function(){this.setMessage("Nothing to show.")},setMessage:function(t){this.$refs.emptyMsg.innerText=t,this.visibleContent="text",this.setCanvasSize(0,0)},showImage:function(t){var e=this;this.setMessage("Loading image..."),d.$emit("showImageViewer"),this.$refs.image.onload=function(){e.visibleContent="image"},this.$refs.image.src=t},showImageBlob:function(t){this.showImage(URL.createObjectURL(t))},showImageBase64:function(t){contentType,btoa(t);this.showImage(t)},updateCanvas:function(){this.setCanvasSize(this.$refs.image.naturalWidth,this.$refs.image.naturalHeight);var t=this.$refs.canvas.getContext("2d");t.drawImage(this.$refs.image,0,0),this.$refs.canvas.originalImage=t.getImageData(0,0,this.$refs.canvas.width,this.$refs.canvas.height),this.visibleContent="canvas"},setCanvasSize:function(t,e){this.$refs.canvas.width=this.$refs.image.naturalWidth,this.$refs.canvas.height=this.$refs.image.naturalHeight}}},ht=ut,dt=(s("2d07"),Object(S["a"])(ht,ct,lt,!1,null,null,null)),pt=dt.exports,ft=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.connection?s("DataTable",{ref:"table",attrs:{dataSource:t.listJobs,columns:t.columns,id:"JobPanel"},scopedSlots:t._u([{key:"actions",fn:function(e){return[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("describeJob"),expression:"supports('describeJob')"}],attrs:{title:"Details"},on:{click:function(s){t.showJobInfo(e.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("estimateJob"),expression:"supports('estimateJob')"}],attrs:{title:"Estimate"},on:{click:function(s){t.estimateJob(e.row)}}},[s("i",{staticClass:"fas fa-file-invoice-dollar"})]),t.isJobInactive(e.row)?s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("updateJob"),expression:"supports('updateJob')"}],attrs:{title:"Edit"},on:{click:function(s){t.editJob(e.row)}}},[s("i",{staticClass:"fas fa-edit"})]):t._e(),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("deleteJob"),expression:"supports('deleteJob')"}],attrs:{title:"Delete"},on:{click:function(s){t.deleteJob(e.row)}}},[s("i",{staticClass:"fas fa-trash"})]),t.isJobInactive(e.row)?s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("startJob"),expression:"supports('startJob')"}],attrs:{title:"Start"},on:{click:function(s){t.queueJob(e.row)}}},[s("i",{staticClass:"fas fa-play-circle"})]):t._e(),t.isJobActive(e.row)?s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("stopJob"),expression:"supports('stopJob')"}],attrs:{title:"Cancel"},on:{click:function(s){t.cancelJob(e.row)}}},[s("i",{staticClass:"fas fa-stop-circle"})]):t._e(),t.hasResults(e.row)?s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("downloadResults"),expression:"supports('downloadResults')"}],attrs:{title:"Download"},on:{click:function(s){t.downloadJob(e.row)}}},[s("i",{staticClass:"fas fa-download"})]):t._e(),t.hasResults(e.row)?s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("downloadResults"),expression:"supports('downloadResults')"}],attrs:{title:"View results"},on:{click:function(s){t.downloadJob(e.row,!0)}}},[s("i",{staticClass:"fas fa-eye"})]):t._e(),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("subscribe")&&!t.jobSubscriptions.includes(e.row),expression:"supports('subscribe') && !jobSubscriptions.includes(p.row)"}],attrs:{title:"Subscribe"},on:{click:function(s){t.subscribeToJob(e.row)}}},[s("i",{staticClass:"fas fa-bell"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("unsubscribe")&&t.jobSubscriptions.includes(e.row),expression:"supports('unsubscribe') && jobSubscriptions.includes(p.row)"}],attrs:{title:"Unsubscribe"},on:{click:function(s){t.unsubscribeFromJob(e.row)}}},[s("i",{staticClass:"fas fa-bell-slash"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("createJob"),expression:"supports('createJob')"}],attrs:{title:"Add new job"},on:{click:function(e){t.createJobFromScript()}}},[s("i",{staticClass:"fas fa-plus"}),t._v(" Add")]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("listJobs"),expression:"supports('listJobs')"}],attrs:{title:"Refresh jobs"},on:{click:function(e){t.updateData()}}},[s("i",{staticClass:"fas fa-sync-alt"})])])],2):t._e()},vt=[],mt={name:"JobPanel",mixins:[E],data:function(){return{columns:{jobId:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Title",computedValue:function(t,e){return!e&&t.jobId?"Job #"+t.jobId.toUpperCase().substr(-6):e}},status:{name:"Status",stylable:!0},submitted:{name:"Submitted",format:"DateTime"},updated:{name:"Last update",format:"DateTime"},actions:{name:"Actions",filterable:!1}},jobSubscriptions:[],watchers:[]}},created:function(){d.$on("jobCreated",this.jobCreated)},methods:{listJobs:function(){return this.connection.listJobs()},updateData:function(){this.updateTable(this.$refs.table,"listJobs","createJob")},jobCreated:function(t){var e=this;if(this.$refs.table){this.$refs.table.addData(t);var s={buttons:[]};this.supports("downloadResults")&&s.buttons.push({text:"Download",action:function(){return e.downloadJob(t)}}),this.$snotify.confirm("Job created!",null,s)}},createJob:function(t,e){var s=this;e||(e=null),this.connection.createJob(t,e).then(function(t){d.$emit("jobCreated",t)}).catch(function(t){s.$utils.exception(s,t,"Sorry, could not create a batch job.")})},createJobFromScript:function(){var t=this,e=prompt("Please specify the file format you need or leave empty for default format.","");null!==e&&d.$emit("getProcessGraph",function(s){t.createJob(s,e)})},updateJobData:function(t){this.$refs.table.replaceData(t);var e=this.watchers.findIndex(function(e){return e.jobId==t.jobId});switch(t.status.toLowerCase()){case"running":case"queued":case"unknown":-1===e&&this.watchers.push(t);break;default:delete this.watchers[e]}},deleteJob:function(t){var e=this;t.deleteJob().then(function(){e.$refs.table.removeData(t.jobId)}).catch(function(t){e.$utils.exception(e,t,"Sorry, could not delete job.")})},executeWatchers:function(){var t=this;for(var e in this.watchers)this.watchers[e].describeJob().then(function(e){return t.updateJobData(e)})},showJobInfo:function(t){var e=this;t.describeJob().then(function(t){d.$emit("showModal","Job Details",t.getAll()),e.updateJobData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not load job details.")})},estimateJob:function(t){var e=this;t.estimateJob().then(function(t){d.$emit("showModal","Job Estimate",t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not load job estimate.")})},editJob:function(t){var e=this;d.$emit("getProcessGraph",function(s){t.updateJob(s).then(function(t){e.$utils.ok(e,"Job successfully updated."),e.updateJobData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not update job.")})})},queueJob:function(t){var e=this;t.startJob().then(function(t){e.$utils.ok(e,"Job successfully queued."),e.updateJobData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not queue job.")})},cancelJob:function(t){var e=this;t.stopJob().then(function(t){e.$utils.ok(e,"Job successfully canceled."),e.updateJobData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not cancel job.")})},downloadJob:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=prompt("Please specify the file format you need or leave empty for default format.","");null!==i&&t.listResults().then(function(t){var i;0==t.links.length?e.$utils.error(e,"No download available."):i=1==t.links.length?t.links[0].href:prompt("Please specify which URL should be downloaded by typing its numer:\n"+t.links.map(function(t,e){return"["+e+"] "+t}).join("\n"),"1");var o=e.$utils.getFileNameFromURL(i);e.$utils.info(e,(s?"Data":"Download")+" requested. Please wait..."),s?e.connection.download(i).then(function(t){e.$utils.blobToText(t,function(e){d.$emit("getProcessGraph",function(e){d.$emit("showInViewer",t,e)})})}).catch(function(t){e.$utils.exception(e,t,"Sorry, an error occured.")}):e.$utils.downloadData(i,o,void 0,!0)})},subscribeToJob:function(t){var e={job_id:t};this.connection.subscribe("openeo.jobs.debug",e,function(e,s){console.log("Debugging information for job "+t+": "+R()(e))}),this.connection.subscribe("openeo.jobs.output",e,function(e,s){console.log("Output from job "+t+": "+R()(e))}),this.connection.subscribe("openeo.jobs.status",e,function(e,s){console.log("Status information for job "+t+": "+R()(e))}),this.jobSubscriptions.push(t)},unsubscribeFromJob:function(t){var e={job_id:t};this.connection.unsubscribe("openeo.jobs.debug",e),this.connection.unsubscribe("openeo.jobs.output",e),this.connection.unsubscribe("openeo.jobs.status",e),this.jobSubscriptions.splice(this.jobSubscriptions.indexOf(t),1)},hasResults:function(t){return"string"!==typeof t.status||"finished"==t.status.toLowerCase()},isJobInactive:function(t){return"string"!==typeof t.status||!this.isActiveStatusCode(t.status)},isJobActive:function(t){return"string"!==typeof t.status||this.isActiveStatusCode(t.status)},isActiveStatusCode:function(t){switch(t.toLowerCase()){case"running":case"queued":return!0;default:return!1}}}},bt=mt,gt=(s("0791"),Object(S["a"])(bt,ft,vt,!1,null,null,null)),yt=gt.exports,wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"mapCanvas"}})},kt=[],Ct=s("0a0d"),St=s.n(Ct),xt=(s("6cc5"),s("e11e")),_t=s.n(xt),$t=s("81b6"),Pt=(s("b048"),s("6005"),s("9d1c"),{name:"MapViewer",data:function(){return{options:{fullscreenControl:!0,center:[50.1725,9.15],zoom:6},map:null,baseLayer:{osm:null},layer:{},layerControl:null,sideBySideComponent:null}},mounted:function(){this.createMap(),d.$on("viewWebService",this.viewWebService),d.$on("removeWebService",this.removeWebService)},methods:{createMap:function(){this.map=new _t.a.Map("mapCanvas",this.options),this.layerControl=_t.a.control.layers(),this.layerControl.addTo(this.map),this.baseLayer.osm=_t.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{name:"OpenStreetMap",attribution:'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>'}),this.baseLayer.osm.addTo(this.map),this.layerControl.addBaseLayer(this.baseLayer.osm,this.baseLayer.osm.options.name),this.map.on("layeradd",this.onLayerAdd),this.map.on("overlayremove",this.onOverlayRemove)},onLayerAdd:function(t){var e=this.getShownLayers();2==e.length&&null===this.sideBySideComponent&&(this.sideBySideComponent=_t.a.control.sideBySide(e[0],e[1]),this.sideBySideComponent.addTo(this.map))},onOverlayRemove:function(t){var e=this.getShownLayers();2!=e.length&&null!==this.sideBySideComponent&&(this.map.removeControl(this.sideBySideComponent),this.sideBySideComponent=null)},getShownLayers:function(){var t=[];for(var e in this.layer)this.map.hasLayer(this.layer[e])&&t.push(this.layer[e]);return t},viewWebService:function(t){switch(t.type.toLowerCase()){case"wms":this.updateWMSLayer(t);break;case"xyz":this.updateXYZLayer(t);break;default:this.$utils.error("Sorry, the service type is not supported by the map.")}},removeWebService:function(t){this.layer[t]&&this.removeLayerFromMap(t)},addLayerToMap:function(t){this.layer[t].addTo(this.map),this.layerControl.addOverlay(this.layer[t],this.layer[t].options.name)},removeLayerFromMap:function(t){this.layer[t].removeFrom(this.map),this.layerControl.removeLayer(this.layer[t]),delete this.layer[t]},removeOldLayer:function(t){for(var e in this.layer)null!==this.layer[e]&&this.layer[e]!==t&&this.removeLayerFromMap(e)},updateTiffLayerBlob:function(t){this.updateTiffLayer(URL.createObjectURL(t))},updateTiffLayer:function(t){var e=this.$utils.formatDateTime(St()());if("undefined"===typeof this.layer[e]){var s=Object($t["LeafletGeotiffRenderer"])(),i={name:e+" (GeoTiff)",renderer:s};this.layer[e]=Object($t["leafletGeotiff"])(t,i),this.addLayerToMap(e)}else this.layer[e].setURL(t)},updateXYZLayer:function(t){var e=t.serviceId,s=t.url+"/{z}/{x}/{y}";if("undefined"===typeof this.layer[e]){var i={name:e.toUpperCase().substr(0,6)+" (XYZ)"};this.layer[e]=new _t.a.TileLayer(s,i),this.addLayerToMap(e)}else this.layer[e].setUrl(s,!1)},updateWMSLayer:function(t){var e=t.serviceId;if("undefined"===typeof this.layer[e]){var s=t.attributes;s.name=e.toUpperCase().substr(0,6)+" (WMS)",s.service=s.service||"WMS",s.format=s.format||"image/jpeg",this.layer[e]=_t.a.tileLayer.wms(t.url,s),this.addLayerToMap(e)}else this.layer[e].setUrl(t.url,!1)}}}),Tt=Pt,Lt=(s("6e2a"),Object(S["a"])(Tt,wt,kt,!1,null,"cd01a2c6",null)),Mt=Lt.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shown?s("div",{staticClass:"modal",attrs:{id:"modal"},on:{click:t.possiblyClose}},[s("div",{staticClass:"modal-container"},[s("h2",{staticClass:"modal-header"},[t._v("\n\t\t\t"+t._s(t.title)+"\n\t\t\t"),s("span",{staticClass:"close",on:{click:t.close}},[t._v("Ã—")])]),s("div",{staticClass:"modal-content",attrs:{id:"modal-content"}},["string"===typeof t.message?[t._v(t._s(t.message))]:"string"===typeof t.html?s("div",{domProps:{innerHTML:t._s(t.html)}}):s(t.compname,t._b({tag:"component"},"component",t.props,!1))],2)])]):t._e()},Ft=[],jt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",t._l(t.items,function(e){return s("li",{key:e},[s("a",{on:{click:function(s){t.doMainAction(e)}}},[t._v(t._s(e))]),t._l(t.actions,function(i){return s("button",{key:i.icon,attrs:{title:i.title},on:{click:function(s){t.doAction(i.callback,e)}}},[s("i",{class:"fas fa-"+i.icon})])})],2)}),0)},Ot=[],Et={name:"List",props:["dataSource","actions"],computed:{items:function(){return"function"==typeof this.dataSource?this.dataSource():this.dataSource}},methods:{doAction:function(t,e){var s=t(e);!0===s&&this.$utils.isChildOfModal(this)&&d.$emit("closeModal")},doMainAction:function(t){this.actions.length>0&&this.doAction(this.actions[0].callback,t)}}},It=Et,Ut=(s("e01b"),Object(S["a"])(It,jt,Ot,!1,null,"2203221f",null)),Nt=Ut.exports,Vt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dataPanel"},[s("form",{attrs:{id:"loginForm"},on:{submit:function(e){return e.preventDefault(),t.submitLogin(e)}}},[s("h3",[t._v("Login")]),s("label",{attrs:{for:"username"}},[t._v("Username:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{id:"username",type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),s("label",{attrs:{for:"password"}},[t._v("Password:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{id:"password",type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),s("button",{attrs:{type:"submit"}},[t._v("Login")])])])},Bt=[],Jt={name:"CredentialsForm",props:["submitLoginCallback","cancelCallback"],data:function(){return{username:"",password:""}},mounted:function(){d.$on("modalClosed",this.cancelCallback)},destroyed:function(){d.$off("modalClosed",this.cancelCallback)},methods:{submitLogin:function(t){var e=this;this.submitLoginCallback(this.username,this.password).then(function(t){e.$utils.isChildOfModal(e)&&(d.$off("modalClosed",e.cancelCallback),d.$emit("closeModal"))}).catch(function(t){})}}},Gt=Jt,At=(s("3bcc"),Object(S["a"])(Gt,Vt,Bt,!1,null,"b025bf56",null)),Rt=At.exports,zt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"docgen"},[s("Collection",{attrs:{collectionData:t.collection,version:t.version}},[s("template",{slot:"collection-spatial-extent"},[s("div",{attrs:{id:"collectionMap"}})])],2)],1)},Ht=[],Wt=s("47ed"),Yt={name:"CollectionPanel",components:{Collection:Wt["a"]},props:{version:{type:String,default:null},collection:Object},mounted:function(){var t=new _t.a.Map("collectionMap"),e=_t.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{name:"OpenStreetMap",attribution:'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>'});e.addTo(t);var s=_t.a.rectangle([[this.collection.extent.spatial[3],this.collection.extent.spatial[0]],[this.collection.extent.spatial[1],this.collection.extent.spatial[2]]]);s.addTo(t),t.fitBounds(s.getBounds())}},qt=Yt,Xt=(s("19bb"),Object(S["a"])(qt,zt,Ht,!1,null,null,null)),Kt=Xt.exports,Qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"docgen"},[s("Process",{attrs:{processData:t.process,version:t.version}})],1)},Zt=[],te=s("2b37"),ee={name:"ProcessPanel",components:{Process:te["a"]},props:{version:{type:String,default:null},process:Object}},se=ee,ie=(s("d019"),Object(S["a"])(se,Qt,Zt,!1,null,null,null)),oe=ie.exports,ne=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[0===this.editables.length?s("p",[t._v("No editable parameters available.")]):s("form",{attrs:{id:"processParameterEditor"},on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[t._l(t.editables,function(e,i){return s("div",{key:i,staticClass:"fieldRow"},[s("label",[t._v("\n\t\t\t\t"+t._s(e.label)),!0===e.meta.required?s("strong",{staticClass:"required",attrs:{title:"required"}},[t._v("*")]):t._e(),e.meta.description?s("div",{staticClass:"description"},[s("Description",{attrs:{description:e.meta.description}})],1):t._e()]),s("EditorField",{ref:e.name,refInFor:!0,attrs:{field:e,pass:e.getValue()}})],1)}),s("button",{staticClass:"save",attrs:{type:"submit"}},[t._v("Save")])],2)])},ae=[],re=s("8088"),ce=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"fieldContainer"},["temporal_extent"===t.type()?s("div",{staticClass:"fieldContainer"},[s("VueCtkDateTimePicker",{attrs:{range:!0,label:"Select start and end time",format:"YYYY-MM-DD[T]HH:mm:ss[Z]"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):"spatial_extent"===t.type()?s("div",{staticClass:"fieldContainer"},[s("div",{attrs:{id:"areaSelector"}})]):"array"===t.type()?s("div",{staticClass:"fieldContainer"},[s("draggable",{model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[s("transition-group",{attrs:{name:"arrayElements"}},t._l(t.value,function(e,i){return s("div",{key:e.id,staticClass:"fieldValue arrayElement"},[s("EditorField",{ref:"arrayFields",refInFor:!0,attrs:{field:t.field,pass:e.value,isItem:!0}}),s("button",{attrs:{type:"button"},on:{click:function(e){t.removeField(i)}}},[s("i",{staticClass:"fas fa-trash"})]),s("div",{staticClass:"mover"},[s("i",{staticClass:"fas fa-arrows-alt"})])],1)}),0)],1),s("button",{attrs:{type:"button"},on:{click:function(e){t.addField()}}},[s("i",{staticClass:"fas fa-plus"}),t._v(" Add")])],1):"enum"===t.type()?s("select",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"fieldValue",attrs:{name:t.fieldName},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.value=e.target.multiple?s:s[0]}}},t._l(t.field.getEnumChoices(),function(e,i){return s("option",{key:i,domProps:{value:e}},[t._v(t._s(e))])}),0):"boolean"===t.type()?s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"fieldValue",attrs:{type:"checkbox",name:t.fieldName},domProps:{checked:!!t.value,checked:Array.isArray(t.value)?t._i(t.value,null)>-1:t.value},on:{change:function(e){var s=t.value,i=e.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=t._i(s,n);i.checked?a<0&&(t.value=s.concat([n])):a>-1&&(t.value=s.slice(0,a).concat(s.slice(a+1)))}else t.value=o}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"fieldValue",attrs:{type:"text",name:t.fieldName},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}})])},le=[],ue=s("1516"),he=s.n(ue),de=s("e30a"),pe=s.n(de),fe=(s("b40d"),s("e814")),ve=s.n(fe);L.AreaSelect=L.Evented.extend({includes:L.Evented,options:{width:300,height:200},initialize:function(t){L.Util.setOptions(this,t),this._width=this.options.width,this._height=this.options.height},addTo:function(t){return this.map=t,this._createElements(),this._render(),this},setBounds:function(t){this.map.fitBounds(t);var e=this.map.latLngToContainerPoint(t.getSouthWest()),s=this.map.latLngToContainerPoint(t.getNorthEast());this.setDimensions({width:Math.abs(e.x-s.x),height:Math.abs(e.y-s.y)})},getBounds:function(){var t=this.map.getSize(),e=new L.Point,s=new L.Point;s.x=Math.round((t.x-this._width)/2),e.y=Math.round((t.y-this._height)/2),e.x=t.x-s.x,s.y=t.y-e.y;var i=this.map.containerPointToLatLng(s),o=this.map.containerPointToLatLng(e);return new L.LatLngBounds(i,o)},remove:function(){this.map.off("moveend",this._onMapChange),this.map.off("zoomend",this._onMapChange),this.map.off("resize",this._onMapResize),this._container.parentNode.removeChild(this._container)},setDimensions:function(t){t&&(this._height=ve()(t.height)||this._height,this._width=ve()(t.width)||this._width,this._render(),this.fire("change"))},_createElements:function(){this._container||(this._container=L.DomUtil.create("div","leaflet-areaselect-container",this.map._controlContainer),this._topShade=L.DomUtil.create("div","leaflet-areaselect-shade leaflet-control",this._container),this._bottomShade=L.DomUtil.create("div","leaflet-areaselect-shade leaflet-control",this._container),this._leftShade=L.DomUtil.create("div","leaflet-areaselect-shade leaflet-control",this._container),this._rightShade=L.DomUtil.create("div","leaflet-areaselect-shade leaflet-control",this._container),this._nwHandle=L.DomUtil.create("div","leaflet-areaselect-handle leaflet-control",this._container),this._swHandle=L.DomUtil.create("div","leaflet-areaselect-handle leaflet-control",this._container),this._neHandle=L.DomUtil.create("div","leaflet-areaselect-handle leaflet-control",this._container),this._seHandle=L.DomUtil.create("div","leaflet-areaselect-handle leaflet-control",this._container),this._setUpHandlerEvents(this._nwHandle),this._setUpHandlerEvents(this._neHandle,-1,1),this._setUpHandlerEvents(this._swHandle,1,-1),this._setUpHandlerEvents(this._seHandle,-1,-1),this.map.on("moveend",this._onMapChange,this),this.map.on("zoomend",this._onMapChange,this),this.map.on("resize",this._onMapResize,this),this.fire("change"))},_setUpHandlerEvents:function(t,e,s){e=e||1,s=s||1;var i=this;function o(n){n.stopPropagation(),i.map.dragging.disable(),L.DomEvent.removeListener(this,"mousedown",o);var a=n.pageX,r=n.pageY,c=i.map.getSize();function l(t){i._width+=2*(a-t.originalEvent.pageX)*e,i._height+=2*(r-t.originalEvent.pageY)*s,i._width=Math.max(30,i._width),i._height=Math.max(30,i._height),i._width=Math.min(c.x-30,i._width),i._height=Math.min(c.y-30,i._height),a=t.originalEvent.pageX,r=t.originalEvent.pageY,i._render()}function u(e){i.map.dragging.enable(),L.DomEvent.removeListener(i.map,"mouseup",u),L.DomEvent.removeListener(i.map,"mousemove",l),L.DomEvent.addListener(t,"mousedown",o),i.fire("change")}L.DomEvent.addListener(i.map,"mousemove",l),L.DomEvent.addListener(i.map,"mouseup",u)}L.DomEvent.addListener(t,"mousedown",o)},_onMapResize:function(){this._render()},_onMapChange:function(){this.fire("change")},_render:function(){var t=this.map.getSize(),e=Math.round(this._nwHandle.offsetWidth/2),s=Math.round((t.y-this._height)/2),i=Math.round((t.x-this._width)/2);function o(t,e){t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.top=e.top+"px",t.style.left=e.left+"px",t.style.bottom=e.bottom+"px",t.style.right=e.right+"px"}o(this._topShade,{width:t.x,height:s,top:0,left:0}),o(this._bottomShade,{width:t.x,height:s,bottom:0,left:0}),o(this._leftShade,{width:i,height:t.y-2*s,top:s,left:0}),o(this._rightShade,{width:i,height:t.y-2*s,top:s,right:0}),o(this._nwHandle,{left:i-e,top:s-7}),o(this._neHandle,{right:i-e,top:s-7}),o(this._swHandle,{left:i-e,bottom:s-7}),o(this._seHandle,{right:i-e,bottom:s-7})}}),L.areaSelect=function(t){return new L.AreaSelect(t)};L.areaSelect,s("39fd");var me={name:"EditorField",components:{draggable:he.a,VueCtkDateTimePicker:pe.a},props:{field:Object,pass:{},isItem:{type:Boolean,default:!1}},data:function(){var t;if("temporal_extent"===this.type()&&g()(this.$props.pass)&&this.$props.pass.length>=2)t={start:this.$props.pass[0],end:this.$props.pass[1]};else if("array"===this.type())for(var e in t=[],this.$props.pass)t.push({id:e,value:this.$props.pass[e]});else t=this.$props.pass;return{value:t}},mounted:function(){var t=this;if("spatial_extent"===this.getFormat()){var e=new _t.a.Map("areaSelector"),s=_t.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{name:"OpenStreetMap",attribution:'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>'});s.addTo(e);var i=_t.a.areaSelect();i.addTo(e),null!==this.value&&"object"===Object(h["a"])(this.value)&&w()(this.value).length>=4?(this.value=_t.a.latLngBounds(_t.a.latLng(this.value.south,this.value.west),_t.a.latLng(this.value.north,this.value.east)),i.setBounds(this.value)):(e.setView([0,0],1),this.value=i.getBounds()),i.on("change",function(){t.value=i.getBounds()})}},computed:{fieldName:function(){return this.field.name+(this.field.isArray?"[]":"")}},methods:{type:function(){return"temporal_extent"===this.getFormat()?"temporal_extent":"spatial_extent"===this.getFormat()?"spatial_extent":this.field.isArray&&!this.isItem?"array":this.field.isEnum()?"enum":"boolean"===this.field.type?"boolean":"string"},getValue:function(){if("temporal_extent"===this.type())return[this.value.start,this.value.end];if("spatial_extent"===this.type())return{west:+this.value.getWest().toFixed(6),south:+this.value.getSouth().toFixed(6),east:+this.value.getEast().toFixed(6),north:+this.value.getNorth().toFixed(6)};if("array"===this.type()){var t=[];for(var e in this.$refs.arrayFields)t.push(this.$refs.arrayFields[e].getValue());return t}return this.value},getFormat:function(){return this.field.meta.schema.format},addField:function(){return this.value.push({id:this.value.length,value:null}),!1},removeField:function(t){return this.value.splice(t,1),!1}}},be=me,ge=(s("ea51"),Object(S["a"])(be,ce,le,!1,null,"75743d0c",null)),ye=ge.exports,we={name:"ProcessParameterEditor",components:{Description:re["a"],EditorField:ye},props:["editables","saveCallback"],methods:{save:function(){var t={};for(var e in this.$refs)t[e]=this.$refs[e][0].getValue();return this.saveCallback(t)}}},ke=we,Ce=(s("ef28"),s("63ff"),Object(S["a"])(ke,ne,ae,!1,null,"dc04f5ac",null)),Se=Ce.exports,xe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"vue-component server-info"},[s("Capabilities",{attrs:{capabilities:t.capabilities,url:t.url}}),s("h3",[t._v("Supported secondary web service types")]),s("SupportedServiceTypes",{attrs:{version:t.capabilities.version,services:t.services}}),s("h3",[t._v("Supported output file formats")]),s("SupportedFileFormats",{attrs:{version:t.capabilities.version,formats:t.formats}})],1)},_e=[],$e=s("f0df"),Pe=s("ca30"),Te=s("48d5"),Le={name:"ServerInfoPanel",components:{Capabilities:$e["a"],SupportedFileFormats:Pe["a"],SupportedServiceTypes:Te["a"]},props:["url","capabilities","formats","services"]},Me=Le,De=(s("e133"),Object(S["a"])(Me,xe,_e,!1,null,null,null)),Fe=De.exports,je={name:"Modal",components:{CredentialsForm:Rt,CollectionPanel:Kt,List:Nt,ProcessPanel:oe,ProcessParameterEditor:Se,ObjectTree:K["a"],ServerInfoPanel:Fe},data:function(){return{title:"",message:null,html:null,props:null,compname:null,shown:!1}},mounted:function(){d.$on("showModal",this.showModal),d.$on("showComponentModal",this.showComponentModal),d.$on("closeModal",this.close)},methods:{escCloseListener:function(t){if("Escape"==t.key)return d.$emit("closeModal"),t.preventDefault(),t.stopPropagation(),!1},show:function(){window.addEventListener("keydown",this.escCloseListener),this.shown=!0},close:function(){this.shown=!1,window.removeEventListener("keydown",this.escCloseListener),d.$emit("modalClosed")},possiblyClose:function(t){t.target==document.getElementById("modal")&&this.close()},initCommonModal:function(t){this.title=t,this.message=null,this.html=null,this.compname=null,this.props=null},initTextModal:function(t,e){this.initCommonModal(t),this.message=e},initHtmlModal:function(t,e){this.initCommonModal(t),this.html=e},initComponentModal:function(t,e,s){this.initCommonModal(t),this.compname=e,this.props=s},showModal:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];"string"===typeof e?(s?this.initHtmlModal(t,e):this.initTextModal(t,e),this.show()):this.showComponentModal(t,"ObjectTree",{data:e})},showComponentModal:function(t,e,s){this.initComponentModal(t,e,s),this.show()}}},Oe=je,Ee=(s("22d7"),Object(S["a"])(Oe,Dt,Ft,!1,null,null,null)),Ie=Ee.exports,Ue=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"GraphBuilderEnvironment"}},[s("div",{staticClass:"sourceHeader"},[s("div",{staticClass:"sourceToolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.blocks.hasUndo(),expression:"blocks.hasUndo()"}],staticClass:"sep",attrs:{title:"Undo last change"},on:{click:function(e){t.blocks.undo()}}},[s("i",{staticClass:"fas fa-undo-alt"})]),s("button",{class:{compactActive:this.blocks.compactMode},attrs:{title:"Compact Mode"},on:{click:function(e){t.blocks.toggleCompact()}}},[s("i",{staticClass:"fas fa-compress-arrows-alt"})]),s("button",{staticClass:"sep",attrs:{title:"Scale to perfect size"},on:{click:function(e){t.blocks.perfectScale()}}},[s("i",{staticClass:"fas fa-arrows-alt"})]),s("button",{attrs:{title:"Generate Process Graph"},on:{click:t.convertModel}},[s("i",{staticClass:"fas fa-code"})])])]),s("div",{attrs:{id:"pgEditor"}})])},Ne=[],Ve=(s("ac6a"),s("5176")),Be=s.n(Ve),Je=function(t){this.historySize=30,this.blocks=t,this.history=[]};Je.prototype.save=function(){this.history.push(this.blocks.export()),this.history.length>this.historySize&&this.history.shift()},Je.prototype.size=function(){return this.history.length},Je.prototype.restoreLast=function(){if(this.history.length){var t=this.history.pop();this.blocks.importData(t)}};var Ge=Je,Ae=(s("28a5"),s("6762"),s("2fdb"),function(t){this.meta=t,this.attrs=t.attrs,"undefined"==typeof this.meta.schema.type?this.type="string":g()(this.meta.schema.type)?this.type=this.meta.schema.type[0]:this.type=this.meta.schema.type,this.isArray=!1;var e=this.meta.schema;("array"===e.type||g()(e.type)&&e.type.includes("array"))&&(this.isArray=!0,this.type=e.items.type),this.card="card"in t?t.card:"*",this.card=this.parseCardinality(this.card,"output"==this.attrs),this.name=t.name.toLowerCase(),this.label=t.name,this.choices="enum"in t.schema?t.schema.enum:null,this.hasValue=!1,"default"in this.meta.schema?(this.value=this.meta.schema.default,this.hasValue=!0):this.isArray?this.value=[]:"string"===this.type?this.value="":"integer"===this.type||"number"===this.type?this.value=0:"boolean"===this.type?this.value=!1:this.value=null});Ae.prototype.isEnum=function(){return"choice"==this.type||this.choices},Ae.prototype.getEnumChoices=function(){return this.choices},Ae.prototype.isEditable=function(){return"eodata"!==this.meta.schema.format},Ae.prototype.getValue=function(){return this.value},Ae.prototype.getLabel=function(){return this.label},Ae.prototype.setValue=function(t){"boolean"==this.type&&(t=!!t),this.value=t,this.hasValue=!0},Ae.prototype.parseCardinality=function(t,e){var s=[0,1];if(e&&(s=[0,"*"]),void 0!=t)if("string"!=typeof t)s=[0,t];else{var i=t.split("-");s=1==i.length?[0,i[0]]:i}for(var o in s)"*"!=s[o]&&(s[o]=ve()(s[o]));return s};var Re=Ae,ze=function(t){for(var e in this.block=t,this.meta=this.block.meta,this.fields=[],this.meta.fields)this.fields.push(new Re(this.meta.fields[e]));for(var e in this.inputs=[],this.outputs=[],this.editables=[],this.indexedFields={},this.fields){var s=this.fields[e];this.indexedFields[s.name]=s,s.isEditable()&&this.editables.push(s),"input"==s.attrs&&this.inputs.push(s),"output"==s.attrs&&this.outputs.push(s)}};ze.prototype.getField=function(t){return t=t.toLowerCase(),t in this.indexedFields?this.indexedFields[t]:null},ze.prototype.show=function(){var t=this,e=this.block.meta.name+" #"+this.block.id,s={editables:this.editables,saveCallback:function(e){return t.save(e),d.$emit("closeModal"),!1}};d.$emit("showComponentModal",e,"ProcessParameterEditor",s)},ze.prototype.save=function(t){var e={};for(var s in this.indexedFields)"boolean"==this.indexedFields[s].type&&(e[s]=this.indexedFields[s]);for(var i in t){var o=i,n=!1;"[]"==o.substr(o.length-2,2)&&(o=o.substr(0,o.length-2),n=!0),null==t[i]&&n&&(t[i]=[]),o in e&&delete e[o],this.getField(o).setValue(t[i])}for(var i in e)this.getField(i).setValue(!1);this.block.render(),this.block.redraw()};var He=ze,We=function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.index=null,"undefined"===typeof e)if("string"===typeof t){var i=t.split("_");this.name=i[0],this.type=i[1],3==i.length&&(this.index=i[2])}else{if(!(g()(t)&&t.length>=2))throw"Unable to create Connector";this.name=t[0],this.type=t[1],t.length>2&&(this.index=t[2])}else this.name=t,this.type=e,null!=s&&(this.index=ve()(s))};We.prototype.id=function(){var t=this.name+"_"+this.type;return null!=this.index&&(t+="_"+this.index),t},We.prototype.isInput=function(){return"input"==this.type},We.prototype.isOutput=function(){return"output"==this.type},We.prototype.same=function(t){return this.name==t.name&&this.index==t.index&&this.type==t.type},We.prototype.export=function(){var t=[this.name,this.type];return null!==this.index&&t.push(this.index),t};var Ye=We,qe=function(t,e,s){this.blocks=t,this.meta=e,this.defaultFont=10,this.historySaved=!1,this.id=s,this.hasFocus=!1,this.div=null,this.drag=null,this.lastScale=null,this.fields=new He(this),this.x=0,this.y=0,this.ios={},this.focusedConnector=null,this.edges={},this.connectors=[]};qe.prototype.getWidth=function(){return this.hasInputs()?this.blocks.compactMode?110:170:this.blocks.compactMode?70:120},qe.prototype.hasInputs=function(){return this.fields.fields.length>1},qe.prototype.updateValues=function(){this.blocks.history.save()},qe.prototype.setValues=function(t){for(var e in t)this.fields.getField(e).setValue(t[e])},qe.prototype.getValues=function(t){t={};for(var e in this.fields.editables){var s=this.fields.editables[e];t[s.name]=s.getValue()}return t},qe.prototype.getValue=function(t){var e=this.fields.getField(t);return e?e.getValue():null},qe.prototype.htmlentities=function(t){return t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/"/g,"&quot;"),t=t.replace(/'/g,"&apos;"),t},qe.prototype.getHtml=function(){this.connectors=[];var t=this.meta.name+' <span class="blockId">#'+this.id+"</span>",e=this.meta.name+" #"+this.id,s='<div class="blockTitle"><span class="titleText" title="'+e+'">'+t+"</span>";s+='<div class="blockicon">',this.blocks.compactMode||(s+='<span class="delete" title="Remove (DEL)"><i class="fas fa-trash"></i></span>',s+='<span class="info" title="Details"><i class="fas fa-info"></i></span>'),this.fields.editables.length>0&&(s+='<span class="settings" title="Change parameter values"><i class="fas fa-sliders-h"></i></span>'),s+="</div></div>",s+='<div class="inout">';var i=this,o=function(t,e){for(var o in s+='<div class="'+t+'s">',e){var n=e[o],a=n.name.toLowerCase()+"_"+t,r="";if(n&&n.isEditable()&&!i.blocks.compactMode){var c=n.getValue();"object"===Object(h["a"])(c)?null===c?r="N/A":(r=g()(c)?"List("+c.length+")":"Object",r='<span title="'+i.htmlentities(R()(c))+'">'+r+"</span>"):r="string"===typeof c&&c.length>10?'<span title="'+i.htmlentities(R()(c))+'">'+c.substr(0,10)+"...</span>":"boolean"===typeof c?c?"âœ”ï¸":"âŒ":c,r=": "+r}var l='<div class="circle"></div>',u="";"output"==t&&(u=l,l="");var d,p=[t,"type_"+n.type,"connector",a,n.hasValue||"output"==t?"hasValue":"noValue"];d=i.blocks.compactMode&&"output"==t?"":i.htmlentities(n.getLabel()),s+='<div class="'+p.join(" ")+'" rel="'+a+'">'+l+d+r+u+"</div>",i.connectors.push(a)}s+="</div>"};return o("input",this.fields.inputs),o("output",this.fields.outputs),s+="</div>",s},qe.prototype.render=function(){this.lastScale=null,this.hasFocus=!1,this.div.html(this.getHtml()),this.initListeners(),this.redraw()},qe.prototype.maxEntry=function(t){var e=0;for(var s in this.edges)if(this.edges[s].length){var i=new Ye(s);i.name==t&&(e=Math.max(ve()(i.index)+1,e))}return e},qe.prototype.create=function(t){var e='<div id="block'+this.id+'" class="block '+this.meta["class"]+'"></div>';t.append(e),this.div=t.find("#block"+this.id),this.render()},qe.prototype.redraw=function(t){for(var e in this.div.css("margin-left",this.blocks.center.x+this.x*this.blocks.scale+"px"),this.div.css("margin-top",this.blocks.center.y+this.y*this.blocks.scale+"px"),this.blocks.showIcons&&this.blocks.scale>.8?this.div.find(".blockicon").show():this.div.find(".blockicon").hide(),this.lastScale!=this.blocks.scale&&(this.div.css("font-size",Math.round(this.blocks.scale*this.defaultFont)+"px"),this.div.css("width",Math.round(this.blocks.scale*this.getWidth())+"px"),this.lastScale=this.blocks.scale),this.connectors){var s=this.connectors[e],i=this.div.find("."+s),o=i.find(".circle");if(o.removeClass("io_active"),o.removeClass("io_selected"),i.hasClass("hasValue")||i.addClass("noValue"),s in this.edges&&this.edges[s].length)for(var n in o.addClass("io_active"),i.removeClass("noValue"),this.edges[s])this.edges[s][n].selected&&o.addClass("io_selected")}this.div.removeClass("block_selected"),t&&this.div.addClass("block_selected")},qe.prototype.initListeners=function(){var t=this;t.div.find(".blockTitle").on("mousedown",function(e){1==e.which&&(t.historySaved=!1,t.drag=[t.blocks.mouseX/t.blocks.scale-t.x,t.blocks.mouseY/t.blocks.scale-t.y])}),t.div.hover(function(){t.hasFocus=!0},function(){t.hasFocus=!1}),t.div.find(".connector").hover(function(){t.focusedConnector=$(this).attr("rel")},function(){t.focusedConnector=null}),$("html").on("mousemove",function(e){t.drag&&(t.historySaved||(t.blocks.history.save(),t.historySaved=!0),t.x=t.blocks.mouseX/t.blocks.scale-t.drag[0],t.y=t.blocks.mouseY/t.blocks.scale-t.drag[1],t.blocks.redraw())}),$("html").on("mouseup",function(){t.drag=null}),t.div.find(".connector").on("mousedown",function(e){1==e.which&&(t.blocks.beginLink(t,$(this).attr("rel")),e.preventDefault())}),t.div.find(".settings").on("click",function(){t.fields.show()}),t.div.find(".delete").on("click",function(){t.blocks.removeBlock(t.blocks.getBlockId(t))}),t.div.find(".info").on("click",function(){switch(t.meta.module){case"process":d.$emit("showProcessInfo",t.meta.name);break;case"collection":d.$emit("showCollectionInfo",t.meta.name);break}})},qe.prototype.linkPositionFor=function(t){var e=t;t instanceof Object&&(e=t.id());try{var s=this.div.find("."+e+" .circle"),i=s.offset().left-this.blocks.div.offset().left+s.width()/2,o=s.offset().top-this.blocks.div.offset().top+s.height()/2}catch(n){throw"Unable to find link position for "+e+" ("+n+")"}return{x:i,y:o}},qe.prototype.canLink=function(t){var e=[],s=t.id();s in this.edges&&(e=this.edges[s]);var i=this.fields.getField(t.name).card;return"*"==i[1]||e.length<i[1]},qe.prototype.addEdge=function(t,e){var s=[],i=t.id();void 0!=this.edges[i]&&(s=this.edges[i]),s.push(e),this.edges[i]=s},qe.prototype.eraseEdge=function(t,e){var s=t.id();if(void 0!=this.edges[s])for(var i in this.edges[s])if(this.edges[s][i]==e){this.edges[s].splice(i,1);break}},qe.prototype.erase=function(){this.div.remove()},qe.prototype.allSuccessors=function(){var t={},e=[this],s=[this.id];t[this.id]=!0;while(e.length>0){var i=e.pop();for(var o in i.edges)for(var n in i.edges[o]){var a=i.edges[o][n],r=a.fromTo();if(r[0]==i){var c=r[1];c.id in t||(t[c.id]=!0,e.push(c),s.push(c.id))}}}return s},qe.prototype.export=function(){return{id:this.id,x:this.x,y:this.y,type:this.meta.name,module:this.meta.module,values:this.getValues()}},qe.prototype.getField=function(t){return this.fields.getField(t)},qe.prototype.hasConnector=function(t){var e=this.getField(t.name);return!!e&&null==t.index};var Xe=qe,Ke=function(t,e,s,i){this.x=t,this.y=e,this.dx=s,this.dy=i};Ke.prototype.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},Ke.prototype.distanceP=function(t){var e=this.normal();e.x=t.x,e.y=t.y;var s=this.intersection(e);return[s[0],this.distance(e.alpha(s[1]),t)]},Ke.prototype.normal=function(){return new Ke(this.x,this.y,this.dy,-this.dx)},Ke.prototype.intersection=function(t){var e=this.dx,s=-t.dx,i=this.dy,o=-t.dy,n=t.x-this.x,a=t.y-this.y,r=e*o-s*i;if(0==r)return null;var c=(o*n-s*a)/r,l=(-i*n+e*a)/r;return[c,l]},Ke.prototype.alpha=function(t){var e={};return e.x=this.x+this.dx*t,e.y=this.y+this.dy*t,e};var Qe=Ke,Ze=function(t,e,s,i,o,n){if(this.blocks=n,this.label=null,this.id=ve()(t),this.block1=e,this.connector1=s,this.block2=i,this.connector2=o,this.selected=!1,this.defaultSize=3,this.defaultFontSize=10,this.position1=null,this.position2=null,this.segment=null,!e.hasConnector(s)||!i.hasConnector(o))throw"Can't create edge because a connector don't exist"};Ze.prototype.fromTo=function(){return[this.block1,this.block2]},Ze.prototype.setLabel=function(t){this.label=t},Ze.prototype.draw=function(t){this.position1=this.block1.linkPositionFor(this.connector1),this.position2=this.block2.linkPositionFor(this.connector2),this.segment=new Qe(this.position1.x,this.position1.y,this.position2.x-this.position1.x,this.position2.y-this.position1.y);var e=this.defaultSize*this.blocks.scale;if(this.selected)var s="rgba(0, 200, 0, 1)";else s="rgba(255, 200, 0, 1)";t.line(this.position1.x,this.position1.y,this.position2.x,this.position2.y,{stroke:s,strokeWidth:e});var i=(this.position1.x+this.position2.x)/2,o=(this.position1.y+this.position2.y)/2,n=Math.sqrt(Math.pow(this.position1.x-this.position2.x,2)+Math.pow(this.position1.y-this.position2.y,2)),a=30;a=a*Math.PI/180;var r=Math.cos(a),c=Math.sin(a),l=Math.cos(-a),u=Math.sin(-a),h=(this.position1.x-i)*this.blocks.scale*10/(n/2),d=(this.position1.y-o)*this.blocks.scale*10/(n/2);e=this.defaultSize*this.blocks.scale/3;if(t.line(i,o,i+(h*r-d*c),o+(d*r+h*c),{stroke:s,strokeWidth:e}),t.line(i,o,i+(h*l-d*u),o+(d*l+h*u),{stroke:s,strokeWidth:e}),null!=this.label){var p=Math.round(this.defaultFontSize*this.blocks.scale);t.text(i-2*p,o+p/3,this.label,{fontSize:p+"px",fill:"#3a3b01",stroke:"#fff",strokeWidth:2}),t.text(i-2*p,o+p/3,this.label,{fontSize:p+"px",fill:"#3a3b01"})}},Ze.prototype.collide=function(t,e){var s=this.segment.distanceP({x:t,y:e});return s[0]>=0&&s[0]<=1&&s[1]<this.defaultSize*this.blocks.scale*2&&s[0]},Ze.prototype.create=function(){if(this.block1==this.block2)throw"You can't link a block to itself";if(this.connector1.type==this.connector2.type)throw"You have to link an input with an output";if(!this.block1.canLink(this.connector1)||!this.block2.canLink(this.connector2))throw"Can't create such an edge because of the cardinalities";this.block1.addEdge(this.connector1,this),this.block2.addEdge(this.connector2,this),this.block1.render(),this.block2.render()},Ze.prototype.getTypes=function(){return[this.block1.getField(this.connector1.name).type,this.block2.getField(this.connector2.name).type]},Ze.prototype.erase=function(){this.block1.eraseEdge(this.connector1,this),this.block2.eraseEdge(this.connector2,this),this.block1.render(),this.block2.render()},Ze.prototype.same=function(t){return!(this.block1!=t.block1||this.block2!=t.block2||!this.connector1.same(t.connector1)||!this.connector2.same(t.connector2))||!(this.block1!=t.block1||this.block2!=t.block2||!this.connector1.same(t.connector2)||!this.connector2.same(t.connector1))},Ze.prototype.export=function(){return{id:this.id,block1:this.block1.id,connector1:this.connector1.export(),block2:this.block2.id,connector2:this.connector2.export()}};var ts=Ze,es=function(t){this.parentComponent=t,this.center={},this.scale=1.3,this.redrawTimeout=null,this.history=null,this.moving=null,this.isReady=!1,this.compactMode=!1,this.mouseX=0,this.mouseY=0,this.linking=null,this.selectedLink=null,this.selectedSide=null,this.selectedBlock=null,this.div=null,this.context=null,this.moduleTypes={},this.blocks=[],this.edges=[],this.id=1,this.edgeId=1,this.clear=function(){this.edges=[],this.blocks=[],this.id=1,this.edgeId=1,this.div.find(".blocks").html(""),this.redraw()},this.showIcons=!0};es.prototype.run=function(t){var e=this;$(document).ready(function(){e.div=$(t),e.div.length||alert("blocks.js: Unable to find "+t),e.div.html('<div class="blocks_js_editor"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="canvas"></svg><div class="blocks"></div></div>'),e.div.find("svg").css("width","100%"),e.div.find("svg").css("height","100%"),e.context=e.div.find("svg"),e.center.x=e.div.width()/2,e.center.y=e.div.height()/2,e.div[0].addEventListener("mousemove",function(t){e.mouseX=t.pageX-e.div.offset().left,e.mouseY=t.pageY-e.div.offset().top,e.move(t)}),$("html").on("mouseup",function(t){1==t.which&&e.release()}),e.div.on("mousedown",function(t){e.canvasClicked()&&t.preventDefault(),2!=t.which&&(e.selectedLink||e.selectedBlock||1!=t.which)||(e.moving=[e.mouseX,e.mouseY])}),e.div.on("mouseup",function(t){2!=t.which&&1!=t.which||(e.moving=null)}),e.context.svg(),$(document).on("keydown",function(t){$("input").is(":focus")||46==t.keyCode&&e.deleteEvent()}),e.div.bind("mousewheel",function(t,s,i,o){var n=e.mouseX-e.center.x,a=e.mouseY-e.center.y,r=Math.pow(1.1,o);e.center.x-=n*(r-1),e.center.y-=a*(r-1),e.scale*=r,e.redraw(),t.preventDefault()}),e.history=new Ge(e),e.isReady||e.postReady()})},es.prototype.postReady=function(){if(this.isReady=!0,void 0!=this.readyQueue)for(var t in this.readyQueue)this.readyQueue[t]()},es.prototype.ready=function(t){if(this.isReady)t();else{var e=[];void 0!=this.readyQueue&&(e=this.readyQueue),e.push(t),this.readyQueue=e}},es.prototype.getPosition=function(){var t={};return t.x=(this.mouseX-this.center.x)/this.scale,t.y=(this.mouseY-this.center.y)/this.scale,t},es.prototype.hasUndo=function(){return null===this.history?0:this.history.size()>0},es.prototype.undo=function(){null!==this.history&&this.history.restoreLast()},es.prototype.addCollection=function(t,e,s){this.addBlock(t,"collection",e,s)},es.prototype.addProcess=function(t,e,s){this.addBlock(t,"process",e,s)},es.prototype.addBlock=function(t,e,s,i){if(!(e in this.moduleTypes))throw"Invalid module type specified.";if(!(t in this.moduleTypes[e]))throw"'"+t+"' not available.";var o=this.moduleTypes[e][t],n=new Xe(this,o,this.id);n.x=s,n.y=i,n.create(this.div.find(".blocks")),this.history.save(),this.blocks.push(n),this.id++},es.prototype.registerProcess=function(t){var e=Be()({},t);for(var s in"string"===typeof e.id?e.name=e.id:e.id=e.name,e.fields=[],e.returns.name="Output",e.returns.attrs="output",e.returns.schema||(e.returns.schema={}),e.fields.push(e.returns),e.parameters)e.parameters[s].schema||(e.parameters[s].schema={}),e.parameters[s].name=s,e.parameters[s].attrs="input",e.fields.push(e.parameters[s]);this.register(e,"process")},es.prototype.registerCollection=function(t){var e=Be()({},t);"string"===typeof e.id?e.name=e.id:e.id=e.name,e.returns={name:"Output",attrs:"output",schema:{type:"object",format:"eodata"}},e.fields=[e.returns],this.register(e,"collection")},es.prototype.register=function(t,e){e in this.moduleTypes||(this.moduleTypes[e]={}),t.module=e,this.moduleTypes[e][t.name]=t},es.prototype.beginLink=function(t,e){this.linking=[t,e]},es.prototype.move=function(){if(this.selectedSide){var t=Math.sqrt(Math.pow(this.mouseX-this.selectedSide[1],2)+Math.pow(this.mouseY-this.selectedSide[2],2));if(t>15){var e=this.edges[this.selectedLink];2==this.selectedSide[0]?this.linking=[e.block1,e.connector1.id()]:this.linking=[e.block2,e.connector2.id()],this.removeEdge(this.selectedLink),this.selectedSide=null,null!=this.selectedLink&&this.selectedLink in this.edges&&(this.edges[this.selectedLink].selected=!1),this.selectedLink=null,this.redraw()}}this.moving&&(this.center.x+=this.mouseX-this.moving[0],this.center.y+=this.mouseY-this.moving[1],this.moving=[this.mouseX,this.mouseY],this.redraw()),this.linking&&this.redraw()},es.prototype.canvasClicked=function(){var t=!1;for(var e in this.selectedBlock=null,null!=this.selectedLink&&(this.edges[this.selectedLink].selected=!1),this.selectedLink=null,this.selectedSide=null,this.blocks){var s=this.blocks[e];s.hasFocus&&(this.selectedBlock=e)}if(!this.selectedBlock)for(var e in this.edges){var i=this.edges[e].collide(this.mouseX,this.mouseY);if(0!=i){i<.2?this.selectedSide=[1,this.mouseX,this.mouseY]:i>.8&&(this.selectedSide=[2,this.mouseX,this.mouseY]),this.selectedLink=e,this.edges[e].selected=!0,t=!0;break}}return this.redraw(),t},es.prototype.removeEdge=function(t){this.history.save(),this.edges[t].erase(),this.edges.splice(t,1)},es.prototype.getEdgeId=function(t){for(var e in this.edges)if(t==this.edges[e])return e;return!1},es.prototype.removeBlock=function(t){var e=this.blocks[t],s=[];for(var i in this.edges){var o=this.edges[i];o.block1==e||o.block2==e?o.erase():s.push(o)}this.edges=s,e.erase(),this.blocks.splice(this.selectedBlock,1),this.redraw()},es.prototype.getBlockId=function(t){for(var e in this.blocks)if(this.blocks[e]==t)return e;return null},es.prototype.getBlockById=function(t){for(var e in this.blocks)if(this.blocks[e].id==t)return this.blocks[e];return null},es.prototype.deleteEvent=function(){null!=this.selectedBlock&&(this.history.save(),this.removeBlock(this.selectedBlock),this.selectedBlock=null),null!=this.selectedLink&&(this.history.save(),this.removeEdge(this.selectedLink),this.selectedLink=null,this.redraw())},es.prototype.doRedraw=function(){for(var t in this.blocks)this.blocks[t].redraw(this.selectedBlock==t);var e=this.context.svg("get");for(var t in e.clear(),this.edges)this.edges[t].draw(e);if(this.linking)try{var s=this.linking[0].linkPositionFor(this.linking[1]);e.line(s.x,s.y,this.mouseX,this.mouseY,{stroke:"rgba(0,0,0,0.4)",strokeWidth:3*this.scale})}catch(i){this.linking=null}this.redrawTimeout=null},es.prototype.redraw=function(){var t=this;this.redrawTimeout||(this.redrawTimeout=setTimeout(function(){t.doRedraw()},25))},es.prototype.release=function(){this.linking&&(this.tryEndLink(),this.linking=null),$(".connector").removeClass("disabled"),this.redraw()},es.prototype.tryEndLink=function(){for(var t in this.blocks){var e=this.blocks[t];if(e.hasFocus&&e.focusedConnector){this.endLink(e,e.focusedConnector);break}}},es.prototype.endLink=function(t,e){try{var s=this.edgeId++,i=this.linking[0],o=new Ye(this.linking[1]),n=t,a=new Ye(e);if(o.isOutput())var r=new ts(s,i,o,n,a,this);else r=new ts(s,n,a,i,o,this);for(var c in this.edges){var l=this.edges[c];if(l.same(r))throw"This edge already exists"}var u=r.fromTo();if(-1!=u[1].allSuccessors().indexOf(u[0].id))throw"You can not create a loop";this.history.save(),r.create();var h=this.edges.push(r)-1,d=r.getTypes();if(!this.isTypeCompatible(d[0],d[1]))throw this.removeEdge(h),"Types "+d[0]+" and "+d[1]+" are not compatible"}catch(p){console.log("Unable to create edge:",p)}this.linking=null,this.selectedBlock=null,this.redraw()},es.prototype.isTypeCompatible=function(t,e){return t===e||("number"===t&&"integer"===e||"integer"===t&&"number"===e)},es.prototype.showError=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.parentComponent.$utils.error(this.parentComponent,t,e)},es.prototype.toggleCompact=function(){for(var t in this.compactMode=!this.compactMode,this.blocks)this.blocks[t].render();this.redraw()},es.prototype.export=function(){var t=[],e=[];for(var s in this.blocks)t.push(this.blocks[s].export());for(var s in this.edges)e.push(this.edges[s].export());return{edges:e,blocks:t}},es.prototype.importData=function(t){this.clear(),this.doLoad(t,!1)},es.prototype.load=function(t){this.doLoad(t,!0)},es.prototype.doLoad=function(t,e){var s=this;this.ready(function(){try{var i=[];if(s.id=1,s.edgeId=1,"object"!=Object(h["a"])(t)||t instanceof Array)throw"Scene is not an object";if(!("blocks"in t)||!(t.blocks instanceof Array))throw"Scene has no blocks section";if(!("edges"in t)||!(t.edges instanceof Array))throw"Scene has no blocks section";for(var o in t.blocks)try{var n=t.blocks[o],a=s.blockImport(n);s.id=Math.max(s.id,a.id+1),a.create(s.div.find(".blocks")),s.blocks.push(a)}catch(c){i.push("Block #"+o+":"+c)}for(var o in t.edges)try{n=t.edges[o];var r=s.edgeImport(n);s.edgeId=Math.max(s.edgeId,r.id+1),r.create(),s.edges.push(r)}catch(c){i.push("Edge #"+o+" :"+c)}if(i.length)for(var o in i)s.showError(i[o],"Loading error");s.redraw(),e&&s.perfectScale()}catch(c){s.showError(c,"Unable to create edge")}})},es.prototype.edgeImport=function(t){if(!1 in t)throw"An edge does not have an id";var e=this.getBlockById(t.block1),s=this.getBlockById(t.block2);if(!e||!s)throw"Error while importing an edge, a block did not exists";return new ts(t.id,e,new Ye(t.connector1),s,new Ye(t.connector2),this)},es.prototype.blockImport=function(t){if(t.module in this.moduleTypes&&t.type in this.moduleTypes[t.module]){var e=this.moduleTypes[t.module][t.type],s=new Xe(this,e,t.id);return s.x=t.x,s.y=t.y,s.setValues(t.values),s}throw"Unable to create a block of type "+t.type},es.prototype.perfectScale=function(){if(this.div){var t=null,e=null,s=null,i=null;for(var o in this.blocks){var n=this.blocks[o];null==t?(t=n.x-15,e=n.x+n.getWidth()+18,s=n.y-15,i=n.y+115):(t=Math.min(t,n.x-15),e=Math.max(e,n.x+n.getWidth()+18),s=Math.min(s,n.y-15),i=Math.max(i,n.y+115))}var a=this.div.width()/(e-t),r=this.div.height()/(i-s),c=Math.min(a,r);this.scale=c,this.center.x=this.div.width()/2-c*(t+e)/2,this.center.y=this.div.height()/2-c*(s+i)/2,this.redraw()}},es.prototype.setLabels=function(t){for(var e in this.edges){var s=this.edges[e];s.id in t&&s.setLabel(t[e])}};var ss=es,is={name:"GraphBuilderEnvironment",props:["active"],data:function(){return{blocks:null}},beforeMount:function(){this.blocks=new ss(this)},mounted:function(){this.blocks.run("#pgEditor"),d.$on("propagateCollections",this.propagateCollections),d.$on("propagateProcesses",this.propagateProcesses),d.$on("addProcessToEditor",this.insertProcess),d.$on("addCollectionToEditor",this.insertCollection)},methods:{getProcessGraph:function(t){t(this.makeProcessGraph())},convertModel:function(){var t=this.makeProcessGraph();d.$emit("showEditor"),this.$nextTick(function(){d.$emit("addSourceCode",R()(t,null,2),!0)})},makeProcessGraph:function(){var t=this.blocks.export(),e=t.edges,s=t.blocks,i={};for(var o in s){var n=s[o].id;i[n]=s[o]}var a=w()(i);for(o in e){e[o].block1ref=i[e[o].block1];var r=a.indexOf(e[o].block1.toString());r>-1&&a.splice(r,1)}1!==a.length&&alert("Error: There must be exactly one output");var c=a[0],l=this.makeProcessGraphFromEdges(e,i[c]);return console.log(R()(l,null,2)),l},makeProcessGraphFromEdges:function(t,e){if(!e)return{};var s=[];for(var i in t)t[i].block2==e.id&&s.push(this.makeProcessGraphFromEdges(t,t[i].block1ref));if("collection"==e.module)return{process_id:"get_collection",name:e.type};var o=e.values;return 1==s.length?o.imagery=s[0]:o.imagery=s,o.process_id=e.type,o},propagateProcesses:function(t){for(var e in t)this.blocks.registerProcess(t[e])},propagateCollections:function(t){for(var e in t)this.blocks.registerCollection(t[e])},insertCollection:function(t){if(this.active)try{this.blocks.addCollection(t,0,0)}catch(e){this.$utils.error(this,e.message||e)}},insertProcess:function(t){if(this.active)try{this.blocks.addProcess(t,0,0)}catch(e){this.$utils.error(this,e.message||e)}}}},os=is,ns=(s("7f59"),s("b5ac"),Object(S["a"])(os,Ue,Ne,!1,null,"745d0ecd",null)),as=ns.exports,rs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("DataTable",{ref:"table",attrs:{dataSource:t.listProcessGraphs,columns:t.columns,id:"ProcessGraphPanel"},scopedSlots:t._u([{key:"actions",fn:function(e){return[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("describeProcessGraph"),expression:"supports('describeProcessGraph')"}],attrs:{title:"Details"},on:{click:function(s){t.graphInfo(e.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("updateProcessGraph"),expression:"supports('updateProcessGraph')"}],attrs:{title:"Edit"},on:{click:function(s){t.editGraph(e.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("deleteProcessGraph"),expression:"supports('deleteProcessGraph')"}],attrs:{title:"Delete"},on:{click:function(s){t.deleteGraph(e.row)}}},[s("i",{staticClass:"fas fa-trash"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("createProcessGraph"),expression:"supports('createProcessGraph')"}],attrs:{title:"Add new process graph"},on:{click:t.addGraph}},[s("i",{staticClass:"fas fa-plus"}),t._v(" Add")]),s("button",{attrs:{title:"Refresh process graphs"},on:{click:function(e){t.updateData()}}},[s("i",{staticClass:"fas fa-sync-alt"})])])],2)},cs=[],ls={name:"ProcessGraphPanel",mixins:[E],data:function(){return{columns:{title:{name:"Title"},processGraphId:{name:"ID",primaryKey:!0},actions:{name:"Actions",filterable:!1}}}},methods:{listProcessGraphs:function(){return this.connection.listProcessGraphs()},updateData:function(){this.updateTable(this.$refs.table,"listProcessGraphs","createProcessGraph")},addGraph:function(){var t=this;d.$emit("getProcessGraph",function(e){t.connection.createProcessGraph(e).then(function(e){t.$refs.table.addData(e),t.$utils.ok(t,"Process Graph stored at back-end!")}).catch(function(e){return t.$utils.exception(t,e,"Sorry, could not save the process graph.")})})},graphInfo:function(t){var e=this;t.describeProcessGraph().then(function(t){d.$emit("showModal","Process Graph Details",t.getAll()),e.updateProcessGraphData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not load process graph.")})},editGraph:function(t){var e=this;d.$emit("getProcessGraph",function(s){var i={process_graph:s};t.updateProcessGraph(i).then(function(t){e.$utils.ok(e,"Process Graph updated!"),e.updateProcessGraphData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not update the process graph.")})})},deleteGraph:function(t){var e=this;t.deleteProcessGraph().then(function(){e.$refs.table.removeData(t.processGraphId)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not delete process graph.")})},updateProcessGraphData:function(t){this.$refs.table.replaceData(t)}}},us=ls,hs=Object(S["a"])(us,rs,cs,!1,null,null,null),ds=hs.exports,ps=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("DataTable",{ref:"table",attrs:{dataSource:t.listServices,columns:t.columns,id:"ServicePanel"},scopedSlots:t._u([{key:"enabled",fn:function(t){return[s("span",{staticClass:"enabled"},[!0===t.row.enabled?s("i",{staticClass:"fas fa-check-circle"}):!1===t.row.enabled?s("i",{staticClass:"fas fa-times-circle"}):s("i",{staticClass:"fas fa-question-circle"})])]}},{key:"actions",fn:function(e){return[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("describeService"),expression:"supports('describeService')"}],attrs:{title:"Details"},on:{click:function(s){t.serviceInfo(e.row)}}},[s("i",{staticClass:"fas fa-info"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("updateService"),expression:"supports('updateService')"}],attrs:{title:"Edit"},on:{click:function(s){t.editService(e.row)}}},[s("i",{staticClass:"fas fa-edit"})]),s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("deleteService"),expression:"supports('deleteService')"}],attrs:{title:"Delete"},on:{click:function(s){t.deleteService(e.row)}}},[s("i",{staticClass:"fas fa-trash"})]),s("button",{attrs:{title:"View on map"},on:{click:function(s){t.viewService(e.row)}}},[s("i",{staticClass:"fas fa-map"})])]}}])},[s("template",{slot:"toolbar"},[s("button",{directives:[{name:"show",rawName:"v-show",value:t.supports("createService"),expression:"supports('createService')"}],attrs:{title:"Add new service"},on:{click:function(e){t.createServiceFromScript()}}},[s("i",{staticClass:"fas fa-plus"}),t._v(" Add")]),s("button",{attrs:{title:"Refresh services"},on:{click:function(e){t.updateData()}}},[s("i",{staticClass:"fas fa-sync-alt"})])])],2)},fs=[],vs={name:"ServicePanel",mixins:[E],data:function(){return{columns:{serviceId:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Title",computedValue:function(t,e){return!e&&t.serviceId?"Service #"+t.serviceId.toUpperCase().substr(0,6):e}},type:{name:"Type",format:"UpperCase"},enabled:{name:"Enabled"},submitted:{name:"Submitted",format:"DateTime"},actions:{name:"Actions",filterable:!1}}}},created:function(){d.$on("serviceCreated",this.serviceCreated)},methods:{listServices:function(){return this.connection.listServices()},updateData:function(){this.updateTable(this.$refs.table,"listServices","createService")},serviceCreated:function(t){var e=this;if(this.$refs.table){this.$refs.table.addData(t);var s={buttons:[]};s.buttons.push({text:"View",action:function(){return e.viewService(t)}}),this.supports("describeService")&&s.buttons.push({text:"Details",action:function(){return e.serviceInfo(t)}}),this.supports("updateService")&&s.buttons.push({text:"Edit",action:function(){return e.editService(t)}}),this.supports("deleteService")&&s.buttons.push({text:"Delete",action:function(){return e.deleteService(t)}}),this.$snotify.confirm("Web Service created!",null,s)}},createService:function(t,e){var s=this;this.connection.createService(t,e).then(function(t){d.$emit("serviceCreated",t)}).catch(function(t){s.$utils.exception(s,t,"Sorry, could not create the web service.")})},createServiceFromScript:function(){var t=this,e=w()(this.connection.supportedServices);if(1==e.length)s=e[0];else{var s=prompt("Please specify the service type you want to create.\r\nOne of: ".serviceTypes.join(", "),"");if(null===s)return;-1===e.indexOf(s)&&this.$utils.error(this,"Invalid service type specified.")}d.$emit("getProcessGraph",function(e){t.createService(e,s)})},serviceInfo:function(t){var e=this;t.describeService().then(function(t){d.$emit("showModal","Web Service Details",t.getAll()),e.updateServiceData(t)}).catch(function(t){e.$utils.exception(e,t,"Sorry, could not load service information.")})},editService:function(t){var e=this;d.$emit("getProcessGraph",function(s){t.updateService(s).then(function(t){e.$utils.ok(e,"Service successfully updated."),e.updateServiceData(t)}).catch(function(t){return e.$utils.exception(e,t,"Sorry, could not update service.")})},!1)},deleteService:function(t){var e=this;t.deleteService().then(function(){e.$refs.table.removeData(t.serviceId),d.$emit("removeWebService",t.serviceId)}).catch(function(t){e.$utils.exception(e,t,"Sorry, could not delete service.")})},viewService:function(t){this.$utils.info(this,"Requesting tiles from server. Please wait..."),d.$emit("viewWebService",t),d.$emit("showMapViewer")},updateServiceData:function(t){this.$refs.table.replaceData(t)}}},ms=vs,bs=(s("916f"),Object(S["a"])(ms,ps,fs,!1,null,null,null)),gs=bs.exports,ys=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"SourceEnvironment"}},[s("div",{staticClass:"sourceHeader"},[s("h3",[s("em",{attrs:{id:"scriptName"}},[t._v(t._s(t.scriptName))])]),s("div",{staticClass:"sourceToolbar"},[s("button",{attrs:{title:"Clear current script / New script"},on:{click:t.newScript}},[s("i",{staticClass:"fas fa-file"})]),s("button",{attrs:{title:"Load script from local storage"},on:{click:function(e){t.loadScript()}}},[s("i",{staticClass:"fas fa-folder-open"})]),s("button",{attrs:{title:"Save script to local storage"},on:{click:t.saveScript}},[s("i",{staticClass:"fas fa-save"})])])]),s("div",{attrs:{id:"sourceCodeEditor"}})])},ws=[],ks=(s("a7be"),s("f9d4"),s("56b3")),Cs=s.n(ks),Ss={name:"SourceEnvironment",props:["active"],computed:{savedScriptNames:function(){return w()(this.savedScripts)}},data:function(){return{scriptName:"",savedScripts:{},editorOptions:{mode:"javascript",indentUnit:4,lineNumbers:!0},editor:null,defaultScript:this.$config.defaultScript}},watch:{savedScripts:{handler:function(t,e){localStorage.setItem("savedScripts",R()(t))},deep:!0},active:function(){this.editor.refresh()}},mounted:function(){this.editor=Cs()(document.getElementById("sourceCodeEditor"),this.editorOptions),this.editor.setValue(this.defaultScript),this.editor.setSize(null,"100%"),d.$on("addSourceCode",this.insertToEditor),d.$on("addProcessToEditor",this.insertToEditor),d.$on("addCollectionToEditor",this.insertToEditor);var t=localStorage.getItem("savedScripts");null!==t&&(this.savedScripts=JSON.parse(t))},methods:{getProcessGraph:function(t){var e=this.editor.getSelection();e||(e=this.editor.getValue());var s=null;if(e)try{s=JSON.parse(e)}catch(i){return console.log(i),void this.$utils.error(this,"The source code must be valid JSON.")}null!==s?t(s):this.$utils.error(this,"No valid model or source code specified.")},clearEditor:function(){this.editor.setValue(""),this.scriptName=""},storageName:function(t){return t.replace(".","_")},newScript:function(){var t=confirm("Do you really want to clear the existing script to create a new one?");t&&this.clearEditor()},loadScript:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0!=e){var s=this.savedScripts[e];return s?(this.editor.setValue(s),this.scriptName=e,!0):(this.$utils.info(this,'No script with the name "'+e+'" found.'),!1)}d.$emit("showComponentModal","Select script to load","List",{dataSource:function(){return t.savedScriptNames},actions:[{callback:this.loadScript,icon:"check",title:"Load script"},{callback:this.deleteScript,icon:"trash",title:"Delete script"}]})},saveScript:function(){var t=prompt("Name for the script:",this.scriptName);t&&(this.$set(this.savedScripts,this.storageName(t),this.editor.getValue()),this.scriptName=t)},deleteScript:function(t){this.$delete(this.savedScripts,t)},insertToEditor:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.active&&(e?(this.editor.setValue(t),this.scriptName=""):this.editor.replaceSelection(t))}}},xs=Ss,_s=(s("9797"),Object(S["a"])(xs,ys,ws,!1,null,"52815f5f",null)),$s=_s.exports,Ps=s("bc3a"),Ts=s.n(Ps),Ls=s("e97b");window.axios=Ts.a;var Ms={name:"openeo-web-editor",components:{AccountPanel:B,BackendPanel:Y,DataViewer:et,GraphBuilderEnvironment:as,ImageViewer:pt,FilePanel:rt,JobPanel:yt,MapViewer:Mt,Modal:Ie,ProcessGraphPanel:ds,ServicePanel:gs,SourceEnvironment:$s},data:function(){return{connection:null,isVisualBuilderActive:!0}},created:function(){d.$on("changeServerUrl",this.changeServer),d.$on("serverChanged",this.serverChanged)},mounted:function(){this.resetActiveTab("userContent"),this.resetActiveTab("processGraphContent"),d.$on("showEditor",this.showEditor),d.$on("showInViewer",this.showInViewer),d.$on("showMapViewer",this.showMapViewer),d.$on("showImageViewer",this.showImageViewer),d.$on("showDataViewer",this.showDataViewer),d.$on("getProcessGraph",this.getProcessGraph)},methods:{changeServer:function(t){var e=this;if("https:"!==window.location.protocol||"https:"===t.toLowerCase().substr(0,6))try{var s=new Ls["OpenEO"];s.connect(t).then(function(t){e.connection=t,e.requestCapabilities()})}catch(i){this.$utils.error(this,i)}else this.$utils.error(this,"You are trying to connect to a back-end with HTTP instead of HTTPS, which is insecure and prohibited by web browsers. Please use HTTPS instead.")},serverChanged:function(){this.resetActiveTab("userContent")},supports:function(t){return this.connection&&this.connection.capabilitiesObject&&this.connection.capabilitiesObject.hasFeature(t)},requestCapabilities:function(){var t=this;this.connection.capabilities().then(function(e){t.connection.capabilitiesObject=e,t.requestSupportedOutputFormats(),t.requestSupportedServices(),t.requestAuth()}).catch(function(e){console.log(e),t.$utils.error(t,"Sorry, server is not responding.")})},requestSupportedOutputFormats:function(){var t=this;this.supports("listFileTypes")&&this.connection.listFileTypes().then(function(e){return t.connection.supportedOutputFormats=e})},requestSupportedServices:function(){var t=this;this.supports("listServiceTypes")&&this.connection.listServiceTypes().then(function(e){return t.connection.supportedServices=e})},requestAuth:function(){var t=this;if(this.supports("authenticateBasic")){var e={submitLoginCallback:function(e,s){return t.connection.authenticateBasic(e,s).then(function(e){return d.$emit("serverChanged"),t.$utils.ok(t,"Login successful."),e}).catch(function(e){throw t.$utils.error(t,"Sorry, credentials are wrong."),e})},cancelCallback:function(){d.$emit("serverChanged")}};d.$emit("showComponentModal","Enter your credentials","CredentialsForm",e)}else this.supports("authenticateOIDC")?this.$utils.info(this,"Sorry, the authentication methods supported by the back-end is not supported by the Web Editor."):this.$utils.info(this,"You are working without authorization. Your data will be publicly available!")},resetActiveTab:function(t){var e=document.getElementById(t).getElementsByClassName("tabItem")[0];this.showTab(t,e.name)},setTabActive:function(t){t.className&&-1!==t.className.indexOf(" tabActive")||(t.className+=" tabActive")},supportsJobs:function(){return!(!this.connection||!this.connection.capabilitiesObject)&&(this.connection.capabilitiesObject.hasFeature("listJobs")||this.connection.capabilitiesObject.hasFeature("createJob"))},supportsServices:function(){return!(!this.connection||!this.connection.capabilitiesObject)&&(this.connection.capabilitiesObject.hasFeature("listServices")||this.connection.capabilitiesObject.hasFeature("createService"))},supportsProcessGraphs:function(){return!(!this.connection||!this.connection.capabilitiesObject)&&(this.connection.capabilitiesObject.hasFeature("listProcessGraphs")||this.connection.capabilitiesObject.hasFeature("createProcessGraph"))},supportsFiles:function(){return!(!this.connection||!this.connection.capabilitiesObject)&&(this.connection.capabilitiesObject.hasFeature("listFiles")||this.connection.capabilitiesObject.hasFeature("uploadFile"))},changeUserTab:function(t){this.changeTab("userContent",t)},changeProcessGraphTab:function(t){this.changeTab("processGraphContent",t),this.isVisualBuilderActive=this.isTabActive("graphTab")},changeViewerTab:function(t){this.changeTab("viewer",t)},changeTab:function(t,e){this.showTab(t,e.currentTarget.name)},showTab:function(t,e){for(var s=document.getElementById(t),i=s.getElementsByClassName("tabContent"),o=0;o<i.length;o++)i[o].className=i[o].className.replace(" tabActive",""),i[o].id==e&&this.setTabActive(i[o]);var n=s.getElementsByClassName("tabItem");for(o=0;o<n.length;o++)n[o].className=n[o].className.replace(" tabActive",""),n[o].name==e&&this.setTabActive(n[o])},isTabActive:function(t){var e=document.getElementById(t);return"object"===Object(h["a"])(e)&&null!==e&&"string"===typeof e.className&&-1!==e.className.indexOf(" tabActive")},showEditor:function(){this.showTab("processGraphContent","sourceTab"),this.isVisualBuilderActive=this.isTabActive("graphTab")},showMapViewer:function(){this.showTab("viewer","mapTab")},showImageViewer:function(){this.showTab("viewer","imageTab")},showDataViewer:function(){this.showTab("viewer","dataTab")},showInViewer:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!(t instanceof Blob))throw"No blob specified.";var s=t.type;switch(null===e||s&&-1!==s.indexOf("/")&&-1===s.indexOf("*")||(s=this.getMimeTypeForOutputFormat(e)),"string"===typeof s&&(s=s.toLowerCase()),s){case"image/png":case"image/jpg":case"image/jpeg":case"image/gif":this.$refs.imageViewer.showImageBlob(t);break;case"application/json":case"text/plain":this.$refs.dataViewer.showBlob(t,s);break;case"image/tif":case"image/tiff":this.$refs.mapViewer.updateTiffLayerBlob(t);break;default:this.$utils.error(this,"Sorry, the returned content type is not supported to view.")}},getProcessGraph:function(t){this.isVisualBuilderActive?this.$refs.graphBuilder.getProcessGraph(t):this.$refs.sourceEditor.getProcessGraph(t)},executeProcessGraph:function(){var t=this,e=prompt("Please specify the file format:","");null!==e&&(this.$utils.info(this,"Data requested. Please wait..."),d.$emit("getProcessGraph",function(s){t.connection.execute(s,e).then(function(t){return d.$emit("showInViewer",t,s,e)}).catch(function(e){return t.$utils.error(t,"Sorry, could not execute script.")})}))},getMimeTypeForOutputFormat:function(t){if(!t.format)return null;var e=t.format.toLowerCase();switch(e){case"png":case"jpeg":case"jpg":case"gif":return"image/"+e;case"tif":case"tiff":case"gtiff":return"image/tiff";case"json":return"application/json";default:return null}}}},Ds=Ms,Fs=(s("c8c0"),Object(S["a"])(Ds,l,u,!1,null,null,null)),js=Fs.exports,Os=s("f213"),Es=(s("fbfd"),s("4917"),s("386d"),s("59ad")),Is=s.n(Es),Us={exception:function(t,e,s){var i=null,o=s;"object"===Object(h["a"])(e)&&e.code&&"string"===typeof e.message&&(e.code>0&&(i="Error #"+e.code),o=e.message),this.error(t,o,i)},error:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.$snotify.error(e,s)},info:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.$snotify.info(e,s)},ok:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.$snotify.success(e,s)},downloadData:function(){var t=document.createElement("a");return document.body.appendChild(t),t.style="display: none",function(e,s,i){var o,n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a?o=e:(e instanceof Blob?n=e:(i||(i="application/octet-stream"),n=new Blob([e],{type:i})),s||(s="unnamed-file"),o=window.URL.createObjectURL(n));t.href=o,t.download=s,t.click(),a||window.URL.revokeObjectURL(o)}}(),blobToText:function(t,e){var s=new FileReader;s.onload=e,s.readAsText(t)},isNumeric:function(t){return!isNaN(Is()(t))&&isFinite(t)},isChildOfModal:function(t){return t.$parent&&"Modal"==t.$parent.$options.name},getFileNameFromURL:function(t){return t=t.substring(0,-1==t.indexOf("#")?t.length:t.indexOf("#")),t=t.substring(0,-1==t.indexOf("?")?t.length:t.indexOf("?")),t=t.substring(t.lastIndexOf("/")+1,t.length),t},formatDateTime:function(t){if(!t)return"";var e=new Date(t);return e.toISOString().replace("T"," ").replace("Z","").substring(0,19)},param:function(t){var e=new URLSearchParams(window.location.search);return e.get(t)},isUrl:function(t){return"string"===typeof t&&t.length>0&&null!==t.match(/^https?:\/\//i)}};r["a"].use(Os["a"],{toast:{timeout:5e3,titleMaxLength:30}}),r["a"].prototype.$config=c,r["a"].prototype.$utils=Us,r["a"].config.productionTip=!1,r["a"].config.errorHandler=function(t,e,s){console.log(t),e.$snotify.error(t.message)},window.App=new r["a"]({render:function(t){return t(js)}}).$mount("#app")},"5ebb":function(t,e,s){},"60dd":function(t,e,s){},"615a":function(t,e,s){},6224:function(t,e,s){"use strict";var i=s("468d"),o=s.n(i);o.a},"63ff":function(t,e,s){"use strict";var i=s("18b7"),o=s.n(i);o.a},6998:function(t,e,s){},"6e2a":function(t,e,s){"use strict";var i=s("ab51"),o=s.n(i);o.a},"74f2":function(t,e,s){},"785f":function(t,e,s){},"7f59":function(t,e,s){"use strict";var i=s("4e87"),o=s.n(i);o.a},"916f":function(t,e,s){"use strict";var i=s("a36c"),o=s.n(i);o.a},9215:function(t,e,s){},9797:function(t,e,s){"use strict";var i=s("1da2"),o=s.n(i);o.a},9961:function(t,e,s){"use strict";var i=s("9215"),o=s.n(i);o.a},a36c:function(t,e,s){},ab51:function(t,e,s){},b014:function(t,e,s){},b52e:function(t,e,s){},b5ac:function(t,e,s){"use strict";var i=s("615a"),o=s.n(i);o.a},b5ba:function(t,e,s){},c6f2:function(t,e,s){"use strict";var i=s("60dd"),o=s.n(i);o.a},c8c0:function(t,e,s){"use strict";var i=s("1999"),o=s.n(i);o.a},cf05:function(t,e,s){t.exports=s.p+"img/logo.637896da.png"},d019:function(t,e,s){"use strict";var i=s("6998"),o=s.n(i);o.a},d06a:function(t,e,s){},d89e:function(t,e,s){},e01b:function(t,e,s){"use strict";var i=s("fe40"),o=s.n(i);o.a},e133:function(t,e,s){"use strict";var i=s("74f2"),o=s.n(i);o.a},ea51:function(t,e,s){"use strict";var i=s("d06a"),o=s.n(i);o.a},ef28:function(t,e,s){"use strict";var i=s("b014"),o=s.n(i);o.a},f012:function(t,e,s){"use strict";var i=s("b5ba"),o=s.n(i);o.a},fe40:function(t,e,s){}});
//# sourceMappingURL=app.c7c2fedb.js.map