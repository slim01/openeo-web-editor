{"version":3,"sources":["webpack:///./node_modules/ol-ext/control/LayerSwitcher.js","webpack:///./node_modules/ol/MapBrowserEventType.js","webpack:///./node_modules/ol/CollectionEventType.js","webpack:///./node_modules/ol/Kinetic.js","webpack:///./node_modules/ol/Observable.js","webpack:///./node_modules/ol/ViewHint.js","webpack:///./node_modules/ol/Feature.js","webpack:///./node_modules/ol/MapBrowserEvent.js","webpack:///./node_modules/ol/MapEventType.js","webpack:///./node_modules/ol/LayerType.js","webpack:///./node_modules/ol/Tile.js","webpack:///./node_modules/ol/MapBrowserEventHandler.js","webpack:///./node_modules/ol/MapProperty.js","webpack:///./node_modules/ol/TileQueue.js","webpack:///./node_modules/ol/PluggableMap.js","webpack:///./node_modules/ol/Map.js","webpack:///./node_modules/ol-ext/util/element.js","webpack:///./node_modules/ol/MapEvent.js","webpack:///./node_modules/ol/ObjectEventType.js","webpack:///./node_modules/ol/ImageTile.js","webpack:///./node_modules/ol/AssertionError.js","webpack:///./node_modules/ol/ImageState.js","webpack:///./node_modules/ol/TileCache.js","webpack:///./node_modules/ol/ViewProperty.js","webpack:///./node_modules/ol/View.js","webpack:///./node_modules/ol/TileState.js","webpack:///./node_modules/ol-ext/util/ext.js","webpack:///./node_modules/ol-ext/control/Toggle.js","webpack:///./node_modules/ol-ext/control/TextButton.js","webpack:///./node_modules/ol-ext/interaction/Delete.js","webpack:///./node_modules/ol-ext/geom/GeomUtils.js","webpack:///./node_modules/ol-ext/interaction/Offset.js","webpack:///./node_modules/ol-ext/geom/LineStringSplitAt.js","webpack:///./node_modules/ol-ext/interaction/Split.js","webpack:///./node_modules/ol-ext/interaction/Transform.js","webpack:///./node_modules/ol-ext/interaction/ModifyFeature.js","webpack:///./node_modules/ol-ext/interaction/DrawRegular.js","webpack:///./node_modules/ol-ext/interaction/DrawHole.js","webpack:///./node_modules/ol-ext/control/EditBar.js","webpack:///./node_modules/ol-ext/control/Swipe.js","webpack:///./node_modules/ol-ext/source/Vector.js","webpack:///./node_modules/ol-ext/interaction/UndoRedo.js","webpack:///./node_modules/ol/Disposable.js","webpack:///./node_modules/ol/TileRange.js","webpack:///./node_modules/ol/MapBrowserPointerEvent.js","webpack:///./node_modules/ol/Object.js","webpack:///./node_modules/ol/Collection.js","webpack:///./node_modules/ol-ext/control/Button.js","webpack:///./node_modules/ol/ImageBase.js","webpack:///./node_modules/ol/ImageCanvas.js","webpack:///./node_modules/ol-ext/control/Bar.js"],"names":["_util_ext__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","ol_Observable__WEBPACK_IMPORTED_MODULE_1__","ol_control_Control__WEBPACK_IMPORTED_MODULE_2__","ol_layer_Tile__WEBPACK_IMPORTED_MODULE_3__","ol_layer_Vector__WEBPACK_IMPORTED_MODULE_4__","ol_layer_VectorTile__WEBPACK_IMPORTED_MODULE_5__","ol_layer_Image__WEBPACK_IMPORTED_MODULE_6__","ol_layer_Heatmap__WEBPACK_IMPORTED_MODULE_7__","ol_extent__WEBPACK_IMPORTED_MODULE_8__","_util_element__WEBPACK_IMPORTED_MODULE_9__","ol_control_LayerSwitcher","options","element","self","this","dcount","show_progress","oninfo","onextent","hasextent","extent","hastrash","trash","reordering","_layers","displayInLayerSwitcher","target","create","className","switcherClass","collapsed","classList","add","button","type","parent","addEventListener","e","toggle","dispatchEvent","contains","preventDefault","overflow","mouseover","remove","topv","click","botv","panel_","addListener","Math","max","min","wheelDelta","detail","stopPropagation","header_","call","set","drawDelay","Object","prototype","tip","up","down","info","plus","layer","get","setMap","map","drawPanel","_listener","change","moveend","size","getLayerGroup","on","bind","viewChange","show","hide","isOpen","setHeader","html","setHTML","dir","hidden","setStyle","height","h","outerHeight","hp","dh","offsetTop","top","lh","getStyle","querySelectorAll","round","_setLayerForLI","li","push","_getLayerForLI","l","i","getMap","forEach","testLayerVisibility","setTimeout","drawPanel_","dragging_","drawList","getLayers","switchLayerVisibility","layers","getVisible","setVisible","res","getView","getResolution","getMaxResolution","getMinResolution","ex0","getExtent","ex","calculateExtent","getSize","dragOrdering_","pageY","dragElt","group","elt","currentTarget","parentNode","start","panel","pageY0","touches","length","changedTouches","stop","drop","collection","getArray","removeAt","j","insertAt","removeListener","document","move","abs","innerHTML","style","position","z-index","left","offsetLeft","opacity","width","outerWidth","offsetRect","scrollTop","elementFromPoint","clientX","clientY","tagName","dragOpacity_","x","pageX","delta","nextElementSibling","setOpacity","ul","setVisibility","onInfo","zoomExtent","fit","removeLayer","getLength","layer_buttons","d","checked","title","unselectable","userSelect","mousedown touchstart","nb","p","setprogress_","layerswitcher_progress","op","offsetX","getOpacity","ul2","loaded","loading","draw","toFixed","getSource","__webpack_exports__","_events_EventType_js__WEBPACK_IMPORTED_MODULE_0__","SINGLECLICK","CLICK","DBLCLICK","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","ADD","REMOVE","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","begin","update","y","Date","now","end","lastIndex","firstIndex","duration","dx","dy","atan2","sqrt","getDistance","getAngle","unByKey","_events_js__WEBPACK_IMPORTED_MODULE_0__","_events_Target_js__WEBPACK_IMPORTED_MODULE_1__","_events_EventType_js__WEBPACK_IMPORTED_MODULE_2__","Observable","EventTarget","revision_","__proto__","constructor","changed","CHANGE","getRevision","listener","Array","isArray","len","keys","once","un","ii","key","ANIMATING","INTERACTING","_asserts_js__WEBPACK_IMPORTED_MODULE_0__","_events_js__WEBPACK_IMPORTED_MODULE_1__","_Object_js__WEBPACK_IMPORTED_MODULE_3__","Feature","BaseObject","opt_geometryOrProperties","id_","undefined","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","getSimplifiedGeometry","geometry","setGeometry","properties","setProperties","clone","getProperties","setGeometryName","getGeometryName","getGeometry","getId","getStyleFunction","handleGeometryChange_","createStyleFunction","setId","id","name","obj","styles","getZIndex","_MapEvent_js__WEBPACK_IMPORTED_MODULE_0__","MapBrowserEvent","MapEvent","browserEvent","opt_dragging","opt_frameState","originalEvent","pixel","getEventPixel","coordinate","getCoordinateFromPixel","dragging","POSTRENDER","MOVESTART","MOVEEND","IMAGE","TILE","VECTOR_TILE","VECTOR","_TileState_js__WEBPACK_IMPORTED_MODULE_0__","_easing_js__WEBPACK_IMPORTED_MODULE_1__","_events_Target_js__WEBPACK_IMPORTED_MODULE_2__","_events_EventType_js__WEBPACK_IMPORTED_MODULE_3__","Tile","tileCoord","state","opt_options","interimTile","transition_","transition","transitionStarts_","getKey","getInterimTile","tile","getState","LOADED","refreshInterimChain","prev","LOADING","IDLE","getTileCoord","setState","load","getAlpha","time","inTransition","endTransition","MapBrowserEventHandler_MapBrowserEventHandler","MapBrowserEventHandler","moveTolerance","map_","clickTimeoutId_","dragListenerKeys_","moveTolerance_","has","down_","getViewport","activePointers_","trackedTouches_","pointerEventHandler_","PointerEventHandler","documentPointerEventHandler_","pointerdownListenerKey_","events","EventType","handlePointerDown_","relayedListenerKey_","relayEvent_","emulateClick_","pointerEvent","newEvent","MapBrowserPointerEvent","MapBrowserEventType","clearTimeout","updateActivePointers_","event","pointerId","handlePointerUp_","propagationStopped","isMouseActionButton_","dispose","handlePointerMove_","isMoving_","disposeInternal","Target","ol_MapBrowserEventHandler","MapProperty","LAYERGROUP","SIZE","TARGET","VIEW","TileQueue_TileQueue","PriorityQueue","TileQueue","tilePriorityFunction","tileChangeCallback","apply","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","enqueue","added","events_EventType","handleTileChange","getTilesLoading","TileState","ERROR","EMPTY","ABORT","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","abortedTiles","getCount","dequeue","structs_PriorityQueue","ol_TileQueue","PluggableMap_PluggableMap","PluggableMap","optionsInternal","createOptionsInternal","maxTilesLoading_","maxTilesLoading","loadTilesWhileAnimating_","loadTilesWhileAnimating","loadTilesWhileInteracting_","loadTilesWhileInteracting","pixelRatio_","pixelRatio","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","transform","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","createElement","msTouchAction","touchAction","overlayContainer_","appendChild","overlayContainerStopEvent_","overlayEvents","MOUSEDOWN","TOUCHSTART","MSPOINTERDOWN","MOUSEWHEEL","WHEEL","Event","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyboardEventTarget","keyHandlerKeys_","CONTEXTMENU","handleBrowserEvent","controls","Collection","interactions","overlays_","overlays","overlayIdIndex_","renderer_","createRenderer","handleResize_","focus_","postRenderFunctions_","tileQueue_","getTilePriority","handleTileChange_","skippedFeatureUids_","ol_Object","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","values","control","CollectionEventType","interaction","addOverlayInternal_","overlay","toString","Error","addControl","getControls","addInteraction","getInteractions","addLayer","addOverlay","getOverlays","removeEventListener","RESIZE","cancelAnimationFrame","setTarget","forEachFeatureAtPixel","callback","hitTolerance","layerFilter","functions","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","feature","forEachLayerAtPixel","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","viewportPosition","getBoundingClientRect","eventPosition","getTarget","getTargetElement","getElementById","frameState","pixelToCoordinateTransform","slice","getOverlayById","getPixelFromCoordinate","coordinateToPixelTransform","getRenderer","getOverlayContainer","getOverlayContainerStopEvent","tileSourceKey","tileCenter","tileResolution","wantedTiles","deltaX","focus","deltaY","log","opt_type","mapBrowserEvent","interactionsArray","getActive","cont","handleEvent","handlePostRender","tileQueue","isEmpty","hints","viewHints","ViewHint","reprioritize","hasListener","render_EventType","RENDERCOMPLETE","animate","getLoading","dispatchRenderEvent","postRenderFunctions","render","targetElement","KEYDOWN","KEYPRESS","updateSize","window","removeLayerRenderers","dom","handleViewPropertyChanged_","view","setAttribute","util","ObjectEventType","PROPERTYCHANGE","layerGroup","isRendered","renderSync","requestAnimationFrame","removeControl","removeInteraction","removeOverlay","viewState","ol_extent","previousFrameState","ol_size","isDef","getHints","layerStatesArray","getLayerStatesArray","layerStates","center","index","skippedFeatureUids","usedTiles","resolution","rotation","renderFrame","moveStart","MapEventType","idle","setLayerGroup","setSize","setView","skipFeature","computedStyle","getComputedStyle","offsetWidth","parseFloat","offsetHeight","unskipFeature","Group","View","asserts","ol_PluggableMap","source","Map_Map","Map","control_util","renderer","canvas_Map","registerLayerRenderers","ImageLayer","TileLayer","VectorLayer","VectorTileLayer","ol_ext_element","createTextNode","attr","test","trim","Element","appendText","text","eventType","fn","split","display","el","st","s","styleProp","value","defaultView","ownerDocument","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","oldRsLeft","runtimeStyle","pixelLeft","parseInt","rect","pageYOffset","documentElement","body","pageXOffset","scrollLeft","bottom","widtth","right","scrollDiv","pos","speed","dt","onmove","page","vertical","scroll","ondragstart","mousewheel","_events_Event_js__WEBPACK_IMPORTED_MODULE_0__","_Tile_js__WEBPACK_IMPORTED_MODULE_0__","_TileState_js__WEBPACK_IMPORTED_MODULE_1__","_dom_js__WEBPACK_IMPORTED_MODULE_2__","_events_js__WEBPACK_IMPORTED_MODULE_3__","_events_EventType_js__WEBPACK_IMPORTED_MODULE_4__","ImageTile","src","crossOrigin","tileLoadFunction","crossOrigin_","src_","image_","Image","imageListenerKeys_","tileLoadFunction_","unlistenImage_","getBlankImage","getImage","handleImageError_","handleImageLoad_","image","naturalWidth","naturalHeight","LOAD","ctx","fillStyle","fillRect","canvas","_util_js__WEBPACK_IMPORTED_MODULE_0__","AssertionError","code","path","message","_structs_LRUCache_js__WEBPACK_IMPORTED_MODULE_0__","_tilecoord_js__WEBPACK_IMPORTED_MODULE_1__","TileCache","LRUCache","opt_highWaterMark","expireCache","canExpireCache","peekLast","zKey","pop","pruneExceptNewestZ","peekFirstKey","z","ViewProperty","CENTER","RESOLUTION","ROTATION","DEFAULT_MIN_ZOOM","View_View","hints_","animations_","updateAnimationKey_","updateAnimations_","projection_","proj","projection","applyOptions_","resolutionConstraintInfo","createResolutionConstraint","maxResolution_","maxResolution","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","resolutions","minZoom_","minZoom","centerConstraint","createCenterConstraint","resolutionConstraint","constraint","rotationConstraint","createRotationConstraint","constraints_","zoom","constrainResolution","math","Number","options_","getUpdatedOptions_","newOptions","getZoom","getCenter","getRotation","var_args","arguments$1","arguments","animationCount","setCenter","setZoom","setRotation","animationCallback","series","animation","complete","anchor","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","sourceRotation","PI","targetRotation","isNoopAnimation","setHint","getAnimating","getInteracting","cancelAnimations","more","seriesComplete","jj","elapsed","fraction","progress","x0","y0","x1","y1","calculateCenterZoom","calculateCenterRotate","filter","Boolean","currentCenter","currentResolution","getSizeFromViewport_","selector","querySelector","metrics","constrainCenter","opt_delta","opt_direction","direction","constrainRotation","getConstraints","opt_hints","opt_size","getMaxZoom","getZoomForResolution","setMaxZoom","maxZoom","getMinZoom","setMinZoom","getProjection","getResolutions","getResolutionForExtent","xResolution","yResolution","getResolutionForValueFunction","opt_power","power","pow","getValueForResolutionFunction","pixelResolution","offset","nearest","array","getResolutionForZoom","geometryOrExtent","Polygon","getType","GeometryType","CIRCLE","rotate","padding","coords","getFlatCoordinates","cosAngle","cos","sinAngle","sin","minRotX","Infinity","minRotY","maxRotX","maxRotY","stride","getStride","rotX","rotY","isNaN","constrainedResolution","centerRotX","centerRotY","centerX","centerY","setResolution","centerOn","opt_anchor","hint","returnValue","centerconstraint","defaultMaxZoom","defaultZoomFactor","resolutionconstraint","Units","DEGREES","getMetersPerUnit","defaultMaxResolution","common","defaultMinResolution","floor","enableRotation","rotationconstraint","ol","ext","ol_ext_inherits","child","inherits","NodeList","removeChild","ol_control_Toggle","interaction_","setActive","oldValue","toggleFn","onToggle","handleClick","Button","autoActivate","bar","subbar_","active","setDisable","disable","util_ext","Control","getSubBar","getDisable","disabled","b","setInteraction","getInteraction","Toggle","ol_control_TextButton","TextButton","ol_interaction_Delete","Select","getFeatures","clear","delete","selected","_getSources","sources","concat","Vector","delFeatures","f","removeFeature","Delete","ol_coordinate_dist2d","p1","p2","ol_coordinate_equal","ol_coordinate_offsetCoords","mi","mi1","li1","ri","ri1","si","si1","Xi1","Yi1","p0","N","isClosed","ol_coordinate_findSegment","pt","segment","d0","v0","d1","v1","ol_interaction_Offset","Pointer","handleDownEvent","handleDownEvent_","handleDragEvent","handleDragEvent_","handleMoveEvent","handleMoveEvent_","handleUpEvent","handleUpEvent_","features_","layers_","duplicate","source_","previousCursor_","getFeatureAtPixel_","current","typeGeom","getCoordinates","getClosestPoint","hit","coordinates","geom","geomType","current_","ctrlKey","addFeature","seg","v2","LineString","cursor","Offset","splitAt","tol","result","r","k","getFirstCoordinate","getLastCoordinate","c0","ci","c","d2","ol_interaction_Split","Interaction","snapDistance_","snapDistance","tolerance_","tolerance","cursor_","sources_","filterSplit_","white","blue","fill","Fill","color","stroke","Stroke","sketchStyle","Style","Circle","radius","featureStyle","overlayLayer_","layer_Vector","useSpatialIndex","_sketch_","getClosestFeature","g","getClosestFeatureToCoordinate","coord","getNearestCoord","link","dm","MAX_VALUE","evt","tosplit","original","Point","linkGeometry","Split","ol_interaction_Transform","selection_","handles_","wrapX","_filter","addFn_","addCondition","translateFeature","translate","stretch","scale","keepAspectRatio","shiftKey","modifyCenter","metaKey","noFlip","selection","drawSketch_","setDefaultStyle","Cursors","default","select","rotate0","scale1","scale2","scale3","scalev","scaleh1","scalev2","scaleh3","isTouch","strokedash","lineDash","fill0","circle","RegularShape","points","getAnchor","bigpt","angle","smallpt","createStyle","img","olstyle","im","setScale","tx","getText","setOffsetX","found","bbox_","handle","option","some","item","ispt_","center_","iscircle_","addFeatures","watchFeatures_","_featureListeners","sel","indexOf","mode_","opt_","constraint_","coordinate_","pixel_","geoms_","extent_","a","ispt","setCenterAndRadius","getRadius","scx","scy","applyTransform","g1","g2","dim","oldgeom","oldgeoms","Transform","ol_interaction_ModifyFeature","modifying","_deleteCondition","pixelTolerance","_condition","condition","deleteCondition","_insertVertexCondition","insertVertexCondition","di","dist","lstring","getLineStrings","ring","lring","getLinearRings","poly","getPolygons","getGeometries","getArcs","arcs","coord1","coord2","node","shift","c1","nbpt","closed","typeg","console","error","getFeaturesInExtent","_modifiedFeatures","_removePoint","getModifiedFeatures","removePoint","_getModification","geoms","setGeometries","setCoordinates","setArcCoordinates","ModifyFeature","ol_interaction_DrawRegular","squaredClickTolerance_","clickTolerance","maxCircleCoordinates_","maxCircleCoordinates","squareFn_","squareCondition","centeredFn_","centerCondition","canRotate_","canRotate","geometryName","setSides","sides","defaultStyle","sketch_","handleEvent_","reset","started_","sides_","getSides","startAngle","3","4","getGeom_","coord_","dmax","centerPx","square_","centered_","geom_Circle","coordPx_","hasrotation","sc","sign","t","feature_","drawPoint_","noclear","_eventTime","downPx_","start_","_longTouch","lastEvent","end_","upPx_","finishDrawing","startCoordinate","square","centered","DrawRegular","ol_interaction_DrawHole","_select","geometryFn","geomFn","geometryFunction","_geometryFn","Draw","_startDrawing","_finishDrawing","removeLastPoint","_feature","getPolygon","_polygon","layersFilter","_current","intersectsCoordinate","_polygonIndex","hole","pi","newGeom","MultiPolygon","appendLinearRing","LinearRing","appendPolygon","lastOKCoord","DrawHole","ol_control_EditBar","Bar","toggleOne","_source","_interactions","_setSelectInteraction","edition","_setEditInteraction","_setModifyInteraction","ModifySelect","_getTitle","selectCtrl","sbar","del","deselected","Info","DrawPoint","pedit","DrawLine","nbpts","ledit","UndoDraw","FinishDraw","DrawPolygon","_setDrawPolygon","regular","div","util_element","textContent","ctrl","fedit","ol_control_Control__WEBPACK_IMPORTED_MODULE_1__","ol_control_Swipe","precomposeRight_","precomposeRight","precomposeLeft_","precomposeLeft","postcompose_","postcompose","rightLayers","orientation","isLayer_","splice","isMoving","eventName","clientLeft","clientTop","context","save","beginPath","clip","restore","source_Vector","opt_fast","ol_interaction_UndoRedo","_undoStack","_redoStack","_block","_record","_defs","define","action","undoFn","redoFn","undo","redo","prop","_watchSources","_watchInteractions","getVectorLayers","init","_sourceListener","vectors","_onAddRemove","blockStart","blockEnd","_interactionListener","_onInteraction","setattributestart","newp","assign","oldp","newProperties","oldProperties","rotatestart","translatestart","scalestart","modifystart","m","oldFeature","beforesplit","deletestart","aftersplit","deleteend","_handleDo","unset","warn","substr","hasUndo","hasRedo","Disposable","disposed_","createOrUpdate","TileRange","minX","maxX","minY","maxY","tileRange","containsXY","containsTileRange","equals","extend","getHeight","getWidth","intersects","_MapBrowserEvent_js__WEBPACK_IMPORTED_MODULE_0__","getChangeEventType","_ObjectEventType_js__WEBPACK_IMPORTED_MODULE_1__","_Observable_js__WEBPACK_IMPORTED_MODULE_2__","_events_Event_js__WEBPACK_IMPORTED_MODULE_3__","_obj_js__WEBPACK_IMPORTED_MODULE_4__","ObjectEvent","opt_values","values_","hasOwnProperty","getKeys","notify","opt_silent","changeEventTypeCache","_AssertionError_js__WEBPACK_IMPORTED_MODULE_0__","_CollectionEventType_js__WEBPACK_IMPORTED_MODULE_1__","_Object_js__WEBPACK_IMPORTED_MODULE_2__","Property","LENGTH","CollectionEvent","opt_element","opt_array","unique_","unique","array_","assertUnique_","updateLength_","arr","elem","n","setAt","opt_except","_util_element__WEBPACK_IMPORTED_MODULE_2__","ol_control_Button","bt","button_","evtFunction","firstElementChild","val","setTitle","setHtml","ImageBase_ImageBase","ImageBase","getPixelRatio","ol_ImageBase","ImageCanvas_ImageCanvas","ImageCanvas","opt_loader","ImageState","loader_","canvas_","error_","getError","handleLoad_","err","ol_control_Bar","classes","autoDeactivate","controls_","setPosition","onActivateControl_","deactivateControls","except","getActiveControls","sb","ctrls","getControlsByName"],"mappings":"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","file":"js/chunk-2b644eba.d8d236a9.js","sourcesContent":["/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\nimport ol_ext_inherits from '../util/ext'\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\nimport ol_control_Control from 'ol/control/Control'\nimport ol_layer_Tile from 'ol/layer/Tile'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_layer_VectorTile from 'ol/layer/VectorTile'\nimport ol_layer_Image from 'ol/layer/Image'\nimport ol_layer_Heatmap from 'ol/layer/Heatmap'\nimport {intersects as ol_extent_intersects} from 'ol/extent'\n\nimport ol_ext_element from '../util/element'\n\n/**\n * @classdesc OpenLayers 3 Layer Switcher Control.\n * @fires drawlist\n * @fires toggle\n * \n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} options\n *  @param {function} options.displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\n *  @param {boolean} options.mouseover show the panel on mouseover, default false\n *  @param {boolean} options.reordering allow layer reordering, default true\n *  @param {boolean} options.trash add a trash button to delete the layer, default false\n *  @param {function} options.oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\n *  @param {boolean} options.extent add an extent button to zoom to the extent of the layer\n *  @param {function} options.onextent callback when click on extent, default fits view to extent\n *  @param {number} options.drawDelay delay in ms to redraw the layer (usefull to prevent flickering when manipulating the layers)\n *  @param {boolean} options.collapsed collapse the layerswitcher at beginning, default true\n *\n * Layers attributes that control the switcher\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\n *\t- displayInLayerSwitcher {boolean} display in switcher, default true\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\n */\nvar ol_control_LayerSwitcher = function(options) {\n  options = options || {};\n  var self = this;\n  this.dcount = 0;\n  this.show_progress = options.show_progress;\n  this.oninfo = (typeof (options.oninfo) == \"function\" ? options.oninfo: null);\n  this.onextent = (typeof (options.onextent) == \"function\" ? options.onextent: null);\n  this.hasextent = options.extent || options.onextent;\n  this.hastrash = options.trash;\n  this.reordering = (options.reordering!==false);\n  this._layers = [];\n\n  // displayInLayerSwitcher\n  if (typeof(options.displayInLayerSwitcher) === 'function') {\n    this.displayInLayerSwitcher = options.displayInLayerSwitcher;\n  }\n\n  var element;\n  if (options.target) {\n    element = ol_ext_element.create('DIV', {\n      className: options.switcherClass || \"ol-layerswitcher\"\n    });\n  } else {\n    element = ol_ext_element.create('DIV', {\n      className: (options.switcherClass || \"ol-layerswitcher\") +' ol-unselectable ol-control'\n    });\n    if (options.collapsed !== false) element.classList.add('ol-collapsed'); \n    else element.classList.add('ol-forceopen'); \n  \n    this.button = ol_ext_element.create('BUTTON', {\n      type: 'button',\n      parent: element\n    });\n    this.button.addEventListener('touchstart', function(e){\n      element.classList.toggle('ol-collapsed');\n      self.dispatchEvent({ type: 'toggle', collapsed: element.classList.contains('ol-collapsed') });\n      e.preventDefault(); \n      self.overflow();\n    });\n    this.button.addEventListener('click', function(){\n      element.classList.toggle('ol-forceopen');\n      element.classList.add('ol-collapsed'); \n      self.dispatchEvent({ type: 'toggle', collapsed: !element.classList.contains('ol-forceopen') });\n      self.overflow();\n    });\n\n    if (options.mouseover) {\n      element.addEventListener ('mouseleave', function(){ \n        element.classList.add(\"ol-collapsed\"); \n        self.dispatchEvent({ type: 'toggle', collapsed: true });\n      });\n      element.addEventListener ('mouseover', function(){ \n        element.classList.remove(\"ol-collapsed\"); \n        self.dispatchEvent({ type: 'toggle', collapsed: false });\n      });\n    }\n\n    this.topv = ol_ext_element.create('DIV', {\n      className: 'ol-switchertopdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"+50%\");\n      }\n    });\n\n    this.botv = ol_ext_element.create('DIV', {\n      className: 'ol-switcherbottomdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"-50%\");\n      }\n    });\n  }\n\n  this.panel_ = ol_ext_element.create ('UL', {\n    className: 'panel',\n    parent: element\n  });\n  ol_ext_element.addListener (this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function(e) {\n    if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n\n  this.header_ = ol_ext_element.create('LI', {\n    className: 'ol-header',\n    parent: this.panel_\n  });\n\n  ol_control_Control.call (this, {\n    element: element,\n    target: options.target\n  });\n\n  this.set('drawDelay',options.drawDelay||0);\n};\nol_ext_inherits(ol_control_LayerSwitcher, ol_control_Control);\n\n/** List of tips for internationalization purposes\n*/\nol_control_LayerSwitcher.prototype.tip = {\n  up: \"up/down\",\n  down: \"down\",\n  info: \"informations...\",\n  extent: \"zoom to extent\",\n  trash: \"remove layer\",\n  plus: \"expand/shrink\"\n};\n\n/** Test if a layer should be displayed in the switcher\n * @param {ol.layer} layer\n * @return {boolean} true if the layer is displayed\n */\nol_control_LayerSwitcher.prototype.displayInLayerSwitcher = function(layer) {\n  return (layer.get(\"displayInLayerSwitcher\")!==false);\n};\n\n/**\n * Set the map instance the control is associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_LayerSwitcher.prototype.setMap = function(map) {\n  ol_control_Control.prototype.setMap.call(this, map);\n  this.drawPanel();\n  \n  if (this._listener) {\n    if (this._listener) ol_Observable_unByKey(this._listener.change);\n    if (this._listener) ol_Observable_unByKey(this._listener.moveend);\n    if (this._listener) ol_Observable_unByKey(this._listener.size);\n  }\n  this._listener = null;\n\n  // Get change (new layer added or removed)\n  if (map) {\n    this._listener = {\n      change: map.getLayerGroup().on('change', this.drawPanel.bind(this)),\n      moveend: map.on('moveend', this.viewChange.bind(this)),\n      size: map.on('change:size', this.overflow.bind(this))\n    }\n  }\n};\n\n/** Show control\n */\nol_control_LayerSwitcher.prototype.show = function() {\n  this.element.classList.add(\"ol-forceopen\");\n  this.overflow();\n};\n\n/** Hide control\n */\nol_control_LayerSwitcher.prototype.hide = function() {\n  this.element.classList.remove(\"ol-forceopen\");\n  this.overflow();\n};\n\n/** Toggle control\n */\nol_control_LayerSwitcher.prototype.toggle = function() {\n  this.element.classList.toggle(\"ol-forceopen\");\n  this.overflow();\n};\n\n/** Is control open\n * @return {boolean}\n */\nol_control_LayerSwitcher.prototype.isOpen = function() {\n  return this.element.classList.contains(\"ol-forceopen\");\n};\n\n/** Add a custom header\n * @param {Element|string} html content html\n */\nol_control_LayerSwitcher.prototype.setHeader = function(html) {\n  ol_ext_element.setHTML(this.header_, html);\n};\n\n/** Calculate overflow and add scrolls\n *\t@param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\n */\nol_control_LayerSwitcher.prototype.overflow = function(dir) {\t\n  if (this.button) {\n    // Nothing to show\n    if (ol_ext_element.hidden(this.panel_)) {\n      ol_ext_element.setStyle(this.element, { height: 'auto' });\n      return;\n    }\n    // Calculate offset\n    var h = ol_ext_element.outerHeight(this.element);\n    var hp = ol_ext_element.outerHeight(this.panel_);\n    var dh = this.button.offsetTop + ol_ext_element.outerHeight(this.button);\n    //var dh = this.button.position().top + this.button.outerHeight(true);\n\n    var top = this.panel_.offsetTop - dh;\n    if (hp > h-dh) {\n      // Bug IE: need to have an height defined\n      ol_ext_element.setStyle(this.element, { height: '100%' });\n      var lh = 2 * ol_ext_element.getStyle(this.panel_.querySelectorAll('li.visible .li-content')[0], 'height');\n      switch (dir) {\n        case 1: top += lh; break;\n        case -1: top -= lh; break;\n        case \"+50%\": top += Math.round(h/2); break;\n        case \"-50%\": top -= Math.round(h/2); break;\n        default: break;\n      }\n      // Scroll div\n      if (top+hp <= h-3*dh/2) {\n        top = h-3*dh/2-hp;\n        ol_ext_element.hide(this.botv);\n      } else {\n        ol_ext_element.show(this.botv);\n      }\n      if (top >= 0) {\n        top = 0;\n        ol_ext_element.hide(this.topv);\n      } else {\n        ol_ext_element.show(this.topv);\n      }\n      // Scroll ?\n      ol_ext_element.setStyle(this.panel_, { top: top+\"px\" });\n      return true;\n    } else {\n      ol_ext_element.setStyle(this.element, { height: \"auto\" });\n      ol_ext_element.setStyle(this.panel_, { top: 0 });\n      ol_ext_element.hide(this.botv);\n      ol_ext_element.hide(this.topv);\n      return false;\n    }\n  }\n  else return false;\n};\n\n/** Set the layer associated with a li\n * @param {Element} li\n * @param {ol.layer} layer\n */\nol_control_LayerSwitcher.prototype._setLayerForLI = function(li, layer) {\n  this._layers.push({ li:li, layer:layer });\n};\n\n/** Get the layer associated with a li\n * @param {Element} li\n * @return {ol.layer}\n */\nol_control_LayerSwitcher.prototype._getLayerForLI = function(li) {\n  for (var i=0, l; l=this._layers[i]; i++) {\n    if (l.li===li) return l.layer;\n  }\n  return null;\n};\n\n/**\n * On view change hide layer depending on resolution / extent\n * @private\n */\nol_control_LayerSwitcher.prototype.viewChange = function() {\n  var map = this.getMap();\n  this.panel_.querySelectorAll('li').forEach( function(li) {\n    var l = this._getLayerForLI(li);\n    if (l) {\n      if (this.testLayerVisibility(l)) li.classList.remove('ol-layer-hidden');\n      else li.classList.add('ol-layer-hidden');\n      /*\n      var res = map.getView().getResolution();\n      if (l.getMaxResolution()<=res || l.getMinResolution()>=res) {\n        li.classList.add('ol-layer-hidden');\n      } else {\n        var ex0 = l.getExtent();\n        if (ex0) {\n          var ex = map.getView().calculateExtent(map.getSize());\n          if (!ol_extent_intersects(ex, ex0)) {\n            li.classList.add('ol-layer-hidden');\n          } else {\n            li.classList.remove('ol-layer-hidden');\n          }\n        } else {\n          li.classList.remove('ol-layer-hidden');\n        }\n      }\n      */\n    }\n  }.bind(this));\n};\n\n/**\n *\tDraw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\n*/\nol_control_LayerSwitcher.prototype.drawPanel = function() {\n  if (!this.getMap()) return;\n  var self = this;\n  // Multiple event simultaneously / draw once => put drawing in the event queue\n  this.dcount++;\n  setTimeout (function(){ self.drawPanel_(); }, this.get('drawDelay') || 0);\n};\n\n/** Delayed draw panel control \n * @private\n */\nol_control_LayerSwitcher.prototype.drawPanel_ = function() {\n  if (--this.dcount || this.dragging_) return;\n  // Remove existing layers\n  this._layers = [];\n  this.panel_.querySelectorAll('li').forEach (function(li) {\n    if (!li.classList.contains('ol-header')) li.remove();\n  }.bind(this));\n  // Draw list\n  this.drawList (this.panel_, this.getMap().getLayers());\n};\n\n/** Change layer visibility according to the baselayer option\n * @param {ol.layer}\n * @param {Array<ol.layer>} related layers\n */\nol_control_LayerSwitcher.prototype.switchLayerVisibility = function(l, layers) {\n  if (!l.get('baseLayer')) {\n    l.setVisible(!l.getVisible());\n  } else {\n    if (!l.getVisible()) l.setVisible(true);\n    layers.forEach(function(li) {\n      if (l!==li && li.get('baseLayer') && li.getVisible()) li.setVisible(false);\n    });\n  }\n};\n\n/** Check if layer is on the map (depending on zoom and extent)\n * @param {ol.layer}\n * @return {boolean}\n */\nol_control_LayerSwitcher.prototype.testLayerVisibility = function(layer) {\n  if (!this.getMap()) return true;\n  var res = this.getMap().getView().getResolution();\n  if (layer.getMaxResolution()<=res || layer.getMinResolution()>=res) {\n    return false;\n  } else {\n    var ex0 = layer.getExtent();\n    if (ex0) {\n      var ex = this.getMap().getView().calculateExtent(this.getMap().getSize());\n      return ol_extent_intersects(ex, ex0);\n    }\n    return true;\n  }\n};\n\n\n/** Start ordering the list\n*\t@param {event} e drag event\n*\t@private\n*/\nol_control_LayerSwitcher.prototype.dragOrdering_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  // Get params\n  var self = this;\n  var elt = e.currentTarget.parentNode.parentNode;\n  var start = true;\n  var panel = this.panel_; \n  var pageY;\n  var pageY0 = e.pageY \n    || (e.touches && e.touches.length && e.touches[0].pageY) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n  var target, dragElt;\n  var layer, group;\n  elt.parentNode.classList.add('drag');\n\n  // Stop ordering\n  function stop() {\n    if (target) {\n      // Get drag on parent\n      var drop = layer;\n      if (drop && target) {\n        var collection ;\n        if (group) collection = group.getLayers();\n        else collection = self.getMap().getLayers();\n        var layers = collection.getArray();\n        // Switch layers\n        for (var i=0; i<layers.length; i++) {\n          if (layers[i]==drop) {\n            collection.removeAt (i);\n            break;\n          }\n        }\n        for (var j=0; j<layers.length; j++) {\n          if (layers[j]==target) {\n            if (i>j) collection.insertAt (j,drop);\n            else collection.insertAt (j+1,drop);\n            break;\n          }\n        }\n      }\n    }\n    \n    elt.parentNode.querySelectorAll('li').forEach(function(li){\n      li.classList.remove('dropover');\n      li.classList.remove('dropover-after');\n      li.classList.remove('dropover-before');\n    });\n    elt.classList.remove(\"drag\");\n    elt.parentNode.classList.remove(\"drag\");\n    self.element.classList.remove('drag');\n    if (dragElt) dragElt.remove();\n\n    ol_ext_element.removeListener(document, 'mousemove touchmove', move);\n    ol_ext_element.removeListener(document, 'mouseup touchend touchcancel', stop);\n  }\n\n  // Ordering\n  function move(e) {\n    // First drag (more than 2 px) => show drag element (ghost)\n    pageY = e.pageY \n        || (e.touches && e.touches.length && e.touches[0].pageY) \n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n    if (start && Math.abs(pageY0 - pageY) > 2) {\n      start = false;\n      elt.classList.add(\"drag\");\n      layer = self._getLayerForLI(elt);\n      target = false;\n      group = self._getLayerForLI(elt.parentNode.parentNode);\n      // Ghost div\n      dragElt = ol_ext_element.create('LI', { \n        className: 'ol-dragover',\n        html: elt.innerHTML,\n        style: { \n          position: \"absolute\", \n          \"z-index\": 10000, \n          left: elt.offsetLeft, \n          opacity: 0.5,\n          width: ol_ext_element.outerWidth(elt),\n          height: ol_ext_element.getStyle(elt,'height'),\n        },\n        parent: panel \n      });\n      self.element.classList.add('drag');\n    }\n    // Start a new drag sequence\n    if (!start) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Ghost div\n      ol_ext_element.setStyle(dragElt, { top: pageY - ol_ext_element.offsetRect(panel).top + panel.scrollTop +5 });\n      \n      var li;\n      if (!e.touches) {\n        li = e.target;\n      } else {\n        li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\n      }\n      if (li.classList.contains(\"ol-switcherbottomdiv\")) {\n        self.overflow(-1);\n      } else if (li.classList.contains(\"ol-switchertopdiv\")) {\n        self.overflow(1);\n      }\n      // Get associated li\n      while (li && li.tagName!=='LI') {\n        li = li.parentNode;\n      }\n      if (!li || !li.classList.contains('dropover')) {\n        elt.parentNode.querySelectorAll('li').forEach(function(li) {\n          li.classList.remove('dropover');\n          li.classList.remove('dropover-after');\n          li.classList.remove('dropover-before');\n        });\n      }\n      if (li && li.parentNode.classList.contains('drag') && li !== elt) {\n        target = self._getLayerForLI(li);\n        // Don't mix layer level\n        if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\n          li.classList.add(\"dropover\");\n          li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before');\n        } else {\n          target = false;\n        }\n        ol_ext_element.show(dragElt);\n      } else {\n        target = false;\n        if (li===elt) ol_ext_element.hide(dragElt);\n        else ol_ext_element.show(dragElt);\n      }\n      \n      if (!target) dragElt.classList.add(\"forbidden\");\n      else dragElt.classList.remove(\"forbidden\");\n    }\n  }\n\n  // Start ordering\n  ol_ext_element.addListener(document, 'mousemove touchmove', move);\n  ol_ext_element.addListener(document, 'mouseup touchend touchcancel', stop);\n};\n\n\n/** Change opacity on drag \n*\t@param {event} e drag event\n*\t@private\n*/\nol_control_LayerSwitcher.prototype.dragOpacity_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  var self = this\n  // Register start params\n  var elt = e.target;\n  var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode);\n  if (!layer) return;\n  var x = e.pageX \n    || (e.touches && e.touches.length && e.touches[0].pageX) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n  var start = ol_ext_element.getStyle (elt, 'left') - x;\n  self.dragging_ = true;\n\n  // stop dragging\n  function stop() {\n    ol_ext_element.removeListener(document, \"mouseup touchend touchcancel\", stop);\n    ol_ext_element.removeListener(document, \"mousemove touchmove\", move);\n    self.dragging_ = false;\n  }\n  // On draggin\n  function move(e) {\n    var x = e.pageX \n      || (e.touches && e.touches.length && e.touches[0].pageX) \n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n    var delta = (start + x) / ol_ext_element.getStyle(elt.parentNode, 'width');\n    var opacity = Math.max (0, Math.min(1, delta));\n    ol_ext_element.setStyle (elt, { left: (opacity*100) + \"%\" });\n    elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity*100);\n    layer.setOpacity(opacity);\n  }\n  // Register move\n  ol_ext_element.addListener(document, \"mouseup touchend touchcancel\", stop);\n  ol_ext_element.addListener(document, \"mousemove touchmove\", move);\n};\n\n\n/** Render a list of layer\n * @param {Elemen} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol_control_LayerSwitcher.prototype.drawList = function(ul, collection) {\n  var self = this;\n  var layers = collection.getArray();\n\n  // Change layer visibility\n  var setVisibility = function(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.switchLayerVisibility(l, collection);\n  };\n  // Info button click\n  function onInfo(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.oninfo(l); \n    self.dispatchEvent({ type: \"info\", layer: l });\n  }\n  // Zoom to extent button\n  function zoomExtent(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    if (self.onextent) self.onextent(l); \n    else self.getMap().getView().fit (l.getExtent(), self.getMap().getSize()); \n    self.dispatchEvent({ type: \"extent\", layer: l });\n  }\n  // Remove a layer on trash click\n  function removeLayer(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var li = this.parentNode.parentNode.parentNode.parentNode;\n    var layer, group = self._getLayerForLI(li);\n    // Remove the layer from a group or from a map\n    if (group) {\n      layer = self._getLayerForLI(this.parentNode.parentNode);\n      group.getLayers().remove(layer);\n      if (group.getLayers().getLength()==0 && !group.get('noSwitcherDelete')) {\n        removeLayer.call(li.querySelectorAll('.layerTrash')[0], e);\n      }\n    } else {\n      li = this.parentNode.parentNode;\n      self.getMap().removeLayer(self._getLayerForLI(li));\n    }\n  }\n  \n  // Add the layer list\n  for (var i=layers.length-1; i>=0; i--) {\n    var layer = layers[i];\n    if (!self.displayInLayerSwitcher(layer)) continue;\n\n    var li = ol_ext_element.create('LI', {\n      className: (layer.getVisible()?\"visible \":\" \")+(layer.get('baseLayer')?\"baselayer\":\"\"),\n      parent: ul\n    });\n    this._setLayerForLI(li, layer);\n\n    var layer_buttons = ol_ext_element.create('DIV', {\n      className: 'ol-layerswitcher-buttons',\n      parent: li\n    });\n\n    // Content div\n    var d = ol_ext_element.create('DIV', {\n      className: 'li-content',// + (this.testLayerVisibility(layer) ? '' : ' ol-layer-hidden'),\n      parent: li\n    });\n    \n    // Visibility\n    ol_ext_element.create('INPUT', {\n      type: layer.get('baseLayer') ? 'radio' : 'checkbox',\n      checked: layer.getVisible(),\n      click: setVisibility,\n      parent: d\n    });\n    // Label\n    ol_ext_element.create('LABEL', {\n      html: layer.get(\"title\") || layer.get(\"name\"),\n      title: layer.get(\"title\") || layer.get(\"name\"),\n      click: setVisibility,\n      unselectable: 'on',\n      style: {\n        userSelect: 'none'\n      },\n      parent: d\n    }).addEventListener('selectstart', function(){ return false; });\n\n    //  up/down\n    if (this.reordering) {\n      if ( (i<layers.length-1 && (layer.get(\"allwaysOnTop\") || !layers[i+1].get(\"allwaysOnTop\")) )\n      || (i>0 && (!layer.get(\"allwaysOnTop\") || layers[i-1].get(\"allwaysOnTop\")) ) ) {\n        ol_ext_element.create('DIV', {\n          className: 'layerup',\n          title: this.tip.up,\n          on: { 'mousedown touchstart': function(e) { self.dragOrdering_(e) } },\n          parent: layer_buttons\n        });\n      }\n    }\n\n    // Show/hide sub layers\n    if (layer.getLayers) {\n      var nb = 0;\n      layer.getLayers().forEach(function(l) {\n        if (self.displayInLayerSwitcher(l)) nb++;\n      });\n      if (nb) {\n        ol_ext_element.create('DIV', {\n          className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\n          title: this.tip.plus,\n          click: function() {\n            var l = self._getLayerForLI(this.parentNode.parentNode);\n            l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\") )\n          },\n          parent: layer_buttons\n        });\n      }\n    }\n\n    // Info button\n    if (this.oninfo) {\n      ol_ext_element.create('DIV', {\n        className: 'layerInfo',\n        title: this.tip.info,\n        click: onInfo,\n        parent: layer_buttons\n      });\n    }\n    // Layer remove\n    if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\n      ol_ext_element.create('DIV', {\n        className: 'layerTrash',\n        title: this.tip.trash,\n        click: removeLayer,\n        parent: layer_buttons\n      });\n    }\n    // Layer extent\n    if (this.hasextent && layers[i].getExtent()) {\n      var ex = layers[i].getExtent();\n      if (ex.length==4 && ex[0]<ex[2] && ex[1]<ex[3]) {\n        ol_ext_element.create('DIV', {\n          className: 'layerExtent',\n          title: this.tip.extent,\n          click: zoomExtent,\n          parent: layer_buttons  \n        });\n      }\n    }\n\n    // Progress\n    if (this.show_progress && layer instanceof ol_layer_Tile) {\n      var p = ol_ext_element.create('DIV', {\n        className: 'layerswitcher-progress',\n        parent: d\n      });\n      this.setprogress_(layer);\n      layer.layerswitcher_progress = ol_ext_element.create('DIV', { parent: p });\n    }\n\n    // Opacity\n    var opacity = ol_ext_element.create('DIV', {\n      className: 'layerswitcher-opacity',\n      // Click on the opacity line\n      click: function(e){\n        if (e.target !== this) return;\n        e.stopPropagation();\n        e.preventDefault();\n        var op = Math.max ( 0, Math.min( 1, e.offsetX / ol_ext_element.getStyle(this, 'width')));\n        self._getLayerForLI(this.parentNode.parentNode).setOpacity(op);\n      },\n      parent: d\n    });\n    // Start dragging\n    ol_ext_element.create('DIV', {\n      className: 'layerswitcher-opacity-cursor',\n      style: { left: (layer.getOpacity()*100)+\"%\" },\n      on: {\n        'mousedown touchstart': function(e) { self.dragOpacity_ (e); }\n      },\n      parent: opacity\n    });\n    // Percent\n    ol_ext_element.create('DIV', {\n      className: 'layerswitcher-opacity-label',\n      html: Math.round(layer.getOpacity()*100),\n      parent: d\n    });\n\n    // Layer group\n    if (layer.getLayers) {\n      li.classList.add('ol-layer-group');\n      if (layer.get(\"openInLayerSwitcher\") === true) {\n        var ul2 = ol_ext_element.create('UL', {\n          parent: li\n        });\n        this.drawList (ul2, layer.getLayers());\n      }\n    }\n    else if (layer instanceof ol_layer_Vector) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol_layer_VectorTile) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol_layer_Tile) li.classList.add('ol-layer-tile');\n    else if (layer instanceof ol_layer_Image) li.classList.add('ol-layer-image');\n    else if (layer instanceof ol_layer_Heatmap) li.classList.add('ol-layer-heatmap');\n\n    // Dispatch a dralist event to allow customisation\n    this.dispatchEvent({ type:'drawlist', layer:layer, li:li });\n  }\n\n  this.viewChange();\n\n  if (ul === this.panel_) this.overflow();\n};\n\n/** Handle progress bar for a layer\n*\t@private\n*/\nol_control_LayerSwitcher.prototype.setprogress_ = function(layer) {\n  if (!layer.layerswitcher_progress) {\n    var loaded = 0;\n    var loading = 0;\n    var draw = function() {\n      if (loading === loaded) {\n        loading = loaded = 0;\n        ol_ext_element.setStyle(layer.layerswitcher_progress, { width: 0 });// layer.layerswitcher_progress.width(0);\n      } else {\n        ol_ext_element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' });// layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\n      }\n    }\n    layer.getSource().on('tileloadstart', function() {\n      loading++;\n      draw();\n    });\n    layer.getSource().on('tileloadend', function() {\n      loaded++;\n      draw();\n    });\n    layer.getSource().on('tileloaderror', function() {\n      loaded++;\n      draw();\n    });\n  }\n};\n\nexport default ol_control_LayerSwitcher\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n\n//# sourceMappingURL=MapBrowserEventType.js.map","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection.CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection.CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n\n//# sourceMappingURL=CollectionEventType.js.map","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @api\n */\nvar Kinetic = function Kinetic(decay, minVelocity, delay) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.decay_ = decay;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minVelocity_ = minVelocity;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delay_ = delay;\n\n  /**\n   * @private\n   * @type {Array<number>}\n   */\n  this.points_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.initialVelocity_ = 0;\n};\n\n/**\n * FIXME empty description for jsdoc\n */\nKinetic.prototype.begin = function begin () {\n  this.points_.length = 0;\n  this.angle_ = 0;\n  this.initialVelocity_ = 0;\n};\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n */\nKinetic.prototype.update = function update (x, y) {\n  this.points_.push(x, y, Date.now());\n};\n\n/**\n * @return {boolean} Whether we should do kinetic animation.\n */\nKinetic.prototype.end = function end () {\n  if (this.points_.length < 6) {\n    // at least 2 points are required (i.e. there must be at least 6 elements\n    // in the array)\n    return false;\n  }\n  var delay = Date.now() - this.delay_;\n  var lastIndex = this.points_.length - 3;\n  if (this.points_[lastIndex + 2] < delay) {\n    // the last tracked point is too old, which means that the user stopped\n    // panning before releasing the map\n    return false;\n  }\n\n  // get the first point which still falls into the delay time\n  var firstIndex = lastIndex - 3;\n  while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n    firstIndex -= 3;\n  }\n\n  var duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n  // we don't want a duration of 0 (divide by zero)\n  // we also make sure the user panned for a duration of at least one frame\n  // (1/60s) to compute sane displacement values\n  if (duration < 1000 / 60) {\n    return false;\n  }\n\n  var dx = this.points_[lastIndex] - this.points_[firstIndex];\n  var dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n  this.angle_ = Math.atan2(dy, dx);\n  this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n  return this.initialVelocity_ > this.minVelocity_;\n};\n\n/**\n * @return {number} Total distance travelled (pixels).\n */\nKinetic.prototype.getDistance = function getDistance () {\n  return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n};\n\n/**\n * @return {number} Angle of the kinetic panning animation (radians).\n */\nKinetic.prototype.getAngle = function getAngle () {\n  return this.angle_;\n};\n\nexport default Kinetic;\n\n//# sourceMappingURL=Kinetic.js.map","/**\n * @module ol/Observable\n */\nimport {listen, unlistenByKey, unlisten, listenOnce} from './events.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @fires import(\"./events/Event.js\").Event\n * @api\n */\nvar Observable = /*@__PURE__*/(function (EventTarget) {\n  function Observable() {\n\n    EventTarget.call(this);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.revision_ = 0;\n\n  }\n\n  if ( EventTarget ) Observable.__proto__ = EventTarget;\n  Observable.prototype = Object.create( EventTarget && EventTarget.prototype );\n  Observable.prototype.constructor = Observable;\n\n  /**\n   * Increases the revision counter and dispatches a 'change' event.\n   * @api\n   */\n  Observable.prototype.changed = function changed () {\n    ++this.revision_;\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * Get the version number for this object.  Each time the object is modified,\n   * its version number will be incremented.\n   * @return {number} Revision.\n   * @api\n   */\n  Observable.prototype.getRevision = function getRevision () {\n    return this.revision_;\n  };\n\n  /**\n   * Listen for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  Observable.prototype.on = function on (type, listener) {\n    if (Array.isArray(type)) {\n      var len = type.length;\n      var keys = new Array(len);\n      for (var i = 0; i < len; ++i) {\n        keys[i] = listen(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listen(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  /**\n   * Listen once for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  Observable.prototype.once = function once (type, listener) {\n    if (Array.isArray(type)) {\n      var len = type.length;\n      var keys = new Array(len);\n      for (var i = 0; i < len; ++i) {\n        keys[i] = listenOnce(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listenOnce(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  /**\n   * Unlisten for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @api\n   */\n  Observable.prototype.un = function un (type, listener) {\n    if (Array.isArray(type)) {\n      for (var i = 0, ii = type.length; i < ii; ++i) {\n        unlisten(this, type[i], listener);\n      }\n      return;\n    } else {\n      unlisten(this, /** @type {string} */ (type), listener);\n    }\n  };\n\n  return Observable;\n}(EventTarget));\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (var i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {import(\"./events.js\").EventsKey} */ (key));\n  }\n}\n\n\nexport default Observable;\n\n//# sourceMappingURL=Observable.js.map","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n\n//# sourceMappingURL=ViewHint.js.map","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlisten, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\n\n/**\n * @typedef {typeof Feature|typeof import(\"./render/Feature.js\").default} FeatureClass\n */\n\n/**\n * @typedef {Feature|import(\"./render/Feature.js\").default} FeatureLike\n */\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @api\n */\nvar Feature = /*@__PURE__*/(function (BaseObject) {\n  function Feature(opt_geometryOrProperties) {\n\n    BaseObject.call(this);\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = undefined;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.geometryName_ = 'geometry';\n\n    /**\n     * User provided style.\n     * @private\n     * @type {import(\"./style/Style.js\").StyleLike}\n     */\n    this.style_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction_ = undefined;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.geometryChangeKey_ = null;\n\n    listen(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n\n    if (opt_geometryOrProperties) {\n      if (typeof /** @type {?} */ (opt_geometryOrProperties).getSimplifiedGeometry === 'function') {\n        var geometry = /** @type {import(\"./geom/Geometry.js\").default} */ (opt_geometryOrProperties);\n        this.setGeometry(geometry);\n      } else {\n        /** @type {Object<string, *>} */\n        var properties = opt_geometryOrProperties;\n        this.setProperties(properties);\n      }\n    }\n  }\n\n  if ( BaseObject ) Feature.__proto__ = BaseObject;\n  Feature.prototype = Object.create( BaseObject && BaseObject.prototype );\n  Feature.prototype.constructor = Feature;\n\n  /**\n   * Clone this feature. If the original feature has a geometry it\n   * is also cloned. The feature id is not set in the clone.\n   * @return {Feature} The clone.\n   * @api\n   */\n  Feature.prototype.clone = function clone () {\n    var clone = new Feature(this.getProperties());\n    clone.setGeometryName(this.getGeometryName());\n    var geometry = this.getGeometry();\n    if (geometry) {\n      clone.setGeometry(geometry.clone());\n    }\n    var style = this.getStyle();\n    if (style) {\n      clone.setStyle(style);\n    }\n    return clone;\n  };\n\n  /**\n   * Get the feature's default geometry.  A feature may have any number of named\n   * geometries.  The \"default\" geometry (the one that is rendered by default) is\n   * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n   * @return {import(\"./geom/Geometry.js\").default|undefined} The default geometry for the feature.\n   * @api\n   * @observable\n   */\n  Feature.prototype.getGeometry = function getGeometry () {\n    return (\n      /** @type {import(\"./geom/Geometry.js\").default|undefined} */ (this.get(this.geometryName_))\n    );\n  };\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is either set when reading data from a remote source or set explicitly by\n   * calling {@link module:ol/Feature~Feature#setId}.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  Feature.prototype.getId = function getId () {\n    return this.id_;\n  };\n\n  /**\n   * Get the name of the feature's default geometry.  By default, the default\n   * geometry is named `geometry`.\n   * @return {string} Get the property name associated with the default geometry\n   *     for this feature.\n   * @api\n   */\n  Feature.prototype.getGeometryName = function getGeometryName () {\n    return this.geometryName_;\n  };\n\n  /**\n   * Get the feature's style. Will return what was provided to the\n   * {@link module:ol/Feature~Feature#setStyle} method.\n   * @return {import(\"./style/Style.js\").StyleLike} The feature style.\n   * @api\n   */\n  Feature.prototype.getStyle = function getStyle () {\n    return this.style_;\n  };\n\n  /**\n   * Get the feature's style function.\n   * @return {import(\"./style/Style.js\").StyleFunction|undefined} Return a function\n   * representing the current style of this feature.\n   * @api\n   */\n  Feature.prototype.getStyleFunction = function getStyleFunction () {\n    return this.styleFunction_;\n  };\n\n  /**\n   * @private\n   */\n  Feature.prototype.handleGeometryChange_ = function handleGeometryChange_ () {\n    this.changed();\n  };\n\n  /**\n   * @private\n   */\n  Feature.prototype.handleGeometryChanged_ = function handleGeometryChanged_ () {\n    if (this.geometryChangeKey_) {\n      unlistenByKey(this.geometryChangeKey_);\n      this.geometryChangeKey_ = null;\n    }\n    var geometry = this.getGeometry();\n    if (geometry) {\n      this.geometryChangeKey_ = listen(geometry,\n        EventType.CHANGE, this.handleGeometryChange_, this);\n    }\n    this.changed();\n  };\n\n  /**\n   * Set the default geometry for the feature.  This will update the property\n   * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n   * @param {import(\"./geom/Geometry.js\").default|undefined} geometry The new geometry.\n   * @api\n   * @observable\n   */\n  Feature.prototype.setGeometry = function setGeometry (geometry) {\n    this.set(this.geometryName_, geometry);\n  };\n\n  /**\n   * Set the style for the feature.  This can be a single style object, an array\n   * of styles, or a function that takes a resolution and returns an array of\n   * styles. If it is `null` the feature has no style (a `null` style).\n   * @param {import(\"./style/Style.js\").StyleLike} style Style for this feature.\n   * @api\n   * @fires module:ol/events/Event~Event#event:change\n   */\n  Feature.prototype.setStyle = function setStyle (style) {\n    this.style_ = style;\n    this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n    this.changed();\n  };\n\n  /**\n   * Set the feature id.  The feature id is considered stable and may be used when\n   * requesting features or comparing identifiers returned from a remote source.\n   * The feature id can be used with the\n   * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n   * @param {number|string|undefined} id The feature id.\n   * @api\n   * @fires module:ol/events/Event~Event#event:change\n   */\n  Feature.prototype.setId = function setId (id) {\n    this.id_ = id;\n    this.changed();\n  };\n\n  /**\n   * Set the property name to be used when getting the feature's default geometry.\n   * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n   * this name will be returned.\n   * @param {string} name The property name of the default geometry.\n   * @api\n   */\n  Feature.prototype.setGeometryName = function setGeometryName (name) {\n    unlisten(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n    this.geometryName_ = name;\n    listen(\n      this, getChangeEventType(this.geometryName_),\n      this.handleGeometryChanged_, this);\n    this.handleGeometryChanged_();\n  };\n\n  return Feature;\n}(BaseObject));\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of Style or single style objects wrapped\n * in a new feature style function.\n * @param {!import(\"./style/Style.js\").StyleFunction|!Array<import(\"./style/Style.js\").default>|!import(\"./style/Style.js\").default} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {import(\"./style/Style.js\").StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array<import(\"./style/Style.js\").default>}\n     */\n    var styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(typeof /** @type {?} */ (obj).getZIndex === 'function',\n        41); // Expected an `import(\"./style/Style.js\").Style` or an array of `import(\"./style/Style.js\").Style`\n      var style = /** @type {import(\"./style/Style.js\").default} */ (obj);\n      styles = [style];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n\n//# sourceMappingURL=Feature.js.map","/**\n * @module ol/MapBrowserEvent\n */\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map browser event.\n */\nvar MapBrowserEvent = /*@__PURE__*/(function (MapEvent) {\n  function MapBrowserEvent(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n    MapEvent.call(this, type, map, opt_frameState);\n\n    /**\n     * The original browser event.\n     * @const\n     * @type {Event}\n     * @api\n     */\n    this.originalEvent = browserEvent;\n\n    /**\n     * The map pixel relative to the viewport corresponding to the original browser event.\n     * @type {import(\"./pixel.js\").Pixel}\n     * @api\n     */\n    this.pixel = map.getEventPixel(browserEvent);\n\n    /**\n     * The coordinate in view projection corresponding to the original browser event.\n     * @type {import(\"./coordinate.js\").Coordinate}\n     * @api\n     */\n    this.coordinate = map.getCoordinateFromPixel(this.pixel);\n\n    /**\n     * Indicates if the map is currently being dragged. Only set for\n     * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n     *\n     * @type {boolean}\n     * @api\n     */\n    this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n  }\n\n  if ( MapEvent ) MapBrowserEvent.__proto__ = MapEvent;\n  MapBrowserEvent.prototype = Object.create( MapEvent && MapEvent.prototype );\n  MapBrowserEvent.prototype.constructor = MapBrowserEvent;\n\n  /**\n   * Prevents the default browser action.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault.\n   * @override\n   * @api\n   */\n  MapBrowserEvent.prototype.preventDefault = function preventDefault () {\n    MapEvent.prototype.preventDefault.call(this);\n    this.originalEvent.preventDefault();\n  };\n\n  /**\n   * Prevents further propagation of the current event.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation.\n   * @override\n   * @api\n   */\n  MapBrowserEvent.prototype.stopPropagation = function stopPropagation () {\n    MapEvent.prototype.stopPropagation.call(this);\n    this.originalEvent.stopPropagation();\n  };\n\n  return MapBrowserEvent;\n}(MapEvent));\n\n\nexport default MapBrowserEvent;\n\n//# sourceMappingURL=MapBrowserEvent.js.map","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n\n//# sourceMappingURL=MapEventType.js.map","/**\n * @module ol/LayerType\n */\n\n/**\n * A layer type used when creating layer renderers.\n * @enum {string}\n */\nexport default {\n  IMAGE: 'IMAGE',\n  TILE: 'TILE',\n  VECTOR_TILE: 'VECTOR_TILE',\n  VECTOR: 'VECTOR'\n};\n\n//# sourceMappingURL=LayerType.js.map","/**\n * @module ol/Tile\n */\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n\n/**\n * A function that takes an {@link module:ol/Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   var xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     var data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string)} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~Tile} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @api\n */\n\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nvar Tile = /*@__PURE__*/(function (EventTarget) {\n  function Tile(tileCoord, state, opt_options) {\n    EventTarget.call(this);\n\n    var options = opt_options ? opt_options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {TileState}\n     */\n    this.state = state;\n\n    /**\n     * An \"interim\" tile for this tile. The interim tile may be used while this\n     * one is loading, for \"smooth\" transitions when changing params/dimensions\n     * on the source.\n     * @type {Tile}\n     */\n    this.interimTile = null;\n\n    /**\n     * A key assigned to the tile. This is used by the tile source to determine\n     * if this tile can effectively be used, or if a new tile should be created\n     * and this one be used as an interim tile for this new tile.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @type {number}\n     */\n    this.transition_ = options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n  }\n\n  if ( EventTarget ) Tile.__proto__ = EventTarget;\n  Tile.prototype = Object.create( EventTarget && EventTarget.prototype );\n  Tile.prototype.constructor = Tile;\n\n  /**\n   * @protected\n   */\n  Tile.prototype.changed = function changed () {\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * @return {string} Key.\n   */\n  Tile.prototype.getKey = function getKey () {\n    return this.key + '/' + this.tileCoord;\n  };\n\n  /**\n   * Get the interim tile most suitable for rendering using the chain of interim\n   * tiles. This corresponds to the  most recent tile that has been loaded, if no\n   * such tile exists, the original tile is returned.\n   * @return {!Tile} Best tile for rendering.\n   */\n  Tile.prototype.getInterimTile = function getInterimTile () {\n    if (!this.interimTile) {\n      //empty chain\n      return this;\n    }\n    var tile = this.interimTile;\n\n    // find the first loaded tile and return it. Since the chain is sorted in\n    // decreasing order of creation time, there is no need to search the remainder\n    // of the list (all those tiles correspond to older requests and will be\n    // cleaned up by refreshInterimChain)\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        return tile;\n      }\n      tile = tile.interimTile;\n    } while (tile);\n\n    // we can not find a better tile\n    return this;\n  };\n\n  /**\n   * Goes through the chain of interim tiles and discards sections of the chain\n   * that are no longer relevant.\n   */\n  Tile.prototype.refreshInterimChain = function refreshInterimChain () {\n    if (!this.interimTile) {\n      return;\n    }\n\n    var tile = this.interimTile;\n    var prev = /** @type {Tile} */ (this);\n\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        //we have a loaded tile, we can discard the rest of the list\n        //we would could abort any LOADING tile request\n        //older than this tile (i.e. any LOADING tile following this entry in the chain)\n        tile.interimTile = null;\n        break;\n      } else if (tile.getState() == TileState.LOADING) {\n        //keep this LOADING tile any loaded tiles later in the chain are\n        //older than this tile, so we're still interested in the request\n        prev = tile;\n      } else if (tile.getState() == TileState.IDLE) {\n        //the head of the list is the most current tile, we don't need\n        //to start any other requests for this chain\n        prev.interimTile = tile.interimTile;\n      } else {\n        prev = tile;\n      }\n      tile = prev.interimTile;\n    } while (tile);\n  };\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  Tile.prototype.getTileCoord = function getTileCoord () {\n    return this.tileCoord;\n  };\n\n  /**\n   * @return {TileState} State.\n   */\n  Tile.prototype.getState = function getState () {\n    return this.state;\n  };\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {TileState} state State.\n   * @api\n   */\n  Tile.prototype.setState = function setState (state) {\n    this.state = state;\n    this.changed();\n  };\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  Tile.prototype.load = function load () {};\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  Tile.prototype.getAlpha = function getAlpha (id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    var start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    var delta = time - start + (1000 / 60); // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  };\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  Tile.prototype.inTransition = function inTransition (id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  };\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  Tile.prototype.endTransition = function endTransition (id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  };\n\n  return Tile;\n}(EventTarget));\n\n\nexport default Tile;\n\n//# sourceMappingURL=Tile.js.map","/**\n * @module ol/MapBrowserEventHandler\n */\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/Target.js';\nimport PointerEventType from './pointer/EventType.js';\nimport PointerEventHandler from './pointer/PointerEventHandler.js';\n\nvar MapBrowserEventHandler = /*@__PURE__*/(function (EventTarget) {\n  function MapBrowserEventHandler(map, moveTolerance) {\n\n    EventTarget.call(this);\n\n    /**\n     * This is the element that we will listen to the real events on.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {any}\n     * @private\n     */\n    this.clickTimeoutId_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_ = false;\n\n    /**\n     * @type {!Array<import(\"./events.js\").EventsKey>}\n     * @private\n     */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.moveTolerance_ = moveTolerance ?\n      moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n    /**\n     * The most recent \"down\" type event (or null if none have occurred).\n     * Set on pointerdown.\n     * @type {import(\"./pointer/PointerEvent.js\").default}\n     * @private\n     */\n    this.down_ = null;\n\n    var element = this.map_.getViewport();\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.activePointers_ = 0;\n\n    /**\n     * @type {!Object<number, boolean>}\n     * @private\n     */\n    this.trackedTouches_ = {};\n\n    /**\n     * Event handler which generates pointer events for\n     * the viewport element.\n     *\n     * @type {PointerEventHandler}\n     * @private\n     */\n    this.pointerEventHandler_ = new PointerEventHandler(element);\n\n    /**\n     * Event handler which generates pointer events for\n     * the document (used when dragging).\n     *\n     * @type {PointerEventHandler}\n     * @private\n     */\n    this.documentPointerEventHandler_ = null;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.pointerdownListenerKey_ = listen(this.pointerEventHandler_,\n      PointerEventType.POINTERDOWN,\n      this.handlePointerDown_, this);\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.relayedListenerKey_ = listen(this.pointerEventHandler_,\n      PointerEventType.POINTERMOVE,\n      this.relayEvent_, this);\n\n  }\n\n  if ( EventTarget ) MapBrowserEventHandler.__proto__ = EventTarget;\n  MapBrowserEventHandler.prototype = Object.create( EventTarget && EventTarget.prototype );\n  MapBrowserEventHandler.prototype.constructor = MapBrowserEventHandler;\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.emulateClick_ = function emulateClick_ (pointerEvent) {\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.CLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n    if (this.clickTimeoutId_ !== undefined) {\n      // double-click\n      clearTimeout(this.clickTimeoutId_);\n      this.clickTimeoutId_ = undefined;\n      newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    } else {\n      // click\n      this.clickTimeoutId_ = setTimeout(function() {\n        this.clickTimeoutId_ = undefined;\n        var newEvent = new MapBrowserPointerEvent(\n          MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n        this.dispatchEvent(newEvent);\n      }.bind(this), 250);\n    }\n  };\n\n  /**\n   * Keeps track on how many pointers are currently active.\n   *\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.updateActivePointers_ = function updateActivePointers_ (pointerEvent) {\n    var event = pointerEvent;\n\n    if (event.type == MapBrowserEventType.POINTERUP ||\n        event.type == MapBrowserEventType.POINTERCANCEL) {\n      delete this.trackedTouches_[event.pointerId];\n    } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n      this.trackedTouches_[event.pointerId] = true;\n    }\n    this.activePointers_ = Object.keys(this.trackedTouches_).length;\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerUp_ = function handlePointerUp_ (pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    // We emulate click events on left mouse button click, touch contact, and pen\n    // contact. isMouseActionButton returns true in these cases (evt.button is set\n    // to 0).\n    // See http://www.w3.org/TR/pointerevents/#button-states\n    // We only fire click, singleclick, and doubleclick if nobody has called\n    // event.stopPropagation() or event.preventDefault().\n    if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n      this.emulateClick_(this.down_);\n    }\n\n    if (this.activePointers_ === 0) {\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n      this.dragging_ = false;\n      this.down_ = null;\n      this.documentPointerEventHandler_.dispose();\n      this.documentPointerEventHandler_ = null;\n    }\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @return {boolean} If the left mouse button was pressed.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.isMouseActionButton_ = function isMouseActionButton_ (pointerEvent) {\n    return pointerEvent.button === 0;\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerDown_ = function handlePointerDown_ (pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    var newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    this.down_ = pointerEvent;\n\n    if (this.dragListenerKeys_.length === 0) {\n      /* Set up a pointer event handler on the `document`,\n       * which is required when the pointer is moved outside\n       * the viewport when dragging.\n       */\n      this.documentPointerEventHandler_ =\n          new PointerEventHandler(document);\n\n      this.dragListenerKeys_.push(\n        listen(this.documentPointerEventHandler_,\n          MapBrowserEventType.POINTERMOVE,\n          this.handlePointerMove_, this),\n        listen(this.documentPointerEventHandler_,\n          MapBrowserEventType.POINTERUP,\n          this.handlePointerUp_, this),\n        /* Note that the listener for `pointercancel is set up on\n         * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n         * the `pointerup` and `pointermove` listeners.\n         *\n         * The reason for this is the following: `TouchSource.vacuumTouches_()`\n         * issues `pointercancel` events, when there was no `touchend` for a\n         * `touchstart`. Now, let's say a first `touchstart` is registered on\n         * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n         * But `documentPointerEventHandler_` doesn't know about the first\n         * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n         * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n         * only registered there.\n         */\n        listen(this.pointerEventHandler_,\n          MapBrowserEventType.POINTERCANCEL,\n          this.handlePointerUp_, this)\n      );\n    }\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.handlePointerMove_ = function handlePointerMove_ (pointerEvent) {\n    // Between pointerdown and pointerup, pointermove events are triggered.\n    // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n    // moved a significant distance.\n    if (this.isMoving_(pointerEvent)) {\n      this.dragging_ = true;\n      var newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n        this.dragging_);\n      this.dispatchEvent(newEvent);\n    }\n\n    // Some native android browser triggers mousemove events during small period\n    // of time. See: https://code.google.com/p/android/issues/detail?id=5491 or\n    // https://code.google.com/p/android/issues/detail?id=19827\n    // ex: Galaxy Tab P3110 + Android 4.1.1\n    pointerEvent.preventDefault();\n  };\n\n  /**\n   * Wrap and relay a pointer event.  Note that this requires that the type\n   * string for the MapBrowserPointerEvent matches the PointerEvent type.\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.relayEvent_ = function relayEvent_ (pointerEvent) {\n    var dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n    this.dispatchEvent(new MapBrowserPointerEvent(\n      pointerEvent.type, this.map_, pointerEvent, dragging));\n  };\n\n  /**\n   * @param {import(\"./pointer/PointerEvent.js\").default} pointerEvent Pointer\n   * event.\n   * @return {boolean} Is moving.\n   * @private\n   */\n  MapBrowserEventHandler.prototype.isMoving_ = function isMoving_ (pointerEvent) {\n    return this.dragging_ ||\n        Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n        Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  MapBrowserEventHandler.prototype.disposeInternal = function disposeInternal () {\n    if (this.relayedListenerKey_) {\n      unlistenByKey(this.relayedListenerKey_);\n      this.relayedListenerKey_ = null;\n    }\n    if (this.pointerdownListenerKey_) {\n      unlistenByKey(this.pointerdownListenerKey_);\n      this.pointerdownListenerKey_ = null;\n    }\n\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n\n    if (this.documentPointerEventHandler_) {\n      this.documentPointerEventHandler_.dispose();\n      this.documentPointerEventHandler_ = null;\n    }\n    if (this.pointerEventHandler_) {\n      this.pointerEventHandler_.dispose();\n      this.pointerEventHandler_ = null;\n    }\n    EventTarget.prototype.disposeInternal.call(this);\n  };\n\n  return MapBrowserEventHandler;\n}(EventTarget));\n\n\nexport default MapBrowserEventHandler;\n\n//# sourceMappingURL=MapBrowserEventHandler.js.map","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n\n//# sourceMappingURL=MapProperty.js.map","/**\n * @module ol/TileQueue\n */\nimport TileState from './TileState.js';\nimport {listen, unlisten} from './events.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\n\nvar TileQueue = /*@__PURE__*/(function (PriorityQueue) {\n  function TileQueue(tilePriorityFunction, tileChangeCallback) {\n\n    PriorityQueue.call(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      this, function(element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function(element) {\n        return (/** @type {import(\"./Tile.js\").default} */ (element[0]).getKey());\n      });\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n\n  }\n\n  if ( PriorityQueue ) TileQueue.__proto__ = PriorityQueue;\n  TileQueue.prototype = Object.create( PriorityQueue && PriorityQueue.prototype );\n  TileQueue.prototype.constructor = TileQueue;\n\n  /**\n   * @inheritDoc\n   */\n  TileQueue.prototype.enqueue = function enqueue (element) {\n    var added = PriorityQueue.prototype.enqueue.call(this, element);\n    if (added) {\n      var tile = element[0];\n      listen(tile, EventType.CHANGE, this.handleTileChange, this);\n    }\n    return added;\n  };\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  TileQueue.prototype.getTilesLoading = function getTilesLoading () {\n    return this.tilesLoading_;\n  };\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  TileQueue.prototype.handleTileChange = function handleTileChange (event) {\n    var tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    var state = tile.getState();\n    if (state === TileState.LOADED || state === TileState.ERROR ||\n        state === TileState.EMPTY || state === TileState.ABORT) {\n      unlisten(tile, EventType.CHANGE, this.handleTileChange, this);\n      var tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  };\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  TileQueue.prototype.loadMoreTiles = function loadMoreTiles (maxTotalLoading, maxNewLoads) {\n    var newLoads = 0;\n    var abortedTiles = false;\n    var state, tile, tileKey;\n    while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n           this.getCount() > 0) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.ABORT) {\n        abortedTiles = true;\n      } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n    if (newLoads === 0 && abortedTiles) {\n      // Do not stop the render loop when all wanted tiles were aborted due to\n      // a small, saturated tile cache.\n      this.tileChangeCallback_();\n    }\n  };\n\n  return TileQueue;\n}(PriorityQueue));\n\n\nexport default TileQueue;\n\n//# sourceMappingURL=TileQueue.js.map","/**\n * @module ol/PluggableMap\n */\nimport {getUid} from './util.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport RenderEventType from './render/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey, unlisten} from './events.js';\nimport {stopPropagation} from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {createEmpty, clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, TOUCH} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {import(\"./View.js\").State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {import(\"./transform.js\").Transform} coordinateToPixelTransform\n * @property {null|import(\"./extent.js\").Extent} extent\n * @property {import(\"./coordinate.js\").Coordinate} focus\n * @property {number} index\n * @property {Object<string, import(\"./layer/Layer.js\").State>} layerStates\n * @property {Array<import(\"./layer/Layer.js\").State>} layerStatesArray\n * @property {import(\"./transform.js\").Transform} pixelToCoordinateTransform\n * @property {Array<PostRenderFunction>} postRenderFunctions\n * @property {import(\"./size.js\").Size} size\n * @property {!Object<string, boolean>} skippedFeatureUids\n * @property {TileQueue} tileQueue\n * @property {Object<string, Object<string, import(\"./TileRange.js\").default>>} usedTiles\n * @property {Array<number>} viewHints\n * @property {!Object<string, Object<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {function(PluggableMap, ?FrameState): boolean} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {undefined|function(import(\"./layer/Layer.js\").default): boolean} layerFilter Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {Collection<import(\"./control/Control.js\").default>} [controls]\n * @property {Collection<import(\"./interaction/Interaction.js\").default>} [interactions]\n * @property {HTMLElement|Document} keyboardEventTarget\n * @property {Collection<import(\"./Overlay.js\").default>} overlays\n * @property {Object<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {Collection<import(\"./control/Control.js\").default>|Array<import(\"./control/Control.js\").default>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>|Array<import(\"./interaction/Interaction.js\").default>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {HTMLElement|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>|LayerGroup} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {boolean} [loadTilesWhileAnimating=false] When set to `true`, tiles\n * will be loaded during animations. This may improve the user experience, but\n * can also make animations stutter on devices with slow memory.\n * @property {boolean} [loadTilesWhileInteracting=false] When set to `true`,\n * tiles will be loaded while interacting with the map. This may improve the\n * user experience, but can also make map panning and zooming choppy on devices\n * with slow memory.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {Collection<import(\"./Overlay.js\").default>|Array<import(\"./Overlay.js\").default>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {HTMLElement|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @fires module:ol/render/Event~RenderEvent#rendercomplete\n * @api\n */\nvar PluggableMap = /*@__PURE__*/(function (BaseObject) {\n  function PluggableMap(options) {\n\n    BaseObject.call(this);\n\n    var optionsInternal = createOptionsInternal(options);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loadTilesWhileAnimating_ =\n        options.loadTilesWhileAnimating !== undefined ?\n          options.loadTilesWhileAnimating : false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.loadTilesWhileInteracting_ =\n        options.loadTilesWhileInteracting !== undefined ?\n          options.loadTilesWhileInteracting : false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = options.pixelRatio !== undefined ?\n      options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.animationDelayKey_;\n\n    /**\n     * @private\n     */\n    this.animationDelay_ = function() {\n      this.animationDelayKey_ = undefined;\n      this.renderFrame_.call(this, Date.now());\n    }.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.coordinateToPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.pixelToCoordinateTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.frameIndex_ = 0;\n\n    /**\n     * @private\n     * @type {?FrameState}\n     */\n    this.frameState_ = null;\n\n    /**\n     * The extent at the previous 'moveend' event.\n     * @private\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.previousExtent_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewPropertyListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewChangeListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.layerGroupPropertyListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.viewport_ = document.createElement('div');\n    this.viewport_.className = 'ol-viewport' + (TOUCH ? ' ol-touch' : '');\n    this.viewport_.style.position = 'relative';\n    this.viewport_.style.overflow = 'hidden';\n    this.viewport_.style.width = '100%';\n    this.viewport_.style.height = '100%';\n    // prevent page zoom on IE >= 10 browsers\n    this.viewport_.style.msTouchAction = 'none';\n    this.viewport_.style.touchAction = 'none';\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainer_ = document.createElement('div');\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.viewport_.appendChild(this.overlayContainer_);\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainerStopEvent_ = document.createElement('div');\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    var overlayEvents = [\n      EventType.CLICK,\n      EventType.DBLCLICK,\n      EventType.MOUSEDOWN,\n      EventType.TOUCHSTART,\n      EventType.MSPOINTERDOWN,\n      MapBrowserEventType.POINTERDOWN,\n      EventType.MOUSEWHEEL,\n      EventType.WHEEL\n    ];\n    for (var i = 0, ii = overlayEvents.length; i < ii; ++i) {\n      listen(this.overlayContainerStopEvent_, overlayEvents[i], stopPropagation);\n    }\n    this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n     * @private\n     * @type {MapBrowserEventHandler}\n     */\n    this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n    for (var key in MapBrowserEventType) {\n      listen(this.mapBrowserEventHandler_, MapBrowserEventType[key],\n        this.handleMapBrowserEvent, this);\n    }\n\n    /**\n     * @private\n     * @type {HTMLElement|Document}\n     */\n    this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.keyHandlerKeys_ = null;\n\n    listen(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n    listen(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n    listen(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n\n    /**\n     * @type {Collection<import(\"./control/Control.js\").default>}\n     * @protected\n     */\n    this.controls = optionsInternal.controls || new Collection();\n\n    /**\n     * @type {Collection<import(\"./interaction/Interaction.js\").default>}\n     * @protected\n     */\n    this.interactions = optionsInternal.interactions || new Collection();\n\n    /**\n     * @type {Collection<import(\"./Overlay.js\").default>}\n     * @private\n     */\n    this.overlays_ = optionsInternal.overlays;\n\n    /**\n     * A lookup of overlays by id.\n     * @private\n     * @type {Object<string, import(\"./Overlay.js\").default>}\n     */\n    this.overlayIdIndex_ = {};\n\n    /**\n     * @type {import(\"./renderer/Map.js\").default}\n     * @private\n     */\n    this.renderer_ = this.createRenderer();\n\n    /**\n     * @type {function(Event)|undefined}\n     * @private\n     */\n    this.handleResize_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate}\n     */\n    this.focus_ = null;\n\n    /**\n     * @private\n     * @type {!Array<PostRenderFunction>}\n     */\n    this.postRenderFunctions_ = [];\n\n    /**\n     * @private\n     * @type {TileQueue}\n     */\n    this.tileQueue_ = new TileQueue(\n      this.getTilePriority.bind(this),\n      this.handleTileChange_.bind(this));\n\n    /**\n     * Uids of features to skip at rendering time.\n     * @type {Object<string, boolean>}\n     * @private\n     */\n    this.skippedFeatureUids_ = {};\n\n    listen(\n      this, getChangeEventType(MapProperty.LAYERGROUP),\n      this.handleLayerGroupChanged_, this);\n    listen(this, getChangeEventType(MapProperty.VIEW),\n      this.handleViewChanged_, this);\n    listen(this, getChangeEventType(MapProperty.SIZE),\n      this.handleSizeChanged_, this);\n    listen(this, getChangeEventType(MapProperty.TARGET),\n      this.handleTargetChanged_, this);\n\n    // setProperties will trigger the rendering of the map if the map\n    // is \"defined\" already.\n    this.setProperties(optionsInternal.values);\n\n    this.controls.forEach(\n      /**\n       * @param {import(\"./control/Control.js\").default} control Control.\n       * @this {PluggableMap}\n       */\n      (function(control) {\n        control.setMap(this);\n      }).bind(this));\n\n    listen(this.controls, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }, this);\n\n    listen(this.controls, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }, this);\n\n    this.interactions.forEach(\n      /**\n       * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction.\n       * @this {PluggableMap}\n       */\n      (function(interaction) {\n        interaction.setMap(this);\n      }).bind(this));\n\n    listen(this.interactions, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }, this);\n\n    listen(this.interactions, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }, this);\n\n    this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n    listen(this.overlays_, CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        this.addOverlayInternal_(/** @type {import(\"./Overlay.js\").default} */ (event.element));\n      }, this);\n\n    listen(this.overlays_, CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        var overlay = /** @type {import(\"./Overlay.js\").default} */ (event.element);\n        var id = overlay.getId();\n        if (id !== undefined) {\n          delete this.overlayIdIndex_[id.toString()];\n        }\n        event.element.setMap(null);\n      }, this);\n\n  }\n\n  if ( BaseObject ) PluggableMap.__proto__ = BaseObject;\n  PluggableMap.prototype = Object.create( BaseObject && BaseObject.prototype );\n  PluggableMap.prototype.constructor = PluggableMap;\n\n  /**\n   * @abstract\n   * @return {import(\"./renderer/Map.js\").default} The map renderer\n   */\n  PluggableMap.prototype.createRenderer = function createRenderer () {\n    throw new Error('Use a map type that has a createRenderer method');\n  };\n\n  /**\n   * Add the given control to the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @api\n   */\n  PluggableMap.prototype.addControl = function addControl (control) {\n    this.getControls().push(control);\n  };\n\n  /**\n   * Add the given interaction to the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to add.\n   * @api\n   */\n  PluggableMap.prototype.addInteraction = function addInteraction (interaction) {\n    this.getInteractions().push(interaction);\n  };\n\n  /**\n   * Adds the given layer to the top of this map. If you want to add a layer\n   * elsewhere in the stack, use `getLayers()` and the methods available on\n   * {@link module:ol/Collection~Collection}.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @api\n   */\n  PluggableMap.prototype.addLayer = function addLayer (layer) {\n    var layers = this.getLayerGroup().getLayers();\n    layers.push(layer);\n  };\n\n  /**\n   * Add the given overlay to the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @api\n   */\n  PluggableMap.prototype.addOverlay = function addOverlay (overlay) {\n    this.getOverlays().push(overlay);\n  };\n\n  /**\n   * This deals with map's overlay collection changes.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @private\n   */\n  PluggableMap.prototype.addOverlayInternal_ = function addOverlayInternal_ (overlay) {\n    var id = overlay.getId();\n    if (id !== undefined) {\n      this.overlayIdIndex_[id.toString()] = overlay;\n    }\n    overlay.setMap(this);\n  };\n\n  /**\n   *\n   * @inheritDoc\n   */\n  PluggableMap.prototype.disposeInternal = function disposeInternal () {\n    this.mapBrowserEventHandler_.dispose();\n    unlisten(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n    unlisten(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n    unlisten(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n      this.animationDelayKey_ = undefined;\n    }\n    this.setTarget(null);\n    BaseObject.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Detect features that intersect a pixel on the viewport, and execute a\n   * callback with each intersecting feature. Layers included in the detection can\n   * be configured through the `layerFilter` option in `opt_options`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./Feature.js\").FeatureLike,\n   *     import(\"./layer/Layer.js\").default): T} callback Feature callback. The callback will be\n   *     called with two arguments. The first argument is one\n   *     {@link module:ol/Feature feature} or\n   *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n   *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n   *     unmanaged layers. To stop detection, callback functions can return a\n   *     truthy value.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  PluggableMap.prototype.forEachFeatureAtPixel = function forEachFeatureAtPixel (pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    var coordinate = this.getCoordinateFromPixel(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    var hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    var layerFilter = opt_options.layerFilter !== undefined ?\n      opt_options.layerFilter : TRUE;\n    return this.renderer_.forEachFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, callback, null,\n      layerFilter, null);\n  };\n\n  /**\n   * Get all features that intersect a pixel on the viewport.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} The detected features or\n   * `null` if none were found.\n   * @api\n   */\n  PluggableMap.prototype.getFeaturesAtPixel = function getFeaturesAtPixel (pixel, opt_options) {\n    var features = null;\n    this.forEachFeatureAtPixel(pixel, function(feature) {\n      if (!features) {\n        features = [];\n      }\n      features.push(feature);\n    }, opt_options);\n    return features;\n  };\n\n  /**\n   * Detect layers that have a color value at a pixel on the viewport, and\n   * execute a callback with each matching layer. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback\n   *     Layer callback. This callback will receive two arguments: first is the\n   *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n   *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n   *     that do not currently support this argument. To stop detection, callback\n   *     functions can return a truthy value.\n   * @param {AtPixelOptions=} opt_options Configuration options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  PluggableMap.prototype.forEachLayerAtPixel = function forEachLayerAtPixel (pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    var options = opt_options || /** @type {AtPixelOptions} */ ({});\n    var hitTolerance = options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    var layerFilter = options.layerFilter || TRUE;\n    return this.renderer_.forEachLayerAtPixel(\n      pixel, this.frameState_, hitTolerance, callback, null, layerFilter, null);\n  };\n\n  /**\n   * Detect if features intersect a pixel on the viewport. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {boolean} Is there a feature at the given pixel?\n   * @template U\n   * @api\n   */\n  PluggableMap.prototype.hasFeatureAtPixel = function hasFeatureAtPixel (pixel, opt_options) {\n    if (!this.frameState_) {\n      return false;\n    }\n    var coordinate = this.getCoordinateFromPixel(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    var layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n    var hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    return this.renderer_.hasFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, layerFilter, null);\n  };\n\n  /**\n   * Returns the coordinate in view projection for a browser event.\n   * @param {Event} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  PluggableMap.prototype.getEventCoordinate = function getEventCoordinate (event) {\n    return this.getCoordinateFromPixel(this.getEventPixel(event));\n  };\n\n  /**\n   * Returns the map pixel position for a browser event relative to the viewport.\n   * @param {Event|TouchEvent} event Event.\n   * @return {import(\"./pixel.js\").Pixel} Pixel.\n   * @api\n   */\n  PluggableMap.prototype.getEventPixel = function getEventPixel (event) {\n    var viewportPosition = this.viewport_.getBoundingClientRect();\n    var eventPosition = 'changedTouches' in event ?\n      /** @type {TouchEvent} */ (event).changedTouches[0] :\n      /** @type {MouseEvent} */ (event);\n\n    return [\n      eventPosition.clientX - viewportPosition.left,\n      eventPosition.clientY - viewportPosition.top\n    ];\n  };\n\n  /**\n   * Get the target in which this map is rendered.\n   * Note that this returns what is entered as an option or in setTarget:\n   * if that was an element, it returns an element; if a string, it returns that.\n   * @return {HTMLElement|string|undefined} The Element or id of the Element that the\n   *     map is rendered in.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getTarget = function getTarget () {\n    return /** @type {HTMLElement|string|undefined} */ (this.get(MapProperty.TARGET));\n  };\n\n  /**\n   * Get the DOM element into which this map is rendered. In contrast to\n   * `getTarget` this method always return an `Element`, or `null` if the\n   * map has no target.\n   * @return {HTMLElement} The element that the map is rendered in.\n   * @api\n   */\n  PluggableMap.prototype.getTargetElement = function getTargetElement () {\n    var target = this.getTarget();\n    if (target !== undefined) {\n      return typeof target === 'string' ? document.getElementById(target) : target;\n    } else {\n      return null;\n    }\n  };\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * map view projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   * @api\n   */\n  PluggableMap.prototype.getCoordinateFromPixel = function getCoordinateFromPixel (pixel) {\n    var frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n    }\n  };\n\n  /**\n   * Get the map controls. Modifying this collection changes the controls\n   * associated with the map.\n   * @return {Collection<import(\"./control/Control.js\").default>} Controls.\n   * @api\n   */\n  PluggableMap.prototype.getControls = function getControls () {\n    return this.controls;\n  };\n\n  /**\n   * Get the map overlays. Modifying this collection changes the overlays\n   * associated with the map.\n   * @return {Collection<import(\"./Overlay.js\").default>} Overlays.\n   * @api\n   */\n  PluggableMap.prototype.getOverlays = function getOverlays () {\n    return this.overlays_;\n  };\n\n  /**\n   * Get an overlay by its identifier (the value returned by overlay.getId()).\n   * Note that the index treats string and numeric identifiers as the same. So\n   * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n   * @param {string|number} id Overlay identifier.\n   * @return {import(\"./Overlay.js\").default} Overlay.\n   * @api\n   */\n  PluggableMap.prototype.getOverlayById = function getOverlayById (id) {\n    var overlay = this.overlayIdIndex_[id.toString()];\n    return overlay !== undefined ? overlay : null;\n  };\n\n  /**\n   * Get the map interactions. Modifying this collection changes the interactions\n   * associated with the map.\n   *\n   * Interactions are used for e.g. pan, zoom and rotate.\n   * @return {Collection<import(\"./interaction/Interaction.js\").default>} Interactions.\n   * @api\n   */\n  PluggableMap.prototype.getInteractions = function getInteractions () {\n    return this.interactions;\n  };\n\n  /**\n   * Get the layergroup associated with this map.\n   * @return {LayerGroup} A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getLayerGroup = function getLayerGroup () {\n    return (\n      /** @type {LayerGroup} */ (this.get(MapProperty.LAYERGROUP))\n    );\n  };\n\n  /**\n   * Get the collection of layers associated with this map.\n   * @return {!Collection<import(\"./layer/Base.js\").default>} Layers.\n   * @api\n   */\n  PluggableMap.prototype.getLayers = function getLayers () {\n    var layers = this.getLayerGroup().getLayers();\n    return layers;\n  };\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the map view\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   * @api\n   */\n  PluggableMap.prototype.getPixelFromCoordinate = function getPixelFromCoordinate (coordinate) {\n    var frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n    }\n  };\n\n  /**\n   * Get the map renderer.\n   * @return {import(\"./renderer/Map.js\").default} Renderer\n   */\n  PluggableMap.prototype.getRenderer = function getRenderer () {\n    return this.renderer_;\n  };\n\n  /**\n   * Get the size of this map.\n   * @return {import(\"./size.js\").Size|undefined} The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getSize = function getSize () {\n    return (\n      /** @type {import(\"./size.js\").Size|undefined} */ (this.get(MapProperty.SIZE))\n    );\n  };\n\n  /**\n   * Get the view associated with this map. A view manages properties such as\n   * center and resolution.\n   * @return {View} The view that controls this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.getView = function getView () {\n    return (\n      /** @type {View} */ (this.get(MapProperty.VIEW))\n    );\n  };\n\n  /**\n   * Get the element that serves as the map viewport.\n   * @return {HTMLElement} Viewport.\n   * @api\n   */\n  PluggableMap.prototype.getViewport = function getViewport () {\n    return this.viewport_;\n  };\n\n  /**\n   * Get the element that serves as the container for overlays.  Elements added to\n   * this container will let mousedown and touchstart events through to the map,\n   * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n   * events.\n   * @return {!HTMLElement} The map's overlay container.\n   */\n  PluggableMap.prototype.getOverlayContainer = function getOverlayContainer () {\n    return this.overlayContainer_;\n  };\n\n  /**\n   * Get the element that serves as a container for overlays that don't allow\n   * event propagation. Elements added to this container won't let mousedown and\n   * touchstart events through to the map, so clicks and gestures on an overlay\n   * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   * @return {!HTMLElement} The map's overlay container that stops events.\n   */\n  PluggableMap.prototype.getOverlayContainerStopEvent = function getOverlayContainerStopEvent () {\n    return this.overlayContainerStopEvent_;\n  };\n\n  /**\n   * @param {import(\"./Tile.js\").default} tile Tile.\n   * @param {string} tileSourceKey Tile source key.\n   * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n   * @param {number} tileResolution Tile resolution.\n   * @return {number} Tile priority.\n   */\n  PluggableMap.prototype.getTilePriority = function getTilePriority (tile, tileSourceKey, tileCenter, tileResolution) {\n    // Filter out tiles at higher zoom levels than the current zoom level, or that\n    // are outside the visible extent.\n    var frameState = this.frameState_;\n    if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n      return DROP;\n    }\n    if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n      return DROP;\n    }\n    // Prioritize the highest zoom level tiles closest to the focus.\n    // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n    // Within a zoom level, tiles are prioritized by the distance in pixels\n    // between the center of the tile and the focus.  The factor of 65536 means\n    // that the prioritization should behave as desired for tiles up to\n    // 65536 * Math.log(2) = 45426 pixels from the focus.\n    var deltaX = tileCenter[0] - frameState.focus[0];\n    var deltaY = tileCenter[1] - frameState.focus[1];\n    return 65536 * Math.log(tileResolution) +\n        Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n  };\n\n  /**\n   * @param {Event} browserEvent Browser event.\n   * @param {string=} opt_type Type.\n   */\n  PluggableMap.prototype.handleBrowserEvent = function handleBrowserEvent (browserEvent, opt_type) {\n    var type = opt_type || browserEvent.type;\n    var mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n    this.handleMapBrowserEvent(mapBrowserEvent);\n  };\n\n  /**\n   * @param {MapBrowserEvent} mapBrowserEvent The event to handle.\n   */\n  PluggableMap.prototype.handleMapBrowserEvent = function handleMapBrowserEvent (mapBrowserEvent) {\n    if (!this.frameState_) {\n      // With no view defined, we cannot translate pixels into geographical\n      // coordinates so interactions cannot be used.\n      return;\n    }\n    this.focus_ = mapBrowserEvent.coordinate;\n    mapBrowserEvent.frameState = this.frameState_;\n    var interactionsArray = this.getInteractions().getArray();\n    if (this.dispatchEvent(mapBrowserEvent) !== false) {\n      for (var i = interactionsArray.length - 1; i >= 0; i--) {\n        var interaction = interactionsArray[i];\n        if (!interaction.getActive()) {\n          continue;\n        }\n        var cont = interaction.handleEvent(mapBrowserEvent);\n        if (!cont) {\n          break;\n        }\n      }\n    }\n  };\n\n  /**\n   * @protected\n   */\n  PluggableMap.prototype.handlePostRender = function handlePostRender () {\n\n    var frameState = this.frameState_;\n\n    // Manage the tile queue\n    // Image loads are expensive and a limited resource, so try to use them\n    // efficiently:\n    // * When the view is static we allow a large number of parallel tile loads\n    //   to complete the frame as quickly as possible.\n    // * When animating or interacting, image loads can cause janks, so we reduce\n    //   the maximum number of loads per frame and limit the number of parallel\n    //   tile loads to remain reactive to view changes and to reduce the chance of\n    //   loading tiles that will quickly disappear from view.\n    var tileQueue = this.tileQueue_;\n    if (!tileQueue.isEmpty()) {\n      var maxTotalLoading = this.maxTilesLoading_;\n      var maxNewLoads = maxTotalLoading;\n      if (frameState) {\n        var hints = frameState.viewHints;\n        if (hints[ViewHint.ANIMATING]) {\n          maxTotalLoading = this.loadTilesWhileAnimating_ ? 8 : 0;\n          maxNewLoads = 2;\n        }\n        if (hints[ViewHint.INTERACTING]) {\n          maxTotalLoading = this.loadTilesWhileInteracting_ ? 8 : 0;\n          maxNewLoads = 2;\n        }\n      }\n      if (tileQueue.getTilesLoading() < maxTotalLoading) {\n        tileQueue.reprioritize(); // FIXME only call if view has changed\n        tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n      }\n    }\n    if (frameState && this.hasListener(RenderEventType.RENDERCOMPLETE) && !frameState.animate &&\n        !this.tileQueue_.getTilesLoading() && !getLoading(this.getLayers().getArray())) {\n      this.renderer_.dispatchRenderEvent(RenderEventType.RENDERCOMPLETE, frameState);\n    }\n\n    var postRenderFunctions = this.postRenderFunctions_;\n    for (var i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n      postRenderFunctions[i](this, frameState);\n    }\n    postRenderFunctions.length = 0;\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleSizeChanged_ = function handleSizeChanged_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleTargetChanged_ = function handleTargetChanged_ () {\n    // target may be undefined, null, a string or an Element.\n    // If it's a string we convert it to an Element before proceeding.\n    // If it's not now an Element we remove the viewport from the DOM.\n    // If it's an Element we append the viewport element to it.\n\n    var targetElement;\n    if (this.getTarget()) {\n      targetElement = this.getTargetElement();\n    }\n\n    if (this.keyHandlerKeys_) {\n      for (var i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n        unlistenByKey(this.keyHandlerKeys_[i]);\n      }\n      this.keyHandlerKeys_ = null;\n    }\n\n    if (!targetElement) {\n      this.renderer_.removeLayerRenderers();\n      removeNode(this.viewport_);\n      if (this.handleResize_ !== undefined) {\n        removeEventListener(EventType.RESIZE, this.handleResize_, false);\n        this.handleResize_ = undefined;\n      }\n    } else {\n      targetElement.appendChild(this.viewport_);\n\n      var keyboardEventTarget = !this.keyboardEventTarget_ ?\n        targetElement : this.keyboardEventTarget_;\n      this.keyHandlerKeys_ = [\n        listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n        listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n      ];\n\n      if (!this.handleResize_) {\n        this.handleResize_ = this.updateSize.bind(this);\n        window.addEventListener(EventType.RESIZE, this.handleResize_, false);\n      }\n    }\n\n    this.updateSize();\n    // updateSize calls setSize, so no need to call this.render\n    // ourselves here.\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleTileChange_ = function handleTileChange_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleViewPropertyChanged_ = function handleViewPropertyChanged_ () {\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleViewChanged_ = function handleViewChanged_ () {\n    if (this.viewPropertyListenerKey_) {\n      unlistenByKey(this.viewPropertyListenerKey_);\n      this.viewPropertyListenerKey_ = null;\n    }\n    if (this.viewChangeListenerKey_) {\n      unlistenByKey(this.viewChangeListenerKey_);\n      this.viewChangeListenerKey_ = null;\n    }\n    var view = this.getView();\n    if (view) {\n      this.viewport_.setAttribute('data-view', getUid(view));\n      this.viewPropertyListenerKey_ = listen(\n        view, ObjectEventType.PROPERTYCHANGE,\n        this.handleViewPropertyChanged_, this);\n      this.viewChangeListenerKey_ = listen(\n        view, EventType.CHANGE,\n        this.handleViewPropertyChanged_, this);\n    }\n    this.render();\n  };\n\n  /**\n   * @private\n   */\n  PluggableMap.prototype.handleLayerGroupChanged_ = function handleLayerGroupChanged_ () {\n    if (this.layerGroupPropertyListenerKeys_) {\n      this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n      this.layerGroupPropertyListenerKeys_ = null;\n    }\n    var layerGroup = this.getLayerGroup();\n    if (layerGroup) {\n      this.layerGroupPropertyListenerKeys_ = [\n        listen(\n          layerGroup, ObjectEventType.PROPERTYCHANGE,\n          this.render, this),\n        listen(\n          layerGroup, EventType.CHANGE,\n          this.render, this)\n      ];\n    }\n    this.render();\n  };\n\n  /**\n   * @return {boolean} Is rendered.\n   */\n  PluggableMap.prototype.isRendered = function isRendered () {\n    return !!this.frameState_;\n  };\n\n  /**\n   * Requests an immediate render in a synchronous manner.\n   * @api\n   */\n  PluggableMap.prototype.renderSync = function renderSync () {\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n    }\n    this.animationDelay_();\n  };\n\n  /**\n   * Request a map rendering (at the next animation frame).\n   * @api\n   */\n  PluggableMap.prototype.render = function render () {\n    if (this.animationDelayKey_ === undefined) {\n      this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n    }\n  };\n\n  /**\n   * Remove the given control from the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @return {import(\"./control/Control.js\").default|undefined} The removed control (or undefined\n   *     if the control was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeControl = function removeControl (control) {\n    return this.getControls().remove(control);\n  };\n\n  /**\n   * Remove the given interaction from the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to remove.\n   * @return {import(\"./interaction/Interaction.js\").default|undefined} The removed interaction (or\n   *     undefined if the interaction was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeInteraction = function removeInteraction (interaction) {\n    return this.getInteractions().remove(interaction);\n  };\n\n  /**\n   * Removes the given layer from the map.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @return {import(\"./layer/Base.js\").default|undefined} The removed layer (or undefined if the\n   *     layer was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeLayer = function removeLayer (layer) {\n    var layers = this.getLayerGroup().getLayers();\n    return layers.remove(layer);\n  };\n\n  /**\n   * Remove the given overlay from the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @return {import(\"./Overlay.js\").default|undefined} The removed overlay (or undefined\n   *     if the overlay was not found).\n   * @api\n   */\n  PluggableMap.prototype.removeOverlay = function removeOverlay (overlay) {\n    return this.getOverlays().remove(overlay);\n  };\n\n  /**\n   * @param {number} time Time.\n   * @private\n   */\n  PluggableMap.prototype.renderFrame_ = function renderFrame_ (time) {\n    var viewState;\n\n    var size = this.getSize();\n    var view = this.getView();\n    var extent = createEmpty();\n    var previousFrameState = this.frameState_;\n    /** @type {?FrameState} */\n    var frameState = null;\n    if (size !== undefined && hasArea(size) && view && view.isDef()) {\n      var viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n      var layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n      var layerStates = {};\n      for (var i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n        layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n      }\n      viewState = view.getState(this.pixelRatio_);\n      frameState = /** @type {FrameState} */ ({\n        animate: false,\n        coordinateToPixelTransform: this.coordinateToPixelTransform_,\n        extent: extent,\n        focus: this.focus_ ? this.focus_ : viewState.center,\n        index: this.frameIndex_++,\n        layerStates: layerStates,\n        layerStatesArray: layerStatesArray,\n        pixelRatio: this.pixelRatio_,\n        pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n        postRenderFunctions: [],\n        size: size,\n        skippedFeatureUids: this.skippedFeatureUids_,\n        tileQueue: this.tileQueue_,\n        time: time,\n        usedTiles: {},\n        viewState: viewState,\n        viewHints: viewHints,\n        wantedTiles: {}\n      });\n    }\n\n    if (frameState) {\n      frameState.extent = getForViewAndSize(viewState.center,\n        viewState.resolution, viewState.rotation, frameState.size, extent);\n    }\n\n    this.frameState_ = frameState;\n    this.renderer_.renderFrame(frameState);\n\n    if (frameState) {\n      if (frameState.animate) {\n        this.render();\n      }\n      Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n      if (previousFrameState) {\n        var moveStart = !this.previousExtent_ ||\n                    (!isEmpty(this.previousExtent_) &&\n                    !equals(frameState.extent, this.previousExtent_));\n        if (moveStart) {\n          this.dispatchEvent(\n            new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n          this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n        }\n      }\n\n      var idle = this.previousExtent_ &&\n          !frameState.viewHints[ViewHint.ANIMATING] &&\n          !frameState.viewHints[ViewHint.INTERACTING] &&\n          !equals(frameState.extent, this.previousExtent_);\n\n      if (idle) {\n        this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n        clone(frameState.extent, this.previousExtent_);\n      }\n    }\n\n    this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n    setTimeout(this.handlePostRender.bind(this), 0);\n\n  };\n\n  /**\n   * Sets the layergroup of this map.\n   * @param {LayerGroup} layerGroup A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setLayerGroup = function setLayerGroup (layerGroup) {\n    this.set(MapProperty.LAYERGROUP, layerGroup);\n  };\n\n  /**\n   * Set the size of this map.\n   * @param {import(\"./size.js\").Size|undefined} size The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setSize = function setSize (size) {\n    this.set(MapProperty.SIZE, size);\n  };\n\n  /**\n   * Set the target element to render this map into.\n   * @param {HTMLElement|string|undefined} target The Element or id of the Element\n   *     that the map is rendered in.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setTarget = function setTarget (target) {\n    this.set(MapProperty.TARGET, target);\n  };\n\n  /**\n   * Set the view for this map.\n   * @param {View} view The view that controls this map.\n   * @observable\n   * @api\n   */\n  PluggableMap.prototype.setView = function setView (view) {\n    this.set(MapProperty.VIEW, view);\n  };\n\n  /**\n   * @param {import(\"./Feature.js\").default} feature Feature.\n   */\n  PluggableMap.prototype.skipFeature = function skipFeature (feature) {\n    this.skippedFeatureUids_[getUid(feature)] = true;\n    this.render();\n  };\n\n  /**\n   * Force a recalculation of the map viewport size.  This should be called when\n   * third-party code changes the size of the map viewport.\n   * @api\n   */\n  PluggableMap.prototype.updateSize = function updateSize () {\n    var targetElement = this.getTargetElement();\n\n    if (!targetElement) {\n      this.setSize(undefined);\n    } else {\n      var computedStyle = getComputedStyle(targetElement);\n      this.setSize([\n        targetElement.offsetWidth -\n            parseFloat(computedStyle['borderLeftWidth']) -\n            parseFloat(computedStyle['paddingLeft']) -\n            parseFloat(computedStyle['paddingRight']) -\n            parseFloat(computedStyle['borderRightWidth']),\n        targetElement.offsetHeight -\n            parseFloat(computedStyle['borderTopWidth']) -\n            parseFloat(computedStyle['paddingTop']) -\n            parseFloat(computedStyle['paddingBottom']) -\n            parseFloat(computedStyle['borderBottomWidth'])\n      ]);\n    }\n  };\n\n  /**\n   * @param {import(\"./Feature.js\").default} feature Feature.\n   */\n  PluggableMap.prototype.unskipFeature = function unskipFeature (feature) {\n    delete this.skippedFeatureUids_[getUid(feature)];\n    this.render();\n  };\n\n  return PluggableMap;\n}(BaseObject));\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {HTMLElement|Document}\n   */\n  var keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object<string, *>}\n   */\n  var values = {};\n\n  var layerGroup = options.layers && typeof /** @type {?} */ (options.layers).getLayers === 'function' ?\n    /** @type {LayerGroup} */ (options.layers) : new LayerGroup({layers: /** @type {Collection} */ (options.layers)});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  var controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.controls).getArray === 'function',\n        47); // Expected `controls` to be an array or an `import(\"./Collection.js\").Collection`\n      controls = /** @type {Collection} */ (options.controls);\n    }\n  }\n\n  var interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.interactions).getArray === 'function',\n        48); // Expected `interactions` to be an array or an `import(\"./Collection.js\").Collection`\n      interactions = /** @type {Collection} */ (options.interactions);\n    }\n  }\n\n  var overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.overlays).getArray === 'function',\n        49); // Expected `overlays` to be an array or an `import(\"./Collection.js\").Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n\n/**\n * @param  {Array<import(\"./layer/Base.js\").default>} layers Layers.\n * @return {boolean} Layers have sources that are still loading.\n */\nfunction getLoading(layers) {\n  for (var i = 0, ii = layers.length; i < ii; ++i) {\n    var layer = layers[i];\n    if (typeof /** @type {?} */ (layer).getLayers === 'function') {\n      return getLoading(/** @type {LayerGroup} */ (layer).getLayers().getArray());\n    } else {\n      var source = /** @type {import(\"./layer/Layer.js\").default} */ (\n        layer).getSource();\n      if (source && source.loading) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n//# sourceMappingURL=PluggableMap.js.map","/**\n * @module ol/Map\n */\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control/util.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CanvasImageLayerRenderer from './renderer/canvas/ImageLayer.js';\nimport CanvasMapRenderer from './renderer/canvas/Map.js';\nimport CanvasTileLayerRenderer from './renderer/canvas/TileLayer.js';\nimport CanvasVectorLayerRenderer from './renderer/canvas/VectorLayer.js';\nimport CanvasVectorTileLayerRenderer from './renderer/canvas/VectorTileLayer.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nvar Map = /*@__PURE__*/(function (PluggableMap) {\n  function Map(options) {\n    options = assign({}, options);\n    if (!options.controls) {\n      options.controls = defaultControls();\n    }\n    if (!options.interactions) {\n      options.interactions = defaultInteractions();\n    }\n\n    PluggableMap.call(this, options);\n  }\n\n  if ( PluggableMap ) Map.__proto__ = PluggableMap;\n  Map.prototype = Object.create( PluggableMap && PluggableMap.prototype );\n  Map.prototype.constructor = Map;\n\n  Map.prototype.createRenderer = function createRenderer () {\n    var renderer = new CanvasMapRenderer(this);\n    renderer.registerLayerRenderers([\n      CanvasImageLayerRenderer,\n      CanvasTileLayerRenderer,\n      CanvasVectorLayerRenderer,\n      CanvasVectorTileLayerRenderer\n    ]);\n    return renderer;\n  };\n\n  return Map;\n}(PluggableMap));\n\n\nexport default Map;\n\n//# sourceMappingURL=Map.js.map","/** Vanilla JS helper to manipulate DOM without jQuery\n * @see https://github.com/nefe/You-Dont-Need-jQuery\n * @see https://plainjs.com/javascript/\n * @see http://youmightnotneedjquery.com/\n */\n var ol_ext_element = {};\n\n/**\n * Create an element\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\n * @param {*} options\n *  @param {string} options.className className The element class name \n *  @param {Element} options.parent Parent to append the element as child\n *  @param {Element|string} options.html Content of the element\n *  @param {string} options.* Any other attribut to add to the element\n */\nol_ext_element.create = function (tagName, options) {\n  options = options || {};\n  var elt;\n  // Create text node\n  if (tagName === 'TEXT') {\n    elt = document.createTextNode(options.html||'');\n    if (options.parent) options.parent.appendChild(elt);\n  } else {\n    // Other element\n    elt = document.createElement(tagName);\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\n    for (var attr in options) {\n      switch (attr) {\n        case 'className': {\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\n          break;\n        }\n        case 'html': {\n          if (options.html instanceof Element) elt.appendChild(options.html)\n          else if (options.html!==undefined) elt.innerHTML = options.html;\n          break;\n        }\n        case 'parent': {\n          options.parent.appendChild(elt);\n          break;\n        }\n        case 'style': {\n          this.setStyle(elt, options.style);\n          break;\n        }\n        case 'change':\n        case 'click': {\n          ol_ext_element.addListener(elt, attr, options[attr]);\n          break;\n        }\n        case 'on': {\n          for (var e in options.on) {\n            ol_ext_element.addListener(elt, e, options.on[e]);\n          }\n          break;\n        }\n        case 'checked': {\n          elt.checked = !!options.checked;\n          break;\n        }\n        default: {\n          elt.setAttribute(attr, options[attr]);\n          break;\n        }\n      }\n    }\n  }\n  return elt;\n};\n\n/** Set inner html or append a child element to an element\n * @param {Element} element\n * @param {Element|string} html Content of the element\n */\nol_ext_element.setHTML = function(element, html) {\n  if (html instanceof Element) element.appendChild(html)\n  else if (html!==undefined) element.innerHTML = html;\n};\n\n/** Append text into an elemnt\n * @param {Element} element\n * @param {string} text text content\n */\nol_ext_element.appendText = function(element, text) {\n  element.appendChild(document.createTextNode(text||''));\n};\n\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol_ext_element.addListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.addEventListener(e, fn);\n  });\n};\n\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol_ext_element.removeListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.removeEventListener(e, fn);\n  });\n};\n\n/**\n * Show an element\n * @param {Element} element\n */\nol_ext_element.show = function (element) {\n  element.style.display = '';\n};\n\n/**\n * Hide an element\n * @param {Element} element\n */\nol_ext_element.hide = function (element) {\n  element.style.display = 'none';\n};\n\n/**\n * Test if an element is hihdden\n * @param {Element} element\n * @return {boolean}\n */\nol_ext_element.hidden = function (element) {\n  return ol_ext_element.getStyle(element, 'display') === 'none';\n};\n\n/**\n * Toggle an element\n * @param {Element} element\n */\nol_ext_element.toggle = function (element) {\n  element.style.display = (element.style.display==='none' ? '' : 'none');\n};\n\n/** Set style of an element\n * @param {DOMElement} el the element\n * @param {*} st list of style\n */\nol_ext_element.setStyle = function(el, st) {\n  for (var s in st) {\n    switch (s) {\n      case 'top':\n      case 'left':\n      case 'bottom':\n      case 'right':\n      case 'minWidth':\n      case 'maxWidth':\n      case 'width':\n      case 'height': {\n        if (typeof(st[s]) === 'number') {\n          el.style[s] = st[s]+'px';\n        } else {\n          el.style[s] = st[s];\n        }\n        break;\n      }\n      default: {\n        el.style[s] = st[s];\n      }\n    }\n  }\n};\n\n/**\n * Get style propertie of an element\n * @param {DOMElement} el the element\n * @param {string} styleProp Propertie name\n * @return {*} style value\n */\nol_ext_element.getStyle = function(el, styleProp) {\n  var value, defaultView = (el.ownerDocument || document).defaultView;\n  // W3C standard way:\n  if (defaultView && defaultView.getComputedStyle) {\n    // sanitize property name to css notation\n    // (hypen separated words eg. font-Size)\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\n  } else if (el.currentStyle) { // IE\n    // sanitize property name to camelCase\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\n      return letter.toUpperCase();\n    });\n    value = el.currentStyle[styleProp];\n    // convert other units to pixels on IE\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \n      return (function(value) {\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\n        el.runtimeStyle.left = el.currentStyle.left;\n        el.style.left = value || 0;\n        value = el.style.pixelLeft + \"px\";\n        el.style.left = oldLeft;\n        el.runtimeStyle.left = oldRsLeft;\n        return value;\n      })(value);\n    }\n  }\n  if (/px$/.test(value)) return parseInt(value);\n  return value;\n};\n\n/** Get outerHeight of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol_ext_element.outerHeight = function(elt) {\n  return elt.offsetHeight + ol_ext_element.getStyle(elt, 'marginBottom')\n};\n\n/** Get outerWidth of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol_ext_element.outerWidth = function(elt) {\n  return elt.offsetWidth + ol_ext_element.getStyle(elt, 'marginLeft')\n};\n\n/** Get element offset rect\n * @param {DOMElement} elt\n * @return {*} \n */\nol_ext_element.offsetRect = function(elt) {\n  var rect = elt.getBoundingClientRect();\n  return {\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\n    height: rect.height || (rect.bottom - rect.top),\n    width: rect.widtth || (rect.right - rect.left)\n  }\n};\n\n/** Make a div scrollable without scrollbar.\n * On touch devices the default behavior is preserved\n * @param {DOMElement} elt\n * @param {function} onmove a function that takes a boolean indicating that the div is scrolling\n */\nol_ext_element.scrollDiv = function(elt, options) {\n  var pos = false;\n  var speed = 0;\n  var d, dt = 0;\n\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\n  var page = options.vertical ? 'pageY' : 'pageX';\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\n\n  // Prevent image dragging\n  elt.querySelectorAll('img').forEach(function(i) {\n    i.ondragstart = function(){ return false; };\n  });\n  \n  // Start scrolling\n  ol_ext_element.addListener(elt, ['mousedown'], function(e) {\n    pos = e[page];\n    dt = new Date();\n    elt.classList.add('ol-move');\n  });\n  \n  // Register scroll\n  ol_ext_element.addListener(window, ['mousemove'], function(e) {\n    if (pos !== false) {\n      var delta = pos - e[page];\n      elt[scroll] += delta;\n      d = new Date();\n      if (d-dt) {\n        speed = (speed + delta / (d - dt))/2;\n      }\n      pos = e[page];\n      dt = d;\n      // Tell we are moving\n      if (delta) onmove(true);\n    } else {\n      // Not moving yet\n      onmove(false);\n    }\n  });\n  \n  // Stop scrolling\n  ol_ext_element.addListener(window, ['mouseup'], function(e) {\n    elt.classList.remove('ol-move');\n    dt = new Date() - dt;\n    if (dt>100) {\n      // User stop: no speed\n      speed = 0;\n    } else if (dt>0) {\n      // Calculate new speed\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\n    }\n    elt[scroll] += speed*100;\n    pos = false;\n    speed = 0;\n    dt = 0;\n  });\n\n  // Handle mousewheel\n  if (options.mousewheel && !elt.classList.contains('ol-touch')) {\n    ol_ext_element.addListener(elt, \n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \n      function(e) {\n        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\n        elt.classList.add('ol-move');\n        elt[scroll] -= delta*30;\n        return false;\n      }\n    );\n  }\n};\n\nexport default ol_ext_element","/**\n * @module ol/MapEvent\n */\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map event.\n */\nvar MapEvent = /*@__PURE__*/(function (Event) {\n  function MapEvent(type, map, opt_frameState) {\n\n    Event.call(this, type);\n\n    /**\n     * The map where the event occurred.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @api\n     */\n    this.map = map;\n\n    /**\n     * The frame state at the time of the event.\n     * @type {?import(\"./PluggableMap.js\").FrameState}\n     * @api\n     */\n    this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n  }\n\n  if ( Event ) MapEvent.__proto__ = Event;\n  MapEvent.prototype = Object.create( Event && Event.prototype );\n  MapEvent.prototype.constructor = MapEvent;\n\n  return MapEvent;\n}(Event));\n\nexport default MapEvent;\n\n//# sourceMappingURL=MapEvent.js.map","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object.ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n\n//# sourceMappingURL=ObjectEventType.js.map","/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\n\n\nvar ImageTile = /*@__PURE__*/(function (Tile) {\n  function ImageTile(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n    Tile.call(this, tileCoord, state, opt_options);\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ = crossOrigin;\n\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    this.imageListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n\n  }\n\n  if ( Tile ) ImageTile.__proto__ = Tile;\n  ImageTile.prototype = Object.create( Tile && Tile.prototype );\n  ImageTile.prototype.constructor = ImageTile;\n\n  /**\n   * @inheritDoc\n   */\n  ImageTile.prototype.disposeInternal = function disposeInternal () {\n    if (this.state == TileState.LOADING) {\n      this.unlistenImage_();\n      this.image_ = getBlankImage();\n    }\n    if (this.interimTile) {\n      this.interimTile.dispose();\n    }\n    this.state = TileState.ABORT;\n    this.changed();\n    Tile.prototype.disposeInternal.call(this);\n  };\n\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  ImageTile.prototype.getImage = function getImage () {\n    return this.image_;\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ImageTile.prototype.getKey = function getKey () {\n    return this.src_;\n  };\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  ImageTile.prototype.handleImageError_ = function handleImageError_ () {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  };\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  ImageTile.prototype.handleImageLoad_ = function handleImageLoad_ () {\n    var image = /** @type {HTMLImageElement} */ (this.image_);\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n    this.unlistenImage_();\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  ImageTile.prototype.load = function load () {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.imageListenerKeys_ = [\n        listenOnce(this.image_, EventType.ERROR,\n          this.handleImageError_, this),\n        listenOnce(this.image_, EventType.LOAD,\n          this.handleImageLoad_, this)\n      ];\n      this.tileLoadFunction_(this, this.src_);\n    }\n  };\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  ImageTile.prototype.unlistenImage_ = function unlistenImage_ () {\n    this.imageListenerKeys_.forEach(unlistenByKey);\n    this.imageListenerKeys_ = null;\n  };\n\n  return ImageTile;\n}(Tile));\n\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  var ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n\n//# sourceMappingURL=ImageTile.js.map","/**\n * @module ol/AssertionError\n */\nimport {VERSION} from './util.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error.\n */\nvar AssertionError = /*@__PURE__*/(function (Error) {\n  function AssertionError(code) {\n    var path = VERSION === 'latest' ? VERSION : 'v' + VERSION.split('-')[0];\n    var message = 'Assertion failed. See https://openlayers.org/en/' + path +\n    '/doc/errors/#' + code + ' for details.';\n\n    Error.call(this, message);\n\n    /**\n     * Error code. The meaning of the code can be found on\n     * https://openlayers.org/en/latest/doc/errors/ (replace `latest` with\n     * the version found in the OpenLayers script's header comment if a version\n     * other than the latest is used).\n     * @type {number}\n     * @api\n     */\n    this.code = code;\n\n    /**\n     * @type {string}\n     */\n    this.name = 'AssertionError';\n\n    // Re-assign message, see https://github.com/Rich-Harris/buble/issues/40\n    this.message = message;\n  }\n\n  if ( Error ) AssertionError.__proto__ = Error;\n  AssertionError.prototype = Object.create( Error && Error.prototype );\n  AssertionError.prototype.constructor = AssertionError;\n\n  return AssertionError;\n}(Error));\n\nexport default AssertionError;\n\n//# sourceMappingURL=AssertionError.js.map","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3\n};\n\n//# sourceMappingURL=ImageState.js.map","/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nvar TileCache = /*@__PURE__*/(function (LRUCache) {\n  function TileCache(opt_highWaterMark) {\n\n    LRUCache.call(this, opt_highWaterMark);\n\n  }\n\n  if ( LRUCache ) TileCache.__proto__ = LRUCache;\n  TileCache.prototype = Object.create( LRUCache && LRUCache.prototype );\n  TileCache.prototype.constructor = TileCache;\n\n  /**\n   * @param {!Object<string, import(\"./TileRange.js\").default>} usedTiles Used tiles.\n   */\n  TileCache.prototype.expireCache = function expireCache (usedTiles) {\n    while (this.canExpireCache()) {\n      var tile = this.peekLast();\n      var zKey = tile.tileCoord[0].toString();\n      if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\n        break;\n      } else {\n        this.pop().dispose();\n      }\n    }\n  };\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  TileCache.prototype.pruneExceptNewestZ = function pruneExceptNewestZ () {\n    if (this.getCount() === 0) {\n      return;\n    }\n    var key = this.peekFirstKey();\n    var tileCoord = fromKey(key);\n    var z = tileCoord[0];\n    this.forEach(function(tile) {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.dispose();\n      }\n    }, this);\n  };\n\n  return TileCache;\n}(LRUCache));\n\n\nexport default TileCache;\n\n//# sourceMappingURL=TileCache.js.map","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n\n//# sourceMappingURL=ViewProperty.js.map","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {getUid} from './util.js';\nimport {VOID} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {import(\"./coordinate.js\").Coordinate} [sourceCenter]\n * @property {import(\"./coordinate.js\").Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [targetRotation]\n * @property {import(\"./coordinate.js\").Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {import(\"./centerconstraint.js\").Type} center\n * @property {import(\"./resolutionconstraint.js\").Type} resolution\n * @property {import(\"./rotationconstraint.js\").Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {import(\"./size.js\").Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [constrainResolution=true] Constrain the resolution.\n * @property {boolean} [nearest=false] If `constrainResolution` is `true`, get\n * the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The initial center for\n * the view. The coordinate system for the center is specified with the\n * `projection` option. Layer sources will not be fetched if this is not set,\n * but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {import(\"./extent.js\").Extent} [extent] The extent that constrains the\n * center, in other words, center cannot be set outside this extent.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view. The initial\n * resolution is determined using the {@link #constrainResolution} method.\n * @property {number} [zoomFactor=2] The zoom factor used to determine the\n * resolution constraint.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The center of the view at the end of\n * the animation.\n * @property {number} [zoom] The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number} [resolution] The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number} [rotation] The rotation of the view at the end of\n * the animation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Optional anchor to remained fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {import(\"./coordinate.js\").Coordinate} center\n * @property {import(\"./proj/Projection.js\").default} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nvar DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * ### The view states\n *\n * An View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * An View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view. Any value can be passed to the setters. And the value\n * that is passed to a setter will effectively be the value set in the view,\n * and returned by the corresponding getter.\n *\n * But a View object also has a *resolution constraint*, a\n * *rotation constraint* and a *center constraint*.\n *\n * As said above, no constraints are applied when the setters are used to set\n * new states for the view. Applying constraints is done explicitly through\n * the use of the `constrain*` functions (`constrainResolution` and\n * `constrainRotation` and `constrainCenter`).\n *\n * The main users of the constraints are the interactions and the\n * controls. For example, double-clicking on the map changes the view to\n * the \"next\" resolution. And releasing the fingers after pinch-zooming\n * snaps to the closest resolution (with an animation).\n *\n * The *resolution constraint* snaps to specific resolutions. It is\n * determined by the following options: `resolutions`, `maxResolution`,\n * `maxZoom`, and `zoomFactor`. If `resolutions` is set, the other three\n * options are ignored. See documentation for each option for more\n * information.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default the rotation value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the center is not constrained at all.\n *\n  * @api\n */\nvar View = /*@__PURE__*/(function (BaseObject) {\n  function View(opt_options) {\n    BaseObject.call(this);\n\n    var options = assign({}, opt_options);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.hints_ = [0, 0];\n\n    /**\n     * @private\n     * @type {Array<Array<Animation>>}\n     */\n    this.animations_ = [];\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.updateAnimationKey_;\n\n    this.updateAnimations_ = this.updateAnimations_.bind(this);\n\n    /**\n     * @private\n     * @const\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n    this.applyOptions_(options);\n  }\n\n  if ( BaseObject ) View.__proto__ = BaseObject;\n  View.prototype = Object.create( BaseObject && BaseObject.prototype );\n  View.prototype.constructor = View;\n\n  /**\n   * Set up the view with the given options.\n   * @param {ViewOptions} options View options.\n   */\n  View.prototype.applyOptions_ = function applyOptions_ (options) {\n\n    /**\n     * @type {Object<string, *>}\n     */\n    var properties = {};\n    properties[ViewProperty.CENTER] = options.center !== undefined ?\n      options.center : null;\n\n    var resolutionConstraintInfo = createResolutionConstraint(options);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n    /**\n     * @private\n     * @type {Array<number>|undefined}\n     */\n    this.resolutions_ = options.resolutions;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n    var centerConstraint = createCenterConstraint(options);\n    var resolutionConstraint = resolutionConstraintInfo.constraint;\n    var rotationConstraint = createRotationConstraint(options);\n\n    /**\n     * @private\n     * @type {Constraints}\n     */\n    this.constraints_ = {\n      center: centerConstraint,\n      resolution: resolutionConstraint,\n      rotation: rotationConstraint\n    };\n\n    if (options.resolution !== undefined) {\n      properties[ViewProperty.RESOLUTION] = options.resolution;\n    } else if (options.zoom !== undefined) {\n      properties[ViewProperty.RESOLUTION] = this.constrainResolution(\n        this.maxResolution_, options.zoom - this.minZoom_);\n\n      if (this.resolutions_) { // in case map zoom is out of min/max zoom range\n        properties[ViewProperty.RESOLUTION] = clamp(\n          Number(this.getResolution() || properties[ViewProperty.RESOLUTION]),\n          this.minResolution_, this.maxResolution_);\n      }\n    }\n    properties[ViewProperty.ROTATION] = options.rotation !== undefined ? options.rotation : 0;\n    this.setProperties(properties);\n\n    /**\n     * @private\n     * @type {ViewOptions}\n     */\n    this.options_ = options;\n\n  };\n\n  /**\n   * Get an updated version of the view options used to construct the view.  The\n   * current resolution (or zoom), center, and rotation are applied to any stored\n   * options.  The provided options can be used to apply new min/max zoom or\n   * resolution limits.\n   * @param {ViewOptions} newOptions New options to be applied.\n   * @return {ViewOptions} New options updated with the current view state.\n   */\n  View.prototype.getUpdatedOptions_ = function getUpdatedOptions_ (newOptions) {\n    var options = assign({}, this.options_);\n\n    // preserve resolution (or zoom)\n    if (options.resolution !== undefined) {\n      options.resolution = this.getResolution();\n    } else {\n      options.zoom = this.getZoom();\n    }\n\n    // preserve center\n    options.center = this.getCenter();\n\n    // preserve rotation\n    options.rotation = this.getRotation();\n\n    return assign({}, options, newOptions);\n  };\n\n  /**\n   * Animate the view.  The view's center, zoom (or resolution), and rotation\n   * can be animated for smooth transitions between view states.  For example,\n   * to animate the view to a new zoom level:\n   *\n   *     view.animate({zoom: view.getZoom() + 1});\n   *\n   * By default, the animation lasts one second and uses in-and-out easing.  You\n   * can customize this behavior by including `duration` (in milliseconds) and\n   * `easing` options (see {@link module:ol/easing}).\n   *\n   * To chain together multiple animations, call the method with multiple\n   * animation objects.  For example, to first zoom and then pan:\n   *\n   *     view.animate({zoom: 10}, {center: [0, 0]});\n   *\n   * If you provide a function as the last argument to the animate method, it\n   * will get called at the end of an animation series.  The callback will be\n   * called with `true` if the animation series completed on its own or `false`\n   * if it was cancelled.\n   *\n   * Animations are cancelled by user interactions (e.g. dragging the map) or by\n   * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n   * (or another method that calls one of these).\n   *\n   * @param {...(AnimationOptions|function(boolean))} var_args Animation\n   *     options.  Multiple animations can be run in series by passing multiple\n   *     options objects.  To run multiple animations in parallel, call the method\n   *     multiple times.  An optional callback can be provided as a final\n   *     argument.  The callback will be called with a boolean indicating whether\n   *     the animation completed without being cancelled.\n   * @api\n   */\n  View.prototype.animate = function animate (var_args) {\n    var arguments$1 = arguments;\n\n    var animationCount = arguments.length;\n    var callback;\n    if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n      callback = arguments[animationCount - 1];\n      --animationCount;\n    }\n    if (!this.isDef()) {\n      // if view properties are not yet set, shortcut to the final state\n      var state = arguments[animationCount - 1];\n      if (state.center) {\n        this.setCenter(state.center);\n      }\n      if (state.zoom !== undefined) {\n        this.setZoom(state.zoom);\n      }\n      if (state.rotation !== undefined) {\n        this.setRotation(state.rotation);\n      }\n      if (callback) {\n        animationCallback(callback, true);\n      }\n      return;\n    }\n    var start = Date.now();\n    var center = this.getCenter().slice();\n    var resolution = this.getResolution();\n    var rotation = this.getRotation();\n    var series = [];\n    for (var i = 0; i < animationCount; ++i) {\n      var options = /** @type {AnimationOptions} */ (arguments$1[i]);\n\n      var animation = /** @type {Animation} */ ({\n        start: start,\n        complete: false,\n        anchor: options.anchor,\n        duration: options.duration !== undefined ? options.duration : 1000,\n        easing: options.easing || inAndOut\n      });\n\n      if (options.center) {\n        animation.sourceCenter = center;\n        animation.targetCenter = options.center;\n        center = animation.targetCenter;\n      }\n\n      if (options.zoom !== undefined) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = this.constrainResolution(\n          this.maxResolution_, options.zoom - this.minZoom_, 0);\n        resolution = animation.targetResolution;\n      } else if (options.resolution) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = options.resolution;\n        resolution = animation.targetResolution;\n      }\n\n      if (options.rotation !== undefined) {\n        animation.sourceRotation = rotation;\n        var delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n        animation.targetRotation = rotation + delta;\n        rotation = animation.targetRotation;\n      }\n\n      animation.callback = callback;\n\n      // check if animation is a no-op\n      if (isNoopAnimation(animation)) {\n        animation.complete = true;\n        // we still push it onto the series for callback handling\n      } else {\n        start += animation.duration;\n      }\n      series.push(animation);\n    }\n    this.animations_.push(series);\n    this.setHint(ViewHint.ANIMATING, 1);\n    this.updateAnimations_();\n  };\n\n  /**\n   * Determine if the view is being animated.\n   * @return {boolean} The view is being animated.\n   * @api\n   */\n  View.prototype.getAnimating = function getAnimating () {\n    return this.hints_[ViewHint.ANIMATING] > 0;\n  };\n\n  /**\n   * Determine if the user is interacting with the view, such as panning or zooming.\n   * @return {boolean} The view is being interacted with.\n   * @api\n   */\n  View.prototype.getInteracting = function getInteracting () {\n    return this.hints_[ViewHint.INTERACTING] > 0;\n  };\n\n  /**\n   * Cancel any ongoing animations.\n   * @api\n   */\n  View.prototype.cancelAnimations = function cancelAnimations () {\n    this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n    for (var i = 0, ii = this.animations_.length; i < ii; ++i) {\n      var series = this.animations_[i];\n      if (series[0].callback) {\n        animationCallback(series[0].callback, false);\n      }\n    }\n    this.animations_.length = 0;\n  };\n\n  /**\n   * Update all animations.\n   */\n  View.prototype.updateAnimations_ = function updateAnimations_ () {\n    if (this.updateAnimationKey_ !== undefined) {\n      cancelAnimationFrame(this.updateAnimationKey_);\n      this.updateAnimationKey_ = undefined;\n    }\n    if (!this.getAnimating()) {\n      return;\n    }\n    var now = Date.now();\n    var more = false;\n    for (var i = this.animations_.length - 1; i >= 0; --i) {\n      var series = this.animations_[i];\n      var seriesComplete = true;\n      for (var j = 0, jj = series.length; j < jj; ++j) {\n        var animation = series[j];\n        if (animation.complete) {\n          continue;\n        }\n        var elapsed = now - animation.start;\n        var fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n        if (fraction >= 1) {\n          animation.complete = true;\n          fraction = 1;\n        } else {\n          seriesComplete = false;\n        }\n        var progress = animation.easing(fraction);\n        if (animation.sourceCenter) {\n          var x0 = animation.sourceCenter[0];\n          var y0 = animation.sourceCenter[1];\n          var x1 = animation.targetCenter[0];\n          var y1 = animation.targetCenter[1];\n          var x = x0 + progress * (x1 - x0);\n          var y = y0 + progress * (y1 - y0);\n          this.set(ViewProperty.CENTER, [x, y]);\n        }\n        if (animation.sourceResolution && animation.targetResolution) {\n          var resolution = progress === 1 ?\n            animation.targetResolution :\n            animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n          if (animation.anchor) {\n            this.set(ViewProperty.CENTER,\n              this.calculateCenterZoom(resolution, animation.anchor));\n          }\n          this.set(ViewProperty.RESOLUTION, resolution);\n        }\n        if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n          var rotation = progress === 1 ?\n            modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n            animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n          if (animation.anchor) {\n            this.set(ViewProperty.CENTER,\n              this.calculateCenterRotate(rotation, animation.anchor));\n          }\n          this.set(ViewProperty.ROTATION, rotation);\n        }\n        more = true;\n        if (!animation.complete) {\n          break;\n        }\n      }\n      if (seriesComplete) {\n        this.animations_[i] = null;\n        this.setHint(ViewHint.ANIMATING, -1);\n        var callback = series[0].callback;\n        if (callback) {\n          animationCallback(callback, true);\n        }\n      }\n    }\n    // prune completed series\n    this.animations_ = this.animations_.filter(Boolean);\n    if (more && this.updateAnimationKey_ === undefined) {\n      this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_);\n    }\n  };\n\n  /**\n   * @param {number} rotation Target rotation.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Rotation anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for rotation and anchor.\n   */\n  View.prototype.calculateCenterRotate = function calculateCenterRotate (rotation, anchor) {\n    var center;\n    var currentCenter = this.getCenter();\n    if (currentCenter !== undefined) {\n      center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n      rotateCoordinate(center, rotation - this.getRotation());\n      addCoordinate(center, anchor);\n    }\n    return center;\n  };\n\n  /**\n   * @param {number} resolution Target resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Zoom anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for resolution and anchor.\n   */\n  View.prototype.calculateCenterZoom = function calculateCenterZoom (resolution, anchor) {\n    var center;\n    var currentCenter = this.getCenter();\n    var currentResolution = this.getResolution();\n    if (currentCenter !== undefined && currentResolution !== undefined) {\n      var x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n      var y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n      center = [x, y];\n    }\n    return center;\n  };\n\n  /**\n   * @private\n   * @return {import(\"./size.js\").Size} Viewport size or `[100, 100]` when no viewport is found.\n   */\n  View.prototype.getSizeFromViewport_ = function getSizeFromViewport_ () {\n    var size = [100, 100];\n    var selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n    var element = document.querySelector(selector);\n    if (element) {\n      var metrics = getComputedStyle(element);\n      size[0] = parseInt(metrics.width, 10);\n      size[1] = parseInt(metrics.height, 10);\n    }\n    return size;\n  };\n\n  /**\n   * Get the constrained center of this view.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center Center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Constrained center.\n   * @api\n   */\n  View.prototype.constrainCenter = function constrainCenter (center) {\n    return this.constraints_.center(center);\n  };\n\n  /**\n   * Get the constrained resolution of this view.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number=} opt_delta Delta. Default is `0`.\n   * @param {number=} opt_direction Direction. Default is `0`.\n   * @return {number|undefined} Constrained resolution.\n   * @api\n   */\n  View.prototype.constrainResolution = function constrainResolution (resolution, opt_delta, opt_direction) {\n    var delta = opt_delta || 0;\n    var direction = opt_direction || 0;\n    return this.constraints_.resolution(resolution, delta, direction);\n  };\n\n  /**\n   * Get the constrained rotation of this view.\n   * @param {number|undefined} rotation Rotation.\n   * @param {number=} opt_delta Delta. Default is `0`.\n   * @return {number|undefined} Constrained rotation.\n   * @api\n   */\n  View.prototype.constrainRotation = function constrainRotation (rotation, opt_delta) {\n    var delta = opt_delta || 0;\n    return this.constraints_.rotation(rotation, delta);\n  };\n\n  /**\n   * Get the view center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.getCenter = function getCenter () {\n    return (\n      /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (this.get(ViewProperty.CENTER))\n    );\n  };\n\n  /**\n   * @return {Constraints} Constraints.\n   */\n  View.prototype.getConstraints = function getConstraints () {\n    return this.constraints_;\n  };\n\n  /**\n   * @param {Array<number>=} opt_hints Destination array.\n   * @return {Array<number>} Hint.\n   */\n  View.prototype.getHints = function getHints (opt_hints) {\n    if (opt_hints !== undefined) {\n      opt_hints[0] = this.hints_[0];\n      opt_hints[1] = this.hints_[1];\n      return opt_hints;\n    } else {\n      return this.hints_.slice();\n    }\n  };\n\n  /**\n   * Calculate the extent for the current view state and the passed size.\n   * The size is the pixel dimensions of the box into which the calculated extent\n   * should fit. In most cases you want to get the extent of the entire map,\n   * that is `map.getSize()`.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size. If not provided, the size of the\n   * first map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   * @api\n   */\n  View.prototype.calculateExtent = function calculateExtent (opt_size) {\n    var size = opt_size || this.getSizeFromViewport_();\n    var center = /** @type {!import(\"./coordinate.js\").Coordinate} */ (this.getCenter());\n    assert(center, 1); // The view center is not defined\n    var resolution = /** @type {!number} */ (this.getResolution());\n    assert(resolution !== undefined, 2); // The view resolution is not defined\n    var rotation = /** @type {!number} */ (this.getRotation());\n    assert(rotation !== undefined, 3); // The view rotation is not defined\n\n    return getForViewAndSize(center, resolution, rotation, size);\n  };\n\n  /**\n   * Get the maximum resolution of the view.\n   * @return {number} The maximum resolution of the view.\n   * @api\n   */\n  View.prototype.getMaxResolution = function getMaxResolution () {\n    return this.maxResolution_;\n  };\n\n  /**\n   * Get the minimum resolution of the view.\n   * @return {number} The minimum resolution of the view.\n   * @api\n   */\n  View.prototype.getMinResolution = function getMinResolution () {\n    return this.minResolution_;\n  };\n\n  /**\n   * Get the maximum zoom level for the view.\n   * @return {number} The maximum zoom level.\n   * @api\n   */\n  View.prototype.getMaxZoom = function getMaxZoom () {\n    return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n  };\n\n  /**\n   * Set a new maximum zoom level for the view.\n   * @param {number} zoom The maximum zoom level.\n   * @api\n   */\n  View.prototype.setMaxZoom = function setMaxZoom (zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n  };\n\n  /**\n   * Get the minimum zoom level for the view.\n   * @return {number} The minimum zoom level.\n   * @api\n   */\n  View.prototype.getMinZoom = function getMinZoom () {\n    return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n  };\n\n  /**\n   * Set a new minimum zoom level for the view.\n   * @param {number} zoom The minimum zoom level.\n   * @api\n   */\n  View.prototype.setMinZoom = function setMinZoom (zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n  };\n\n  /**\n   * Get the view projection.\n   * @return {import(\"./proj/Projection.js\").default} The projection of the view.\n   * @api\n   */\n  View.prototype.getProjection = function getProjection () {\n    return this.projection_;\n  };\n\n  /**\n   * Get the view resolution.\n   * @return {number|undefined} The resolution of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.getResolution = function getResolution () {\n    return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n  };\n\n  /**\n   * Get the resolutions for the view. This returns the array of resolutions\n   * passed to the constructor of the View, or undefined if none were given.\n   * @return {Array<number>|undefined} The resolutions of the view.\n   * @api\n   */\n  View.prototype.getResolutions = function getResolutions () {\n    return this.resolutions_;\n  };\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   * @api\n   */\n  View.prototype.getResolutionForExtent = function getResolutionForExtent (extent, opt_size) {\n    var size = opt_size || this.getSizeFromViewport_();\n    var xResolution = getWidth(extent) / size[0];\n    var yResolution = getHeight(extent) / size[1];\n    return Math.max(xResolution, yResolution);\n  };\n\n  /**\n   * Return a function that returns a value between 0 and 1 for a\n   * resolution. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Resolution for value function.\n   */\n  View.prototype.getResolutionForValueFunction = function getResolutionForValueFunction (opt_power) {\n    var power = opt_power || 2;\n    var maxResolution = this.maxResolution_;\n    var minResolution = this.minResolution_;\n    var max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} value Value.\n       * @return {number} Resolution.\n       */\n      function(value) {\n        var resolution = maxResolution / Math.pow(power, value * max);\n        return resolution;\n      });\n  };\n\n  /**\n   * Get the view rotation.\n   * @return {number} The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  View.prototype.getRotation = function getRotation () {\n    return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n  };\n\n  /**\n   * Return a function that returns a resolution for a value between\n   * 0 and 1. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Value for resolution function.\n   */\n  View.prototype.getValueForResolutionFunction = function getValueForResolutionFunction (opt_power) {\n    var power = opt_power || 2;\n    var maxResolution = this.maxResolution_;\n    var minResolution = this.minResolution_;\n    var max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} resolution Resolution.\n       * @return {number} Value.\n       */\n      function(resolution) {\n        var value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n        return value;\n      });\n  };\n\n  /**\n   * @param {number} pixelRatio Pixel ratio for center rounding.\n   * @return {State} View state.\n   */\n  View.prototype.getState = function getState (pixelRatio) {\n    var center = /** @type {import(\"./coordinate.js\").Coordinate} */ (this.getCenter());\n    var projection = this.getProjection();\n    var resolution = /** @type {number} */ (this.getResolution());\n    var pixelResolution = resolution / pixelRatio;\n    var rotation = this.getRotation();\n    return (\n      /** @type {State} */ ({\n        center: [\n          Math.round(center[0] / pixelResolution) * pixelResolution,\n          Math.round(center[1] / pixelResolution) * pixelResolution\n        ],\n        projection: projection !== undefined ? projection : null,\n        resolution: resolution,\n        rotation: rotation,\n        zoom: this.getZoom()\n      })\n    );\n  };\n\n  /**\n   * Get the current zoom level.  If you configured your view with a resolutions\n   * array (this is rare), this method may return non-integer zoom levels (so\n   * the zoom level is not safe to use as an index into a resolutions array).\n   * @return {number|undefined} Zoom.\n   * @api\n   */\n  View.prototype.getZoom = function getZoom () {\n    var zoom;\n    var resolution = this.getResolution();\n    if (resolution !== undefined) {\n      zoom = this.getZoomForResolution(resolution);\n    }\n    return zoom;\n  };\n\n  /**\n   * Get the zoom level for a resolution.\n   * @param {number} resolution The resolution.\n   * @return {number|undefined} The zoom level for the provided resolution.\n   * @api\n   */\n  View.prototype.getZoomForResolution = function getZoomForResolution (resolution) {\n    var offset = this.minZoom_ || 0;\n    var max, zoomFactor;\n    if (this.resolutions_) {\n      var nearest = linearFindNearest(this.resolutions_, resolution, 1);\n      offset = nearest;\n      max = this.resolutions_[nearest];\n      if (nearest == this.resolutions_.length - 1) {\n        zoomFactor = 2;\n      } else {\n        zoomFactor = max / this.resolutions_[nearest + 1];\n      }\n    } else {\n      max = this.maxResolution_;\n      zoomFactor = this.zoomFactor_;\n    }\n    return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n  };\n\n  /**\n   * Get the resolution for a zoom level.\n   * @param {number} zoom Zoom level.\n   * @return {number} The view resolution for the provided zoom level.\n   * @api\n   */\n  View.prototype.getResolutionForZoom = function getResolutionForZoom (zoom) {\n    return /** @type {number} */ (this.constrainResolution(\n      this.maxResolution_, zoom - this.minZoom_, 0));\n  };\n\n  /**\n   * Fit the given geometry or extent based on the given map size and border.\n   * The size is pixel dimensions of the box to fit the extent into.\n   * In most cases you will want to use the map size, that is `map.getSize()`.\n   * Takes care of the map angle.\n   * @param {import(\"./geom/SimpleGeometry.js\").default|import(\"./extent.js\").Extent} geometryOrExtent The geometry or\n   *     extent to fit the view to.\n   * @param {FitOptions=} opt_options Options.\n   * @api\n   */\n  View.prototype.fit = function fit (geometryOrExtent, opt_options) {\n    var options = opt_options || {};\n    var size = options.size;\n    if (!size) {\n      size = this.getSizeFromViewport_();\n    }\n    /** @type {import(\"./geom/SimpleGeometry.js\").default} */\n    var geometry;\n    assert(Array.isArray(geometryOrExtent) || typeof /** @type {?} */ (geometryOrExtent).getSimplifiedGeometry === 'function',\n      24); // Invalid extent or geometry provided as `geometry`\n    if (Array.isArray(geometryOrExtent)) {\n      assert(!isEmpty(geometryOrExtent),\n        25); // Cannot fit empty extent provided as `geometry`\n      geometry = polygonFromExtent(geometryOrExtent);\n    } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n      geometryOrExtent = geometryOrExtent.getExtent();\n      geometry = polygonFromExtent(geometryOrExtent);\n      geometry.rotate(this.getRotation(), getCenter(geometryOrExtent));\n    } else {\n      geometry = geometryOrExtent;\n    }\n\n    var padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n    var constrainResolution = options.constrainResolution !== undefined ?\n      options.constrainResolution : true;\n    var nearest = options.nearest !== undefined ? options.nearest : false;\n    var minResolution;\n    if (options.minResolution !== undefined) {\n      minResolution = options.minResolution;\n    } else if (options.maxZoom !== undefined) {\n      minResolution = this.constrainResolution(\n        this.maxResolution_, options.maxZoom - this.minZoom_, 0);\n    } else {\n      minResolution = 0;\n    }\n    var coords = geometry.getFlatCoordinates();\n\n    // calculate rotated extent\n    var rotation = this.getRotation();\n    var cosAngle = Math.cos(-rotation);\n    var sinAngle = Math.sin(-rotation);\n    var minRotX = +Infinity;\n    var minRotY = +Infinity;\n    var maxRotX = -Infinity;\n    var maxRotY = -Infinity;\n    var stride = geometry.getStride();\n    for (var i = 0, ii = coords.length; i < ii; i += stride) {\n      var rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n      var rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n      minRotX = Math.min(minRotX, rotX);\n      minRotY = Math.min(minRotY, rotY);\n      maxRotX = Math.max(maxRotX, rotX);\n      maxRotY = Math.max(maxRotY, rotY);\n    }\n\n    // calculate resolution\n    var resolution = this.getResolutionForExtent(\n      [minRotX, minRotY, maxRotX, maxRotY],\n      [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n    resolution = isNaN(resolution) ? minResolution :\n      Math.max(resolution, minResolution);\n    if (constrainResolution) {\n      var constrainedResolution = this.constrainResolution(resolution, 0, 0);\n      if (!nearest && constrainedResolution < resolution) {\n        constrainedResolution = this.constrainResolution(\n          constrainedResolution, -1, 0);\n      }\n      resolution = constrainedResolution;\n    }\n\n    // calculate center\n    sinAngle = -sinAngle; // go back to original rotation\n    var centerRotX = (minRotX + maxRotX) / 2;\n    var centerRotY = (minRotY + maxRotY) / 2;\n    centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n    centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n    var centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n    var centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n    var center = [centerX, centerY];\n    var callback = options.callback ? options.callback : VOID;\n\n    if (options.duration !== undefined) {\n      this.animate({\n        resolution: resolution,\n        center: center,\n        duration: options.duration,\n        easing: options.easing\n      }, callback);\n    } else {\n      this.setResolution(resolution);\n      this.setCenter(center);\n      animationCallback(callback, true);\n    }\n  };\n\n  /**\n   * Center on coordinate and view position.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   * @api\n   */\n  View.prototype.centerOn = function centerOn (coordinate, size, position) {\n    // calculate rotated position\n    var rotation = this.getRotation();\n    var cosAngle = Math.cos(-rotation);\n    var sinAngle = Math.sin(-rotation);\n    var rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n    var rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n    var resolution = this.getResolution();\n    rotX += (size[0] / 2 - position[0]) * resolution;\n    rotY += (position[1] - size[1] / 2) * resolution;\n\n    // go back to original angle\n    sinAngle = -sinAngle; // go back to original rotation\n    var centerX = rotX * cosAngle - rotY * sinAngle;\n    var centerY = rotY * cosAngle + rotX * sinAngle;\n\n    this.setCenter([centerX, centerY]);\n  };\n\n  /**\n   * @return {boolean} Is defined.\n   */\n  View.prototype.isDef = function isDef () {\n    return !!this.getCenter() && this.getResolution() !== undefined;\n  };\n\n  /**\n   * Rotate the view around a given coordinate.\n   * @param {number} rotation New rotation value for the view.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The rotation center.\n   * @api\n   */\n  View.prototype.rotate = function rotate (rotation, opt_anchor) {\n    if (opt_anchor !== undefined) {\n      var center = this.calculateCenterRotate(rotation, opt_anchor);\n      this.setCenter(center);\n    }\n    this.setRotation(rotation);\n  };\n\n  /**\n   * Set the center of the current view.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.setCenter = function setCenter (center) {\n    this.set(ViewProperty.CENTER, center);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * @param {ViewHint} hint Hint.\n   * @param {number} delta Delta.\n   * @return {number} New value.\n   */\n  View.prototype.setHint = function setHint (hint, delta) {\n    this.hints_[hint] += delta;\n    this.changed();\n    return this.hints_[hint];\n  };\n\n  /**\n   * Set the resolution for this view.\n   * @param {number|undefined} resolution The resolution of the view.\n   * @observable\n   * @api\n   */\n  View.prototype.setResolution = function setResolution (resolution) {\n    this.set(ViewProperty.RESOLUTION, resolution);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * Set the rotation for this view.\n   * @param {number} rotation The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  View.prototype.setRotation = function setRotation (rotation) {\n    this.set(ViewProperty.ROTATION, rotation);\n    if (this.getAnimating()) {\n      this.cancelAnimations();\n    }\n  };\n\n  /**\n   * Zoom to a specific zoom level.\n   * @param {number} zoom Zoom level.\n   * @api\n   */\n  View.prototype.setZoom = function setZoom (zoom) {\n    this.setResolution(this.getResolutionForZoom(zoom));\n  };\n\n  return View;\n}(BaseObject));\n\n\n/**\n * @param {Function} callback Callback.\n * @param {*} returnValue Return value.\n */\nfunction animationCallback(callback, returnValue) {\n  setTimeout(function() {\n    callback(returnValue);\n  }, 0);\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./centerconstraint.js\").Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    return createExtent(options.extent);\n  } else {\n    return centerNone;\n  }\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {{constraint: import(\"./resolutionconstraint.js\").Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  var resolutionConstraint;\n  var maxResolution;\n  var minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  var defaultMaxZoom = 28;\n  var defaultZoomFactor = 2;\n\n  var minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  var maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  var zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  if (options.resolutions !== undefined) {\n    var resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n    resolutionConstraint = createSnapToResolutions(\n      resolutions);\n  } else {\n    // calculate the default min and max resolution\n    var projection = createProjection(options.projection, 'EPSG:3857');\n    var extent = projection.getExtent();\n    var size = !extent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(extent), getHeight(extent));\n\n    var defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    var defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    resolutionConstraint = createSnapToPower(\n      zoomFactor, maxResolution, maxZoom - minZoom);\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./rotationconstraint.js\").Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  var enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    var constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n\n//# sourceMappingURL=View.js.map","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  /**\n   * Indicates that tile loading failed\n   * @type {number}\n   */\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n\n//# sourceMappingURL=TileState.js.map","/** @namespace  ol.ext\n */\n/*global ol*/\nif (window.ol && !ol.ext) {\n  ol.ext = {};\n}\n\n/** Inherit the prototype methods from one constructor into another.\n * replace deprecated ol method\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function module:ol.inherits\n * @api\n */\nvar ol_ext_inherits = function(child,parent) {\n  child.prototype = Object.create(parent.prototype);\n  child.prototype.constructor = child;\n};\n\n// Compatibilty with ol > 5 to be removed when v6 is out\nif (window.ol) {\n  if (!ol.inherits) ol.inherits = ol_ext_inherits;\n}\n\n/* IE Polyfill */\n// NodeList.forEach\nif (window.NodeList && !NodeList.prototype.forEach) {\n  NodeList.prototype.forEach = Array.prototype.forEach;\n}\n// Element.remove\nif (window.Element && !Element.prototype.remove) {\n  Element.prototype.remove = function() {\n    if (this.parentNode) this.parentNode.removeChild(this);\n  }\n}\n/* End Polyfill */\n\nexport {ol_ext_inherits}\nexport default ol_ext_inherits\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Button from './Button'\nimport ol_control_Control from 'ol/control/Control'\n\n/** A simple toggle control\n * The control can be created with an interaction to control its activation.\n *\n * @constructor\n * @extends {ol_control_Control}\n * @fires change:active, change:disable\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.title title of the control\n *\t@param {String} options.html html to insert in the control\n *\t@param {ol.interaction} options.interaction interaction associated with the control\n *\t@param {bool} options.active the control is created active, default false\n *\t@param {bool} options.disable the control is created disabled, default false\n *\t@param {ol.control.Bar} options.bar a subbar associated with the control (drawn when active if control is nested in a ol.control.Bar)\n *\t@param {bool} options.autoActive the control will activate when shown in an ol.control.Bar, default false\n *\t@param {function} options.onToggle callback when control is clicked (or use change:active event)\n */\nvar ol_control_Toggle = function(options)\n{\toptions = options || {};\n\tvar self = this;\n\n\tthis.interaction_ = options.interaction;\n\tif (this.interaction_)\n\t{\tthis.interaction_.on(\"change:active\", function(e)\n\t\t{\tself.setActive(!e.oldValue);\n\t\t});\n\t}\n\n\tif (options.toggleFn) options.onToggle = options.toggleFn; // compat old version\n\toptions.handleClick = function()\n\t\t{\tself.toggle();\n\t\t\tif (options.onToggle) options.onToggle.call(self, self.getActive());\n\t\t};\n\toptions.className = (options.className||\"\") + \" ol-toggle\";\n\tol_control_Button.call(this, options);\n\n\tthis.set(\"title\", options.title);\n\n\tthis.set (\"autoActivate\", options.autoActivate);\n\tif (options.bar)\n\t{\tthis.subbar_ = options.bar;\n\t\tthis.subbar_.setTarget(this.element);\n\t\tthis.subbar_.element.classList.add(\"ol-option-bar\");\n\t}\n\n\tthis.setActive (options.active);\n\tthis.setDisable (options.disable);\n};\nol_ext_inherits(ol_control_Toggle, ol_control_Button);\n\n/**\n * Set the map instance the control is associated with\n * and add interaction attached to it to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_Toggle.prototype.setMap = function(map)\n{\tif (!map && this.getMap())\n\t{\tif (this.interaction_)\n\t\t{\tthis.getMap().removeInteraction (this.interaction_);\n\t\t}\n\t\tif (this.subbar_) this.getMap().removeControl (this.subbar_);\n\t}\n\n\tol_control_Control.prototype.setMap.call(this, map);\n\n\tif (map)\n\t{\tif (this.interaction_) map.addInteraction (this.interaction_);\n\t\tif (this.subbar_) map.addControl (this.subbar_);\n\t}\n};\n\n/** Get the subbar associated with a control\n* @return {ol_control_Bar}\n*/\nol_control_Toggle.prototype.getSubBar = function ()\n{\treturn this.subbar_;\n};\n\n/**\n * Test if the control is disabled.\n * @return {bool}.\n * @api stable\n */\nol_control_Toggle.prototype.getDisable = function()\n{\tvar button = this.element.querySelector(\"button\");\n\treturn button && button.disabled;\n};\n\n/** Disable the control. If disable, the control will be deactivated too.\n* @param {bool} b disable (or enable) the control, default false (enable)\n*/\nol_control_Toggle.prototype.setDisable = function(b)\n{\tif (this.getDisable()==b) return;\n\tthis.element.querySelector(\"button\").disabled = b;\n\tif (b && this.getActive()) this.setActive(false);\n\n\tthis.dispatchEvent({ type:'change:disable', key:'disable', oldValue:!b, disable:b });\n};\n\n/**\n * Test if the control is active.\n * @return {bool}.\n * @api stable\n */\nol_control_Toggle.prototype.getActive = function()\n{\treturn this.element.classList.contains(\"ol-active\");\n};\n\n/** Toggle control state active/deactive\n*/\nol_control_Toggle.prototype.toggle = function()\n{\tif (this.getActive()) this.setActive(false);\n\telse this.setActive(true);\n};\n\n/** Change control state\n* @param {bool} b activate or deactivate the control, default false\n*/\nol_control_Toggle.prototype.setActive = function(b)\n{\t\n\tif (this.interaction_) this.interaction_.setActive (b);\n\tif (this.subbar_) this.subbar_.setActive(b);\n\tif (this.getActive()===b) return;\n\tif (b) this.element.classList.add(\"ol-active\");\n\telse this.element.classList.remove(\"ol-active\");\n\n\tthis.dispatchEvent({ type:'change:active', key:'active', oldValue:!b, active:b });\n};\n\n/** Set the control interaction\n* @param {_ol_interaction_} i interaction to associate with the control\n*/\nol_control_Toggle.prototype.setInteraction = function(i)\n{\tthis.interaction_ = i;\n};\n\n/** Get the control interaction\n* @return {_ol_interaction_} interaction associated with the control\n*/\nol_control_Toggle.prototype.getInteraction = function()\n{\treturn this.interaction_;\n};\n\nexport default ol_control_Toggle\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Button from \"./Button\";\n\n/** A simple push button control drawn as text\n * @constructor\n * @extends {ol_control_Button}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.title title of the control\n *\t@param {String} options.html html to insert in the control\n *\t@param {function} options.handleClick callback when control is clicked (or use change:active event)\n */\n\nvar ol_control_TextButton = function(options)\n{\toptions = options || {};\n    options.className = (options.className||\"\") + \" ol-text-button\";\n    ol_control_Button.call(this, options);\n};\nol_ext_inherits(ol_control_TextButton, ol_control_Button);\n\nexport default ol_control_TextButton\n","/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Select from 'ol/interaction/Select'\nimport ol_source_Vector from 'ol/source/Vector'\n\n/** A Select interaction to delete features on click.\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires deletestart\n * @fires deleteend\n * @param {*} options ol.interaction.Select options\n */\nvar ol_interaction_Delete = function(options) {\n  ol_interaction_Select.call(this, options);\n  this.on('select', function(e) {\n    this.getFeatures().clear();\n    this.delete(e.selected);\n  }.bind(this));\n};\nol_ext_inherits(ol_interaction_Delete, ol_interaction_Select);\n\n/** Get vector source of the map\n * @return {Array<ol.source.Vector}\n */\nol_interaction_Delete.prototype._getSources = function(layers) {\n  if (!this.getMap()) return [];\n  if (!layers) layers = this.getMap().getLayers();\n  var sources = [];\n  layers.forEach(function (l) {\n    // LayerGroup\n    if (l.getLayers) {\n      sources = sources.concat(this._getSources(l.getLayers()));\n    } else {\n      if (l.getSource && l.getSource() instanceof ol_source_Vector) {\n        sources.push(l.getSource());\n      }\n    }\n  }.bind(this));\n  return sources;\n};\n\n/** Delete features: remove the features from the map (from all layers in the map)\n * @param {ol.Collection<ol.Feature>|Array<ol.Feature>} features The features to delete\n * @api\n */\nol_interaction_Delete.prototype.delete = function(features) {\n  if (features && (features.length || features.getLength())) {\n    this.dispatchEvent({ type: 'deletestart', features: features });\n    var delFeatures = [];\n    // Get the sources concerned\n    this._getSources().forEach(function (source) {\n      try {\n        // Try to delete features in the source\n        features.forEach(function(f) {\n          source.removeFeature(f);\n          delFeatures.push(f);\n        });\n      } catch(e) { /* ok */ }\n    })\n    this.dispatchEvent({ type: 'deleteend', features: delFeatures });\n  }\n};\n\nexport default ol_interaction_Delete","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\n  Usefull function to handle geometric operations\n*/\n\nimport {getCenter as ol_extent_getCenter} from 'ol/extent'\n\n/** Distance beetween 2 points\n *\tUsefull geometric functions\n * @param {ol.Coordinate} p1 first point\n * @param {ol.Coordinate} p2 second point\n * @return {number} distance\n */\nvar ol_coordinate_dist2d = function(p1, p2) {\n  var dx = p1[0]-p2[0];\n  var dy = p1[1]-p2[1];\n  return Math.sqrt(dx*dx+dy*dy);\n}\n\n/** 2 points are equal\n *\tUsefull geometric functions\n * @param {ol.Coordinate} p1 first point\n * @param {ol.Coordinate} p2 second point\n * @return {boolean}\n */\nvar ol_coordinate_equal = function(p1, p2) {\n  return (p1[0]==p2[0] && p1[1]==p2[1]);\n}\n\n/** Get center coordinate of a feature\n * @param {ol.Feature} f\n * @return {ol.coordinate} the center\n */\nvar ol_coordinate_getFeatureCenter = function(f) {\n  return ol_coordinate_getGeomCenter (f.getGeometry());\n};\n\n/** Get center coordinate of a geometry\n* @param {ol.Feature} geom\n* @return {ol.Coordinate} the center\n*/\nvar ol_coordinate_getGeomCenter = function(geom) {\n  switch (geom.getType()) {\n    case 'Point': \n      return geom.getCoordinates();\n    case \"MultiPolygon\":\n            geom = geom.getPolygon(0);\n            // fallthrough\n    case \"Polygon\":\n      return geom.getInteriorPoint().getCoordinates();\n    default:\n      return geom.getClosestPoint(ol_extent_getCenter(geom.getExtent()));\n  }\n};\n\n/** Offset a polyline\n * @param {Array<ol.Coordinate>} coords\n * @param {number} offset\n * @return {Array<ol.Coordinate>} resulting coord\n * @see http://stackoverflow.com/a/11970006/796832\n * @see https://drive.google.com/viewerng/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxqa2dhZGdldHN0b3JlfGd4OjQ4MzI5M2Y0MjNmNzI2MjY\n */\nvar ol_coordinate_offsetCoords = function (coords, offset) {\n  var path = [];\n  var N = coords.length-1;\n  var max = N;\n  var mi, mi1, li, li1, ri, ri1, si, si1, Xi1, Yi1;\n  var p0, p1, p2;\n  var isClosed = ol_coordinate_equal(coords[0],coords[N]);\n  if (!isClosed) {\n    p0 = coords[0];\n    p1 = coords[1];\n    p2 = [\n      p0[0] + (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\n      p0[1] - (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\n    ];\n    path.push(p2);\n    coords.push(coords[N])\n    N++;\n    max--;\n  }\n  for (var i = 0; i < max; i++) {\n    p0 = coords[i];\n    p1 = coords[(i+1) % N];\n    p2 = coords[(i+2) % N];\n\n    mi = (p1[1] - p0[1])/(p1[0] - p0[0]);\n    mi1 = (p2[1] - p1[1])/(p2[0] - p1[0]);\n    // Prevent alignements\n    if (Math.abs(mi-mi1) > 1e-10) {\n      li = Math.sqrt((p1[0] - p0[0])*(p1[0] - p0[0])+(p1[1] - p0[1])*(p1[1] - p0[1]));\n      li1 = Math.sqrt((p2[0] - p1[0])*(p2[0] - p1[0])+(p2[1] - p1[1])*(p2[1] - p1[1]));\n      ri = p0[0] + offset*(p1[1] - p0[1])/li;\n      ri1 = p1[0] + offset*(p2[1] - p1[1])/li1;\n      si = p0[1] - offset*(p1[0] - p0[0])/li;\n      si1 = p1[1] - offset*(p2[0] - p1[0])/li1;\n      Xi1 = (mi1*ri1-mi*ri+si-si1) / (mi1-mi);\n      Yi1 = (mi*mi1*(ri1-ri)+mi1*si-mi*si1) / (mi1-mi);\n\n      // Correction for vertical lines\n      if(p1[0] - p0[0] == 0) {\n        Xi1 = p1[0] + offset*(p1[1] - p0[1])/Math.abs(p1[1] - p0[1]);\n        Yi1 = mi1*Xi1 - mi1*ri1 + si1;\n      }\n      if (p2[0] - p1[0] == 0 ) {\n        Xi1 = p2[0] + offset*(p2[1] - p1[1])/Math.abs(p2[1] - p1[1]);\n        Yi1 = mi*Xi1 - mi*ri + si;\n      }\n\n      path.push([Xi1, Yi1]);\n    }\n  }\n  if (isClosed) {\n    path.push(path[0]);\n  } else {\n    coords.pop();\n    p0 = coords[coords.length-1];\n    p1 = coords[coords.length-2];\n    p2 = [\n      p0[0] - (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\n      p0[1] + (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\n    ];\n    path.push(p2);\n  }\n  return path;\n}\n\n/** Find the segment a point belongs to\n * @param {ol.Coordinate} pt\n * @param {Array<ol.Coordinate>} coords\n * @return {} the index (-1 if not found) and the segment\n */\nvar ol_coordinate_findSegment = function (pt, coords) {\n  for (var i=0; i<coords.length-1; i++) {\n    var p0 = coords[i];\n    var p1 = coords[i+1];\n    if (ol_coordinate_equal(pt, p0) || ol_coordinate_equal(pt, p1)) {\n      return { index:1, segment: [p0,p1] };\n    } else {\n      var d0 = ol_coordinate_dist2d(p0,p1);\n      var v0 = [ (p1[0] - p0[0]) / d0, (p1[1] - p0[1]) / d0 ];\n      var d1 = ol_coordinate_dist2d(p0,pt);\n      var v1 = [ (pt[0] - p0[0]) / d1, (pt[1] - p0[1]) / d1 ];\n      if (Math.abs(v0[0]*v1[1] - v0[1]*v1[0]) < 1e-10) {\n        return { index:1, segment: [p0,p1] };\n      }\n    }\n  }\n  return { index: -1 };\n};\n\n/**\n * Split a Polygon geom with horizontal lines\n * @param {Array<ol.Coordinate>} geom\n * @param {number} y the y to split\n * @param {number} n contour index\n * @return {Array<Array<ol.Coordinate>>}\n */\nvar ol_coordinate_splitH = function (geom, y, n) {\n  var x, abs;\n  var list = [];\n  for (var i=0; i<geom.length-1; i++) {\n    // Hole separator?\n    if (!geom[i].length || !geom[i+1].length) continue;\n    // Intersect\n    if (geom[i][1]<=y && geom[i+1][1]>y || geom[i][1]>=y && geom[i+1][1]<y) {\n      abs = (y-geom[i][1]) / (geom[i+1][1]-geom[i][1]);\n      x = abs * (geom[i+1][0]-geom[i][0]) + geom[i][0];\n      list.push ({ contour: n, index: i, pt: [x,y], abs: abs });\n    }\n  }\n  // Sort x\n  list.sort(function(a,b) { return a.pt[0] - b.pt[0] });\n  // Horizontal segement\n  var result = [];\n  for (var j=0; j<list.length-1; j += 2) {\n    result.push([list[j], list[j+1]])\n  }\n  return result;\n};\n\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\nimport ol_geom_MultiLineString from 'ol/geom/MultiLineString'\nimport ol_geom_MultiPoint from 'ol/geom/MultiPoint'\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\n\n/** Create a geometrie given a type and coordinates */\nvar ol_geom_createFromType = function (type, coordinates) {\n  switch (type) {\n    case 'LineString': return new ol_geom_LineString(coordinates);\n    case 'LinearRing': return new ol_geom_LinearRing(coordinates);\n    case 'MultiLineString': return new ol_geom_MultiLineString(coordinates);\n    case 'MultiPoint': return new ol_geom_MultiPoint(coordinates);\n    case 'MultiPolygon': return new ol_geom_MultiPolygon(coordinates);\n    case 'Point': return new ol_geom_Point(coordinates);\n    case 'Polygon': return new ol_geom_Polygon(coordinates);\n    default:\n      console.error('[createFromType] Unsupported type: '+type);\n      return null;\n  }\n};\n\nexport {ol_geom_createFromType}\nexport {ol_coordinate_dist2d, ol_coordinate_equal, ol_coordinate_findSegment, ol_coordinate_getFeatureCenter, ol_coordinate_getGeomCenter, ol_coordinate_offsetCoords, ol_coordinate_splitH}\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport {ol_coordinate_dist2d, ol_coordinate_findSegment, ol_coordinate_offsetCoords} from \"../geom/GeomUtils\";\n\n/** Offset interaction for offseting feature geometry\n * @constructor\n * @extends {ol_interaction_Pointer}\n * @fires offsetstart\n * @fires offsetting\n * @fires offsetend\n * @param {any} options\n *\t@param {ol.layer.Vector | Array<ol.layer.Vector>} options.layers list of feature to transform \n *\t@param {ol.Collection.<ol.Feature>} options.features collection of feature to transform\n *\t@param {ol.source.Vector | undefined} options.source source to duplicate feature when ctrl key is down\n *\t@param {boolean} options.duplicate force feature to duplicate (source must be set)\n */\nvar ol_interaction_Offset = function(options) {\n  if (!options) options = {};\n\n\t// Extend pointer\n\tol_interaction_Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n    \n\t// Collection of feature to transform\n\tthis.features_ = options.features;\n\t// List of layers to transform\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n  // duplicate\n  this.set('duplicate', options.duplicate);\n  this.source_ = options.source;\n\n  // init\n  this.previousCursor_ = false;\n};\nol_ext_inherits(ol_interaction_Offset, ol_interaction_Pointer);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_Offset.prototype.setMap = function(map) {\n\tol_interaction_Pointer.prototype.setMap.call (this, map);\n};\n\n/** Get Feature at pixel\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {any} a feature and the hit point\n * @private\n */\nol_interaction_Offset.prototype.getFeatureAtPixel_ = function(e) {\n  var self = this;\n\treturn this.getMap().forEachFeatureAtPixel(e.pixel,\n\t\tfunction(feature, layer) {\n      var current;\n\t\t\t// feature belong to a layer\n\t\t\tif (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) {\n            current = feature;\n            break;\n          }\n\t\t\t\t}\n\t\t\t}\n\t\t\t// feature in the collection\n\t\t\telse if (self.features_) {\n        self.features_.forEach (function(f) {\n          if (f===feature) {\n            current = feature \n          }\n        });\n\t\t\t}\n\t\t\t// Others\n\t\t\telse {\n        current = feature;\n      }\n\n      // Only poygon or linestring\n      var typeGeom = current.getGeometry().getType();\n      if (current && /Polygon|LineString/.test(typeGeom)) {\n        if (typeGeom==='Polygon' && current.getGeometry().getCoordinates().length>1) return false;\n        // test distance\n        var p = current.getGeometry().getClosestPoint(e.coordinate);\n        var dx = p[0]-e.coordinate[0];\n        var dy = p[1]-e.coordinate[1];\n        var d = Math.sqrt(dx*dx+dy*dy) / e.frameState.viewState.resolution;\n      \n        if (d<5) {\n          return { \n            feature: current, \n            hit: p, \n            coordinates: current.getGeometry().getCoordinates(),\n            geom: current.getGeometry().clone(),\n            geomType: typeGeom\n          }\n        } else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n\t\t},  { hitTolerance: 5 });\n};\n\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n * @private\n */\nol_interaction_Offset.prototype.handleDownEvent_ = function(e) {\t\n  this.current_ = this.getFeatureAtPixel_(e);\n  if (this.source_ && (this.get('duplicate') || e.originalEvent.ctrlKey)) {\n    this.current_.feature = this.current_.feature.clone();\n    this.source_.addFeature(this.current_.feature);\n  } else {\n    // Modify the current feature\n    if (this.current_) {\n      this.dispatchEvent({ type:'modifystart', features: [ this.current_.feature ] });\n    }\n  }\n\tif (this.current_) {\n    this.dispatchEvent({ type:'offsetstart', feature: this.current_.feature, offset: 0 });\n    return true;\n  } else  {\n    return false;\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol_interaction_Offset.prototype.handleDragEvent_ = function(e) {\n  var p = this.current_.geom.getClosestPoint(e.coordinate);\n  var d = ol_coordinate_dist2d(p, e.coordinate);\n  var seg, v1, v2, offset;\n  switch (this.current_.geomType) {\n    case  'Polygon': {\n      seg = ol_coordinate_findSegment(p, this.current_.coordinates[0]).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n\n        offset = [];\n        for (var i=0; i<this.current_.coordinates.length; i++) {\n          offset.push( ol_coordinate_offsetCoords(this.current_.coordinates[i], i==0 ? d : -d) );\n        }\n        this.current_.feature.setGeometry(new ol_geom_Polygon(offset));\n      }\n      break;\n    }\n    case 'LineString': {\n      seg = ol_coordinate_findSegment(p, this.current_.coordinates).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n        offset = ol_coordinate_offsetCoords(this.current_.coordinates, d);\n        this.current_.feature.setGeometry(new ol_geom_LineString(offset));\n      }\n      break;\n    }\n    default: {\n      break;\n    }\n  }\n  this.dispatchEvent({ type:'offsetting', feature: this.current_.feature, offset: d, segment: [p, e.coordinate], coordinate: e.coordinate });  \n};\n\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol_interaction_Offset.prototype.handleUpEvent_ = function(e) {\n  this.dispatchEvent({ type:'offsetend', feature: this.current_.feature, coordinate: e.coordinate });  \n  this.current_ = false;\n};\n\n/**\n * @param {ol.MapBrowserEvent} e Event.\n * @private\n */\nol_interaction_Offset.prototype.handleMoveEvent_ = function(e) {\t\n  var f = this.getFeatureAtPixel_(e);\n  if (f) {\n    if (this.previousCursor_ === false) {\n      this.previousCursor_ = e.map.getTargetElement().style.cursor;\n    }\n    e.map.getTargetElement().style.cursor = 'pointer';\n  } else {\n    e.map.getTargetElement().style.cursor = this.previousCursor_;\n    this.previousCursor_ = false;\n  }\n};\n\nexport default ol_interaction_Offset","import {ol_coordinate_equal} from \"./GeomUtils\";\nimport ol_geom_LineString from \"ol/geom/LineString\";\n\n/** Split a lineString by a point or a list of points\n *\tNB: points must be on the line, use getClosestPoint() to get one\n* @param {ol.Coordinate | Array<ol.Coordinate>} pt points to split the line\n* @param {Number} tol distance tolerance for 2 points to be equal\n*/\nol_geom_LineString.prototype.splitAt = function(pt, tol) {\n  var i;\n  if (!pt) return [this];\n    if (!tol) tol = 1e-10;\n    // Test if list of points\n    if (pt.length && pt[0].length) {\n      var result = [this];\n      for (i=0; i<pt.length; i++) {\n        var r = [];\n        for (var k=0; k<result.length; k++) {\n          var ri = result[k].splitAt(pt[i], tol);\n          r = r.concat(ri);\n        }\n        result = r;\n      }\n      return result;\n    }\n    // Nothing to do\n    if (ol_coordinate_equal(pt,this.getFirstCoordinate())\n    || ol_coordinate_equal(pt,this.getLastCoordinate())) {\n      return [this];\n    }\n    // Get\n    var c0 = this.getCoordinates();\n    var ci=[c0[0]];\n    var c = [];\n    for (i=0; i<c0.length-1; i++) {\n      // Filter equal points\n      if (ol_coordinate_equal(c0[i],c0[i+1])) continue;\n      // Extremity found\n      if (ol_coordinate_equal(pt,c0[i+1])) {\n        ci.push(c0[i+1]);\n        c.push(new ol_geom_LineString(ci));\n        ci = [];\n      }\n      // Test alignement\n      else if (!ol_coordinate_equal(pt,c0[i])) {\n        var d1, d2, split=false;\n        if (c0[i][0] == c0[i+1][0]) {\n          d1 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (c0[i][0] == pt[0]) && (0 < d1 && d1 <= 1)\n        } else if (c0[i][1] == c0[i+1][1]) {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          split = (c0[i][1] == pt[1]) && (0 < d1 && d1 <= 1)\n        } else {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          d2 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (Math.abs(d1-d2) <= tol && 0 < d1 && d1 <= 1)\n        }\n        // pt is inside the segment > split\n        if (split) {\n          ci.push(pt);\n          c.push (new ol_geom_LineString(ci));\n          ci = [pt];\n        }\n      }\n      ci.push(c0[i+1]);\n    }\n    if (ci.length>1) c.push (new ol_geom_LineString(ci));\n    if (c.length) return c;\n    else return [this];\n}\n\n// import('ol-ext/geom/LineStringSplitAt')","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_style_Circle from 'ol/style/Circle'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_Feature from 'ol/Feature'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport {ol_coordinate_dist2d} from \"../geom/GeomUtils\";\nimport '../geom/LineStringSplitAt'\n\n/** Interaction split interaction for splitting feature geometry\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires  beforesplit, aftersplit, pointermove\n * @param {*} \n *  @param {ol.source.Vector|Array{ol.source.Vector}} options.source a list of source to split (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to split\n *  @param {integer} options.snapDistance distance (in px) to snap to an object, default 25px\n *\t@param {string|undefined} options.cursor cursor name to display when hovering an objet\n *  @param {function|undefined} opttion.filter a filter that takes a feature and return true if it can be clipped, default always split.\n *  @param ol_style_Style | Array<ol_style_Style> | false | undefined} options.featureStyle Style for the selected features, choose false if you don't want feature selection. By default the default edit style is used.\n *  @param {ol_style_Style | Array<ol_style_Style> | undefined} options.sketchStyle Style for the sektch features. \n *  @param {function|undefined} options.tolerance Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split.  Default is 1e-10.\n */\nvar ol_interaction_Split = function(options) {\n  if (!options) options = {};\n\n  ol_interaction_Interaction.call(this, {\n    handleEvent: function(e) {\n      switch (e.type) {\n        case \"singleclick\":\n          return this.handleDownEvent(e);\n        case \"pointermove\":\n          return this.handleMoveEvent(e);\n        default: \n          return true;\n      }\n      //return true;\n    }\n  });\n\n  // Snap distance (in px)\n  this.snapDistance_ = options.snapDistance || 25;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = options.tolerance || 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n\n  if (options.features) {\n    this.sources_.push (new ol_source_Vector({ features: options.features }));\n  }\n\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n\n  // Default style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var fill = new ol_style_Fill({ color: 'rgba(255,255,255,0.4)' });\n  var stroke = new ol_style_Stroke({\n    color: '#3399CC',\n    width: 1.25\n  });\n  var sketchStyle = [\n    new ol_style_Style({\n      image: new ol_style_Circle({\n        fill: fill,\n        stroke: stroke,\n        radius: 5\n      }),\n      fill: fill,\n      stroke: stroke\n    })\n  ];\n  var featureStyle = [\n    new ol_style_Style({\n      stroke: new ol_style_Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new ol_style_Style({\n      image: new ol_style_Circle({\n        radius: 2*width,\n        fill: new ol_style_Fill({\n          color: blue\n        }),\n        stroke: new ol_style_Stroke({\n          color: white,\n          width: width/2\n        })\n      }),\n      stroke: new ol_style_Stroke({\n          color: blue,\n          width: width\n        })\n    }),\n  ];\n\n  // Custom style\n  if (options.sketchStyle) sketchStyle = options.sketchStyle instanceof Array ? options.sketchStyle : [options.sketchStyle];\n  if (options.featureStyle) featureStyle = options.featureStyle instanceof Array ? options.featureStyle : [options.featureStyle];\n\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      useSpatialIndex: false\n    }),\n    name:'Split overlay',\n    displayInLayerSwitcher: false,\n    style: function(f) {\n      if (f._sketch_) return sketchStyle;\n      else return featureStyle;\n    }\n  });\n\n};\nol_ext_inherits(ol_interaction_Split, ol_interaction_Interaction);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_Split.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {ol.feature} \n * @private\n */\nol_interaction_Split.prototype.getClosestFeature = function(e) {\n  var f, c, g, d = this.snapDistance_+1;\n  for (var i=0; i<this.sources_.length; i++) {\n    var source = this.sources_[i];\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\n    if (f && f.getGeometry().splitAt) {\n      c = f.getGeometry().getClosestPoint(e.coordinate);\n      g = new ol_geom_LineString([e.coordinate,c]);\n      d = g.getLength() / e.frameState.viewState.resolution;\n      break;\n    }\n  }\n  if (d > this.snapDistance_) {\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry().getCoordinates());\n    var p = this.getMap().getPixelFromCoordinate(coord);\n    if (ol_coordinate_dist2d(e.pixel, p) < this.snapDistance_) {\n      c = coord;\n    }\n    //\n    return { source:source, feature:f, coord: c, link: g };\n  }\n}\n\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {Array<ol.coordinate>} coords list of coordinates\n* @return {ol.coordinate} the nearest coordinate in the list\n*/\nol_interaction_Split.prototype.getNearestCoord = function(pt, coords) {\n  var d, dm=Number.MAX_VALUE, p0;\n  for (var i=0; i < coords.length; i++) {\n    d = ol_coordinate_dist2d (pt, coords[i]);\n    if (d < dm) {\n      dm = d;\n      p0 = coords[i];\n    }\n  }\n  return p0;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol_interaction_Split.prototype.handleDownEvent = function(evt) {\n  // Something to split ?\n  var current = this.getClosestFeature(evt);\n\n  if (current) {\n    var self = this;\n    self.overlayLayer_.getSource().clear();\n    var split = current.feature.getGeometry().splitAt(current.coord, this.tolerance_);\n    var i;\n    if (split.length > 1) {\n      var tosplit = [];\n      for (i=0; i<split.length; i++) {\n        var f = current.feature.clone();\n        f.setGeometry(split[i]);\n        tosplit.push(f);\n      }\n      self.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n      current.source.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n      current.source.removeFeature(current.feature);\n      for (i=0; i<tosplit.length; i++) {\n        current.source.addFeature(tosplit[i]);\n      }\n      self.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n      current.source.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n    }\n  }\n  return false;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol_interaction_Split.prototype.handleMoveEvent = function(e) {\n  var map = e.map;\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n\n  if (current && this.filterSplit_(current.feature)) {\n    var p, l;\n    // Draw sketch\n    this.overlayLayer_.getSource().addFeature(current.feature);\n    p = new ol_Feature(new ol_geom_Point(current.coord));\n    p._sketch_ = true;\n    this.overlayLayer_.getSource().addFeature(p);\n    //\n    l = new ol_Feature(current.link);\n    l._sketch_ = true;\n    this.overlayLayer_.getSource().addFeature(l);\n    // move event\n    this.dispatchEvent({\n      type: 'pointermove',\n      coordinate: e.coordinate,\n      frameState: e.frameState,\n      originalEvent: e.originalEvent,\n      map: e.map,\n      pixel: e.pixel,\n      feature: current.feature,\n      linkGeometry: current.link\n    });\n  } else {\n    this.dispatchEvent(e);\n  }\n\n  var element = map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\nexport default ol_interaction_Split\n","import ol_ext_inherits from '../util/ext'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_Feature from 'ol/Feature'\nimport ol_Collection from 'ol/Collection'\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\nimport ol_style_RegularShape from 'ol/style/RegularShape'\nimport {fromExtent as ol_geom_Polygon_fromExtent} from 'ol/geom/Polygon'\nimport {boundingExtent as ol_extent_boundingExtent, buffer as ol_extent_buffer, createEmpty as ol_extent_createEmpty, extend as ol_extent_extend, getCenter as ol_extent_getCenter} from 'ol/extent'\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\n\n/** Interaction rotate\n * @constructor\n * @extends {ol_interaction_Pointer}\n * @fires select | rotatestart | rotating | rotateend | translatestart | translating | translateend | scalestart | scaling | scaleend\n * @param {any} options\n *  @param {function} options.filter A function that takes a Feature and a Layer and returns true if the feature may be transformed or false otherwise.\n *  @param {Array<ol.Layer>} options.layers array of layers to transform,\n *  @param {ol.Collection<ol.Feature>} options.features collection of feature to transform,\n *\t@param {ol.EventsConditionType|undefined} options.addCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. default: ol.events.condition.never.\n *\t@param {number | undefined} options.hitTolerance Tolerance to select feature in pixel, default 0\n *\t@param {bool} options.translateFeature Translate when click on feature\n *\t@param {bool} options.translate Can translate the feature\n *\t@param {bool} options.stretch can stretch the feature\n *\t@param {bool} options.scale can scale the feature\n *\t@param {bool} options.rotate can rotate the feature\n *\t@param {bool} options.noFlip prevent the feature geometry to flip, default false\n *\t@param {bool} options.selection the intraction handle selection/deselection, if not use the select prototype to add features to transform, default true\n *\t@param {ol.events.ConditionType | undefined} options.keepAspectRatio A function that takes an ol.MapBrowserEvent and returns a boolean to keep aspect ratio, default ol.events.condition.shiftKeyOnly.\n *\t@param {ol.events.ConditionType | undefined} options.modifyCenter A function that takes an ol.MapBrowserEvent and returns a boolean to apply scale & strech from the center, default ol.events.condition.metaKey or ol.events.condition.ctrlKey.\n *\t@param {} options.style list of ol.style for handles\n *\n */\nvar ol_interaction_Transform = function(options) {\n  if (!options) options = {};\n\tvar self = this;\n\n  this.selection_ = new ol_Collection();\n\n\t// Create a new overlay layer for the sketch\n\tthis.handles_ = new ol_Collection();\n\tthis.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      features: this.handles_,\n      useSpatialIndex: false,\n      wrapX: false // For vector editing across the -180° and 180° meridians to work properly, this should be set to false\n    }),\n    name:'Transform overlay',\n    displayInLayerSwitcher: false,\n    // Return the style according to the handle type\n    style: function (feature) {\n      return (self.style[(feature.get('handle')||'default')+(feature.get('constraint')||'')+(feature.get('option')||'')]);\n    },\n  });\n\n  // Extend pointer\n  ol_interaction_Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n\n  // Collection of feature to transform\n  this.features_ = options.features;\n  // Filter or list of layers to transform\n  if (typeof(options.filter)==='function') this._filter = options.filter;\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n\n  this.addFn_ = options.addCondition || function() { return false; };\n  /* Translate when click on feature */\n  this.set('translateFeature', (options.translateFeature!==false));\n  /* Can translate the feature */\n  this.set('translate', (options.translate!==false));\n  /* Can stretch the feature */\n  this.set('stretch', (options.stretch!==false));\n  /* Can scale the feature */\n  this.set('scale', (options.scale!==false));\n  /* Can rotate the feature */\n  this.set('rotate', (options.rotate!==false));\n  /* Keep aspect ratio */\n  this.set('keepAspectRatio', (options.keepAspectRatio || function(e){ return e.originalEvent.shiftKey }));\n  /* Modify center */\n  this.set('modifyCenter', (options.modifyCenter || function(e){ return e.originalEvent.metaKey || e.originalEvent.ctrlKey }));\n  /* Prevent flip */\n  this.set('noFlip', (options.noFlip || false));\n  /* Handle selection */\n  this.set('selection', (options.selection !== false));\n  /*  */\n  this.set('hitTolerance', (options.hitTolerance || 0));\n\n\n  // Force redraw when changed\n  this.on ('propertychange', function() {\n    this.drawSketch_();\n  });\n\n  // setstyle\n  this.setDefaultStyle();\n};\nol_ext_inherits(ol_interaction_Transform, ol_interaction_Pointer);\n\n/** Cursors for transform\n*/\nol_interaction_Transform.prototype.Cursors = {\n  'default': 'auto',\n  'select': 'pointer',\n  'translate': 'move',\n  'rotate': 'move',\n  'rotate0': 'move',\n  'scale': 'nesw-resize',\n  'scale1': 'nwse-resize',\n  'scale2': 'nesw-resize',\n  'scale3': 'nwse-resize',\n  'scalev': 'ew-resize',\n  'scaleh1': 'ns-resize',\n  'scalev2': 'ew-resize',\n  'scaleh3': 'ns-resize'\n};\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_Transform.prototype.setMap = function(map) {\n  if (this.getMap()) {\n    this.getMap().removeLayer(this.overlayLayer_);\n    if (this.previousCursor_) {\n      this.getMap().getTargetElement().style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n  ol_interaction_Pointer.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n  if (map !== null) {\n    this.isTouch = /touch/.test(map.getViewport().className);\n    this.setDefaultStyle();\n  }\n};\n\n/**\n * Activate/deactivate interaction\n * @param {bool}\n * @api stable\n */\nol_interaction_Transform.prototype.setActive = function(b) {\n  this.select(null);\n  this.overlayLayer_.setVisible(b);\n  ol_interaction_Pointer.prototype.setActive.call (this, b);\n};\n\n/** Set efault sketch style\n*/\nol_interaction_Transform.prototype.setDefaultStyle = function() {\n  // Style\n  var stroke = new ol_style_Stroke({ color: [255,0,0,1], width: 1 });\n  var strokedash = new ol_style_Stroke({ color: [255,0,0,1], width: 1, lineDash:[4,4] });\n  var fill0 = new ol_style_Fill({ color:[255,0,0,0.01] });\n  var fill = new ol_style_Fill({ color:[255,255,255,0.8] });\n  var circle = new ol_style_RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 15\n    });\n  circle.getAnchor()[0] = this.isTouch ? -10 : -5;\n  var bigpt = new ol_style_RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 16 : 8,\n      points: 4,\n      angle: Math.PI/4\n    });\n  var smallpt = new ol_style_RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 4,\n      angle: Math.PI/4\n    });\n  function createStyle (img, stroke, fill) {\n    return [ new ol_style_Style({image:img, stroke:stroke, fill:fill}) ];\n  }\n  /** Style for handles */\n  this.style = {\n    'default': createStyle (bigpt, strokedash, fill0),\n    'translate': createStyle (bigpt, stroke, fill),\n    'rotate': createStyle (circle, stroke, fill),\n    'rotate0': createStyle (bigpt, stroke, fill),\n    'scale': createStyle (bigpt, stroke, fill),\n    'scale1': createStyle (bigpt, stroke, fill),\n    'scale2': createStyle (bigpt, stroke, fill),\n    'scale3': createStyle (bigpt, stroke, fill),\n    'scalev': createStyle (smallpt, stroke, fill),\n    'scaleh1': createStyle (smallpt, stroke, fill),\n    'scalev2': createStyle (smallpt, stroke, fill),\n    'scaleh3': createStyle (smallpt, stroke, fill),\n  };\n  this.drawSketch_();\n}\n\n/**\n * Set sketch style.\n * @param {style} style Style name: 'default','translate','rotate','rotate0','scale','scale1','scale2','scale3','scalev','scaleh1','scalev2','scaleh3'\n * @param {ol.style.Style|Array<ol.style.Style>} olstyle\n * @api stable\n */\nol_interaction_Transform.prototype.setStyle = function(style, olstyle) {\n  if (!olstyle) return;\n  if (olstyle instanceof Array) this.style[style] = olstyle;\n  else this.style[style] = [ olstyle ];\n  for (var i=0; i<this.style[style].length; i++) {\n    var im = this.style[style][i].getImage();\n    if (im) {\n      if (style == 'rotate') im.getAnchor()[0] = -5;\n      if (this.isTouch) im.setScale(1.8);\n    }\n    var tx = this.style[style][i].getText();\n    if (tx) {\n      if (style == 'rotate') tx.setOffsetX(this.isTouch ? 14 : 7);\n      if (this.isTouch) tx.setScale(1.8);\n    }\n  }\n  this.drawSketch_();\n};\n\n/** Get Feature at pixel\n * @param {ol.Pixel}\n * @return {ol.feature}\n * @private\n */\nol_interaction_Transform.prototype.getFeatureAtPixel_ = function(pixel) {\n  var self = this;\n  return this.getMap().forEachFeatureAtPixel(pixel,\n    function(feature, layer) {\n      var found = false;\n      // Overlay ?\n      if (!layer) {\n        if (feature===self.bbox_) return false;\n        self.handles_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature, handle:feature.get('handle'), constraint:feature.get('constraint'), option:feature.get('option') };\n      }\n      // No seletion\n      if (!self.get('selection')) {\n        // Return the currently selected feature the user is interacting with.\n        if (self.selection_.getArray().some(function(f) { return feature === f; })) {\n          return { feature: feature };\n        }\n        return null;\n      }\n      // filter condition\n      if (self._filter) {\n        if (self._filter(feature,layer)) return { feature: feature };\n        else return null;\n      }\n      // feature belong to a layer\n      else if (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) return { feature: feature };\n        }\n        return null;\n      }\n      // feature in the collection\n      else if (self.features_) {\n        self.features_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature };\n        else return null;\n      }\n      // Others\n      else return { feature: feature };\n    },\n    { hitTolerance: this.get('hitTolerance') }\n  ) || {};\n}\n\n/** Draw transform sketch\n* @param {boolean} draw only the center\n*/\nol_interaction_Transform.prototype.drawSketch_ = function(center) {\n  var i, f, geom;\n  this.overlayLayer_.getSource().clear();\n  if (!this.selection_.getLength()) return;\n  var ext = this.selection_.item(0).getGeometry().getExtent();\n  // Clone and extend\n  ext = ol_extent_buffer(ext, 0);\n  this.selection_.forEach(function (f) {\n    ol_extent_extend(ext, f.getGeometry().getExtent());\n  });\n  if (center===true) {\n    if (!this.ispt_) {\n      this.overlayLayer_.getSource().addFeature(new ol_Feature( { geometry: new ol_geom_Point(this.center_), handle:'rotate0' }) );\n      geom = ol_geom_Polygon_fromExtent(ext);\n      f = this.bbox_ = new ol_Feature(geom);\n      this.overlayLayer_.getSource().addFeature (f);\n    }\n  }\n  else {\n    if (this.ispt_) {\n      var p = this.getMap().getPixelFromCoordinate([ext[0], ext[1]]);\n      ext = ol_extent_boundingExtent([\n        this.getMap().getCoordinateFromPixel([p[0]-10, p[1]-10]),\n        this.getMap().getCoordinateFromPixel([p[0]+10, p[1]+10])\n      ]);\n    }\n    geom = ol_geom_Polygon_fromExtent(ext);\n    f = this.bbox_ = new ol_Feature(geom);\n    var features = [];\n    var g = geom.getCoordinates()[0];\n    if (!this.ispt_) {\n      features.push(f);\n      // Middle\n      if (!this.iscircle_ && this.get('stretch') && this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol_Feature( { geometry: new ol_geom_Point([(g[i][0]+g[i+1][0])/2,(g[i][1]+g[i+1][1])/2]), handle:'scale', constraint:i%2?\"h\":\"v\", option:i });\n        features.push(f);\n      }\n      // Handles\n      if (this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol_Feature( { geometry: new ol_geom_Point(g[i]), handle:'scale', option:i });\n        features.push(f);\n      }\n      // Center\n      if (this.get('translate') && !this.get('translateFeature')) {\n        f = new ol_Feature( { geometry: new ol_geom_Point([(g[0][0]+g[2][0])/2, (g[0][1]+g[2][1])/2]), handle:'translate' });\n        features.push(f);\n      }\n    }\n    // Rotate\n    if (!this.iscircle_ && this.get('rotate')) {\n      f = new ol_Feature( { geometry: new ol_geom_Point(g[3]), handle:'rotate' });\n      features.push(f);\n    }\n    // Add sketch\n    this.overlayLayer_.getSource().addFeatures(features);\n  }\n\n};\n\n/** Select a feature to transform\n* @param {ol.Feature} feature the feature to transform\n* @param {boolean} add true to add the feature to the selection, default false\n*/\nol_interaction_Transform.prototype.select = function(feature, add) {\n  if (!feature) {\n    this.selection_.clear();\n    this.drawSketch_();\n    return;\n  }\n  if (!feature.getGeometry || !feature.getGeometry()) return;\n  // Add to selection\n  if (add) {\n    this.selection_.push(feature);\n  } else {\n    this.selection_.clear()\n    this.selection_.push(feature);\n  }\n  this.ispt_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false);\n  this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n  this.drawSketch_();\n  this.watchFeatures_();\n  // select event\n  this.dispatchEvent({ type:'select', feature: feature, features: this.selection_ });\n};\n\n/** Watch selected features\n * @private\n */\nol_interaction_Transform.prototype.watchFeatures_ = function() {\n  // Listen to feature modification\n  if (this._featureListeners) {\n    this._featureListeners.forEach(function (l) {\n      ol_Observable_unByKey(l)\n    });\n  }\n  this._featureListeners = [];\n  this.selection_.forEach(function(f) {\n    this._featureListeners.push(\n      f.on('change', function() {\n        this.drawSketch_();\n      }.bind(this))\n    );\n  }.bind(this));\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol_interaction_Transform.prototype.handleDownEvent_ = function(evt) {\n  var sel = this.getFeatureAtPixel_(evt.pixel);\n  var feature = sel.feature;\n  if (this.selection_.getLength()\n    && this.selection_.getArray().indexOf(feature) >= 0\n    && ((this.ispt_ && this.get('translate')) || this.get('translateFeature'))\n  ){\n    sel.handle = 'translate';\n  }\n  if (sel.handle) {\n    this.mode_ = sel.handle;\n    this.opt_ = sel.option;\n    this.constraint_ = sel.constraint;\n    // Save info\n    this.coordinate_ = evt.coordinate;\n    this.pixel_ = evt.pixel;\n    this.geoms_ = [];\n    var extent = ol_extent_createEmpty();\n    for (var i=0, f; f=this.selection_.item(i); i++) {\n      this.geoms_.push(f.getGeometry().clone());\n      extent = ol_extent_extend(extent, f.getGeometry().getExtent());\n    }\n    this.extent_ = (ol_geom_Polygon_fromExtent(extent)).getCoordinates()[0];\n    if (this.mode_==='rotate') {\n      this.center_ = this.getCenter() || ol_extent_getCenter(extent);\n\n      // we are now rotating (cursor down on rotate mode), so apply the grabbing cursor\n      var element = evt.map.getTargetElement();\n      element.style.cursor = this.Cursors.rotate0;\n      this.previousCursor_ = element.style.cursor;\n    } else {\n      this.center_ = ol_extent_getCenter(extent);\n    }\n    this.angle_ = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n\n    this.dispatchEvent({\n      type: this.mode_+'start',\n      feature: this.selection_.item(0), // backward compatibility\n      features: this.selection_,\n      pixel: evt.pixel,\n      coordinate: evt.coordinate\n    });\n    return true;\n  }\n  else if (this.get('selection')) {\n    if (feature){\n      if (!this.addFn_(evt)) this.selection_.clear();\n      var index = this.selection_.getArray().indexOf(feature);\n      if (index < 0) this.selection_.push(feature);\n      else this.selection_.removeAt(index);\n    } else {\n      this.selection_.clear();\n    }\n    this.ispt_ = this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Point\") : false;\n    this.iscircle_ = (this.selection_.getLength()===1 ? (this.selection_.item(0).getGeometry().getType() == \"Circle\") : false);\n    this.drawSketch_();\n    this.watchFeatures_();\n    this.dispatchEvent({ type:'select', feature: feature, features: this.selection_, pixel: evt.pixel, coordinate: evt.coordinate });\n    return false;\n  }\n};\n\n\n/**\n * Get features to transform\n * @return {ol.Collection<ol.Feature>}\n */\nol_interaction_Transform.prototype.getFeatures = function() {\n  return this.selection_;\n};\n\n/**\n * Get the rotation center\n * @return {ol.coordinates|undefined}\n */\nol_interaction_Transform.prototype.getCenter = function() {\n  return this.get('center');\n};\n\n/**\n * Set the rotation center\n * @param {ol.coordinates|undefined} c the center point, default center on the objet\n */\nol_interaction_Transform.prototype.setCenter = function(c) {\n  return this.set('center', c);\n}\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n */\nol_interaction_Transform.prototype.handleDragEvent_ = function(evt) {\n  var i, f, geometry;\n  switch (this.mode_) {\n    case 'rotate': {\n      var a = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n      if (!this.ispt) {\n        // var geometry = this.geom_.clone();\n        // geometry.rotate(a-this.angle_, this.center_);\n        // this.feature_.setGeometry(geometry);\n        for (i=0, f; f=this.selection_.item(i); i++) {\n          geometry = this.geoms_[i].clone();\n          geometry.rotate(a - this.angle_, this.center_);\n          // bug: ol, bad calculation circle geom extent\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\n          f.setGeometry(geometry);\n        }\n      }\n      this.drawSketch_(true);\n      this.dispatchEvent({\n        type:'rotating',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        angle: a-this.angle_,\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'translate': {\n      var deltaX = evt.coordinate[0] - this.coordinate_[0];\n      var deltaY = evt.coordinate[1] - this.coordinate_[1];\n\n      //this.feature_.getGeometry().translate(deltaX, deltaY);\n      for (i=0, f; f=this.selection_.item(i); i++) {\n        f.getGeometry().translate(deltaX, deltaY);\n      }\n      this.handles_.forEach(function(f) {\n        f.getGeometry().translate(deltaX, deltaY);\n      });\n\n      this.coordinate_ = evt.coordinate;\n      this.dispatchEvent({\n        type:'translating',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        delta:[deltaX,deltaY],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'scale': {\n      var center = this.center_;\n      if (this.get('modifyCenter')(evt)) {\n        center = this.extent_[(Number(this.opt_)+2)%4];\n      }\n\n      var scx = (evt.coordinate[0] - center[0]) / (this.coordinate_[0] - center[0]);\n      var scy = (evt.coordinate[1] - center[1]) / (this.coordinate_[1] - center[1]);\n\n      if (this.get('noFlip')) {\n        if (scx<0) scx=-scx;\n        if (scy<0) scy=-scy;\n      }\n\n      if (this.constraint_) {\n        if (this.constraint_==\"h\") scx=1;\n        else scy=1;\n      } else {\n        if (this.get('keepAspectRatio')(evt)) {\n          scx = scy = Math.min(scx,scy);\n        }\n      }\n\n      for (i=0, f; f=this.selection_.item(i); i++) {\n        geometry = this.geoms_[i].clone();\n        geometry.applyTransform(function(g1, g2, dim) {\n          if (dim<2) return g2;\n\n          for (var j=0; j<g1.length; j+=dim) {\n            if (scx!=1) g2[j] = center[0] + (g1[j]-center[0])*scx;\n            if (scy!=1) g2[j+1] = center[1] + (g1[j+1]-center[1])*scy;\n          }\n          // bug: ol, bad calculation circle geom extent\n          if (geometry.getType() == 'Circle') geometry.setCenterAndRadius(geometry.getCenter(), geometry.getRadius());\n          return g2;\n        });\n        f.setGeometry(geometry);\n      }\n      this.drawSketch_();\n      this.dispatchEvent({\n        type:'scaling',\n        feature: this.selection_.item(0),\n        features: this.selection_,\n        scale:[scx,scy],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    default: break;\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol_interaction_Transform.prototype.handleMoveEvent_ = function(evt) {\n  // console.log(\"handleMoveEvent\");\n  if (!this.mode_) {\n    var sel = this.getFeatureAtPixel_(evt.pixel);\n    var element = evt.map.getTargetElement();\n    if (sel.feature)\n    {\tvar c = sel.handle ? this.Cursors[(sel.handle||'default')+(sel.constraint||'')+(sel.option||'')] : this.Cursors.select;\n\n      if (this.previousCursor_===undefined)\n      {\tthis.previousCursor_ = element.style.cursor;\n      }\n      element.style.cursor = c;\n    }\n    else\n    {\tif (this.previousCursor_!==undefined) element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol_interaction_Transform.prototype.handleUpEvent_ = function(evt) {\n  // remove rotate0 cursor on Up event, otherwise it's stuck on grab/grabbing\n  if (this.mode_ === 'rotate') {\n    var element = evt.map.getTargetElement();\n    element.style.cursor = this.Cursors.default;\n    this.previousCursor_ = undefined;\n  }\n\n  //dispatchEvent\n  this.dispatchEvent({\n    type:this.mode_+'end',\n    feature: this.selection_.item(0),\n    features: this.selection_,\n    oldgeom: this.geoms_[0],\n    oldgeoms: this.geoms_\n  });\n\n  this.drawSketch_();\n  this.mode_ = null;\n  return false;\n};\n\nexport default ol_interaction_Transform\n","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Pointer from 'ol/interaction/Pointer'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_style_Circle from 'ol/style/Circle'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_Feature from 'ol/Feature'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport {ol_coordinate_dist2d, ol_coordinate_equal} from \"../geom/GeomUtils\";\nimport {boundingExtent as ol_extent_boundingExtent} from 'ol/extent'\nimport {buffer as ol_extent_buffer} from 'ol/extent'\nimport {altKeyOnly as ol_events_condition_altKeyOnly} from 'ol/events/condition'\nimport {primaryAction as ol_events_condition_primaryAction} from 'ol/events/condition'\nimport {always as ol_events_condition_always} from 'ol/events/condition'\n\nimport '../geom/LineStringSplitAt'\n\n/** Interaction for modifying feature geometries. Similar to the core ol/interaction/Modify.\n * The interaction is more suitable to use to handle feature modification: only features concerned \n * by the modification are passed to the events (instead of all feature with ol/interaction/Modify)\n * - the modifystart event is fired before the feature is modified (no points still inserted)\n * - the modifyend event is fired after the modification\n * - it fires a modifying event\n * @constructor\n * @extends {ol_interaction_Pointer}\n * @fires modifystart\n * @fires modifying\n * @fires modifyend\n * @param {*} options\n *\t@param {ol.source.Vector|Array{ol.source.Vector}} options.source a list of source to modify (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to modify\n *  @param {integer} options.pixelTolerance Pixel tolerance for considering the pointer close enough to a segment or vertex for editing. Default is 10.\n *  @param {function|undefined} options.filter a filter that takes a feature and return true if it can be modified, default always true.\n *  @param {ol.style.Style | Array<ol.style.Style> | undefined} options.style Style for the sketch features.\n *  @param {ol.EventsConditionType | undefined} options.condition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event will be considered to add or move a vertex to the sketch. Default is ol.events.condition.primaryAction.\n *  @param {ol.EventsConditionType | undefined} options.deleteCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. By default, ol.events.condition.singleClick with ol.events.condition.altKeyOnly results in a vertex deletion.\n *  @param {ol.EventsConditionType | undefined} options.insertVertexCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether a new vertex can be added to the sketch features. Default is ol.events.condition.always\n */\nvar ol_interaction_ModifyFeature = function(options){\n  if (!options) options = {};\n\n  var dragging, modifying;\n  ol_interaction_Pointer.call(this,{\n    /*\n    handleDownEvent: this.handleDownEvent,\n    handleDragEvent: this.handleDragEvent,\n    handleMoveEvent: this.handleMoveEvent,\n    handleUpEvent: this.handleUpEvent,\n    */\n    handleEvent: function(e) {\n      switch(e.type) {\n        case 'pointerdown': {\n          dragging = this.handleDownEvent(e);\n          modifying = dragging || this._deleteCondition(e);\n          return !dragging;\n        }\n        case 'pointerup': {\n          dragging = false;\n          return this.handleUpEvent(e);\n        }\n        case 'pointerdrag': {\n          if (dragging) return this.handleDragEvent(e);\n          else return true;\n        }\n        case 'pointermove': {\n          if (!dragging) return this.handleMoveEvent(e);\n          else return true;\n        }\n        case 'singleclick':\n        case 'click': {\n          // Prevent click when modifying\n          return !modifying;\n        }\n        default: return true;\n      }\n    }\n  });\n\n  // Snap distance (in px)\n  this.snapDistance_ = options.pixelTolerance || 10;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n\n  if (options.features) {\n    this.sources_.push (new ol_source_Vector({ features: options.features }));\n  }\n\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n\n  this._condition = options.condition || ol_events_condition_primaryAction;\n  this._deleteCondition = options.deleteCondition || ol_events_condition_altKeyOnly;\n  this._insertVertexCondition = options.insertVertexCondition || ol_events_condition_always;\n\n  // Default style\n  var sketchStyle = function() {\n    return [ new ol_style_Style({\n        image: new ol_style_Circle({\n          radius: 6,\n          fill: new ol_style_Fill({ color: [0, 153, 255, 1] }),\n          stroke: new ol_style_Stroke({ color: '#FFF', width: 1.25 })\n        })\n      })\n    ];\n  }\n\n  // Custom style\n  if (options.style) {\n    if (typeof(options.style) === 'function') {\n      sketchStyle = options.style\n     } else {\n       sketchStyle = function() { return options.style; }\n     }\n  }\n\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      useSpatialIndex: false\n    }),\n    name:'Modify overlay',\n    displayInLayerSwitcher: false,\n    style: sketchStyle\n  });\n\n};\nol_ext_inherits(ol_interaction_ModifyFeature, ol_interaction_Pointer);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_ModifyFeature.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n\n/**\n * Activate or deactivate the interaction + remove the sketch.\n * @param {boolean} active.\n * @api stable\n */\nol_interaction_ModifyFeature.prototype.setActive = function(active) {\n  ol_interaction_Interaction.prototype.setActive.call (this, active);\n  if (this.overlayLayer_) this.overlayLayer_.getSource().clear();\n};\n\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {*} \n * @private\n */\nol_interaction_ModifyFeature.prototype.getClosestFeature = function(e) {\n  var f, c, d = this.snapDistance_+1;\n  for (var i=0; i<this.sources_.length; i++) {\n    var source = this.sources_[i];\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\n    if (f && this.filterSplit_(f)) {\n      var ci = f.getGeometry().getClosestPoint(e.coordinate);\n      var di = ol_coordinate_dist2d(e.coordinate,ci) / e.frameState.viewState.resolution;\n      if (di < d){\n        d = di;\n        c = ci;\n      }\n      break;\n    }\n  }\n  if (d > this.snapDistance_) {\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry());\n    if (coord) {\n      coord = coord.coord;\n      var p = this.getMap().getPixelFromCoordinate(coord);\n      if (ol_coordinate_dist2d(e.pixel, p) < this.snapDistance_) {\n        c = coord;\n      }\n      //\n      return { source:source, feature:f, coord: c };\n    }\n  }\n}\n\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {ol.geom} coords list of coordinates\n* @return {*} the nearest point with a coord (projected point), dist (distance to the geom), ring (if Polygon)\n*/\nol_interaction_ModifyFeature.prototype.getNearestCoord = function(pt, geom) {\n  var i, l, p, p0, dm;\n  switch (geom.getType()) {\n    case 'Point': {\n      return { coord: geom.getCoordinates(), dist: ol_coordinate_dist2d(geom.getCoordinates(), pt) };\n    }\n    case 'MultiPoint': {\n      return this.getNearestCoord (pt, new ol_geom_LineString(geom.getCoordinates()));\n    }\n    case 'LineString':\n    case 'LinearRing': {\n      var d;\n      dm = Number.MAX_VALUE;\n      var coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        d = ol_coordinate_dist2d (pt, coords[i]);\n        if (d < dm) {\n          dm = d;\n          p0 = coords[i];\n        }\n      }\n      return { coord: p0, dist: dm };\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      p0 = false, dm = Number.MAX_VALUE;\n      for (i=0; l=lstring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=lring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=poly[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.poly = i;\n        }\n      }\n      return p0;\n    }\n    case 'GeometryCollection': {\n      var g = geom.getGeometries();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=g[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.geom = i;\n        }\n      }\n      return p0;\n    }\n    default: return false;\n  }\n};\n\n/** Get arcs concerned by a modification \n * @param {ol.geom} geom the geometry concerned\n * @param {ol.coordinate} coord pointed coordinates\n */\nol_interaction_ModifyFeature.prototype.getArcs = function(geom, coord) {\n  var arcs = false;\n  var coords, i, s, l;\n  switch(geom.getType()) {\n    case 'Point': {\n      if (ol_coordinate_equal(coord, geom.getCoordinates())) {\n        arcs = { \n          geom: geom, \n          type: geom.getType(),\n          coord1: [],\n          coord2: [],\n          node: true\n        }\n      }\n      break;\n    }\n    case 'MultiPoint': {\n      coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        if (ol_coordinate_equal(coord, coords[i])) {\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            index: i,\n            coord1: [],\n            coord2: [],\n            node: true\n          }\n          break;\n        }\n      }\n      break;\n    }\n    case 'LinearRing': \n    case 'LineString': {\n      var p = geom.getClosestPoint(coord);\n      if (ol_coordinate_dist2d(p,coord) < 1.5*this.tolerance_) {\n        var split;\n        // Split the line in two\n        if (geom.getType() === 'LinearRing') {\n          var g = new ol_geom_LineString(geom.getCoordinates());\n          split = g.splitAt(coord, this.tolerance_);\n        } else {\n          split = geom.splitAt(coord, this.tolerance_);\n        }\n        // If more than 2\n        if (split.length>2) {\n          coords = split[1].getCoordinates();\n          for (i=2; s=split[i]; i++) {\n            var c = s.getCoordinates();\n            c.shift();\n            coords = coords.concat(c);\n          }\n          split = [ split[0], new ol_geom_LineString(coords) ];\n        }\n        // Split in two\n        if (split.length === 2) {\n          var c0 = split[0].getCoordinates();\n          var c1 = split[1].getCoordinates();\n          var nbpt = c0.length + c1.length -1;\n          c0.pop();\n          c1.shift();\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            coord1: c0, \n            coord2: c1,\n            node: (geom.getCoordinates().length === nbpt),\n            closed: false\n          }\n        } else if (split.length === 1) {\n          s = split[0].getCoordinates();\n          var start = ol_coordinate_equal(s[0], coord);\n          var end = ol_coordinate_equal(s[s.length-1], coord);\n          // Move first point\n          if (start) {\n            s.shift();\n            if (end) s.pop();\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: [], \n              coord2: s,\n              node: true,\n              closed: end\n            }\n          } else if (end) {\n            // Move last point\n            s.pop()\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: s, \n              coord2: [],\n              node: true,\n              closed: false\n            }\n          }\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      for (i=0; l=lstring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.lstring = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      for (i=0; l=lring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.index = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      for (i=0; l=poly[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.poly = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'GeometryCollection': {\n      for (i=0; l=g[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.g = i;\n          arcs.typeg = arcs.type;\n          arcs.type = geom.getType();\n          break;\n        }\n      }\n      break;\n    }\n    default: {\n      console.error('ol/interaction/ModifyFeature '+geom.getType()+' not supported!');\n      break;\n    }\n  }\n  return arcs;\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol_interaction_ModifyFeature.prototype.handleDownEvent = function(evt) {\n  if (!this.getActive()) return false;\n\n  // Something to split ?\n  var current = this.getClosestFeature(evt);\n\n  if (current && (this._condition(evt) || this._deleteCondition(evt))) {\n    var features = [];\n    this.arcs = [];\n\n    // Get features concerned\n    this.sources_.forEach(function(s) {\n      var extent = ol_extent_buffer (ol_extent_boundingExtent([current.coord]), this.tolerance_);\n      features = features.concat(features, s.getFeaturesInExtent(extent));\n    }.bind(this));\n\n    // Get arcs concerned\n    this._modifiedFeatures = [];\n    features.forEach(function(f) {\n      var a = this.getArcs(f.getGeometry(), current.coord);\n      if (a) {\n        if (this._insertVertexCondition(evt) || a.node) {\n          a.feature = f;\n          this._modifiedFeatures.push(f);\n          this.arcs.push(a);\n        }\n      }\n    }.bind(this));\n\n    if (this._modifiedFeatures.length) {\n      if (this._deleteCondition(evt)) {\n        return !this._removePoint(current, evt); \n      } else {\n        this.dispatchEvent({ \n          type:'modifystart', \n          coordinate: current.coord,\n          originalEvent: evt.originalEvent,\n          features: this._modifiedFeatures\n        });\n        this.handleDragEvent({ coordinate: current.coord })\n        return true;\n      }\n    } else {\n      return true;\n    }\n  } else {\n    return false;\n  }\n};\n\n/** Get modified features\n * @return {Array<ol.Feature>} list of modified features\n */\nol_interaction_ModifyFeature.prototype.getModifiedFeatures = function() {\n  return this._modifiedFeatures || [];\n};\n\n/** Removes the vertex currently being pointed.\n */\nol_interaction_ModifyFeature.prototype.removePoint = function() {\n  this._removePoint({},{});\n};\n\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype._getModification = function(a) {\n  var coords = a.coord1.concat(a.coord2);\n  switch (a.type) {\n    case 'LineString': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>1) {\n        if (a.geom.getCoordinates().length != coords.length) {\n          a.coords = coords;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>1) {\n        var c = a.geom.getCoordinates();\n        if (c[a.lstring].length != coords.length) {\n          c[a.lstring] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>3) {\n        c = a.geom.getCoordinates();\n        if (c[a.index].length != coords.length) {\n          c[a.index] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      if (a.closed) coords.push(coords[0]);\n      if (coords.length>3) {\n        c = a.geom.getCoordinates();\n        if (c[a.poly][a.index].length != coords.length) {\n          c[a.poly][a.index] = coords;\n          a.coords = c;\n          return true;\n        }\n      }\n      break;\n    }\n    case 'GeometryCollection': {\n      a.type = a.typeg;\n      var geom = a.geom;\n      var geoms = geom.getGeometries();\n      a.geom = geoms[a.g];\n      var found = this._getModification(a);\n      // Restore current arc\n      geom.setGeometries(geoms);\n      a.geom = geom;\n      a.type = 'GeometryCollection';\n      return found;\n    }\n    default: {\n      //console.error('ol/interaction/ModifyFeature '+a.type+' not supported!');\n      break;\n    }\n  }\n  return false;\n};\n\n/** Removes the vertex currently being pointed.\n * @private\n */\nol_interaction_ModifyFeature.prototype._removePoint = function(current, evt) {\n  if (!this.arcs) return false;\n\n  this.overlayLayer_.getSource().clear();\n\n  var found = false;\n  // Get all modifications\n  this.arcs.forEach(function(a) {\n    found = found || this._getModification(a);\n  }.bind(this));\n\n  // Almost one point is removed\n  if (found) {\n    this.dispatchEvent({ \n      type:'modifystart', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n    this.arcs.forEach(function(a) {\n      if (a.geom.getType() === 'GeometryCollection') {\n        if (a.coords) {\n          var geoms = a.geom.getGeometries();\n          geoms[a.g].setCoordinates(a.coords);\n          a.geom.setGeometries(geoms);\n        }\n      } else {\n        if (a.coords) a.geom.setCoordinates(a.coords);\n      }\n    }.bind(this));\n    this.dispatchEvent({ \n      type:'modifyend', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n  }\n\n  this.arcs = [];\n  return found;\n};\n\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype.handleUpEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs || !this.arcs.length) return true;\n\n  this.overlayLayer_.getSource().clear();\n  this.dispatchEvent({ \n    type:'modifyend', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n\n  return true;\n};\n\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype.setArcCoordinates = function(a, coords) {\n  var c;\n  switch (a.type) {\n    case 'Point': {\n      a.geom.setCoordinates(coords[0]);\n      break;\n    }\n    case 'MultiPoint': {\n      c = a.geom.getCoordinates();\n      c[a.index] = coords[0];\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'LineString': {\n      a.geom.setCoordinates(coords);\n      break;\n    }\n    case 'MultiLineString': {\n      c = a.geom.getCoordinates();\n      c[a.lstring] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'Polygon': {\n      c = a.geom.getCoordinates();\n      c[a.index] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'MultiPolygon': {\n      c = a.geom.getCoordinates();\n      c[a.poly][a.index] = coords;\n      a.geom.setCoordinates(c);\n      break;\n    }\n    case 'GeometryCollection': {\n      a.type = a.typeg;\n      var geom = a.geom;\n      var geoms = geom.getGeometries();\n      a.geom = geoms[a.g];\n      this.setArcCoordinates(a, coords);\n      geom.setGeometries(geoms);\n      a.geom = geom;\n      a.type = 'GeometryCollection';\n      break;\n    }\n  }\n};\n/**\n * @private\n */\nol_interaction_ModifyFeature.prototype.handleDragEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs) return true;\n\n  // Show sketch\n  this.overlayLayer_.getSource().clear();\n  var p = new ol_Feature(new ol_geom_Point(e.coordinate));\n  this.overlayLayer_.getSource().addFeature(p);\n\n  // Nothing to do\n  if (!this.arcs.length) return true;\n\n  // Move arcs\n  this.arcs.forEach(function(a) {\n    var coords = a.coord1.concat([e.coordinate], a.coord2);\n    if (a.closed) coords.push(e.coordinate);\n    this.setArcCoordinates(a, coords);\n  }.bind(this));\n\n  this.dispatchEvent({ \n    type:'modifying', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n\n  return true;\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nol_interaction_ModifyFeature.prototype.handleMoveEvent = function(e) {\n  if (!this.getActive()) return false;\n\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n\n  // Draw sketch\n  if (current) {\n    var p = new ol_Feature(new ol_geom_Point(current.coord));\n    this.overlayLayer_.getSource().addFeature(p);\n  }\n\n  // Show cursor\n  var element = e.map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\nexport default ol_interaction_ModifyFeature","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport ol_style_Style from 'ol/style/Style'\nimport ol_style_Circle from 'ol/style/Circle'\nimport ol_style_Stroke from 'ol/style/Stroke'\nimport ol_style_Fill from 'ol/style/Fill'\nimport ol_Collection from 'ol/Collection'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport ol_source_Vector from 'ol/source/Vector'\nimport ol_geom_Circle from 'ol/geom/Circle'\nimport {fromCircle as ol_geom_Polygon_fromCircle} from 'ol/geom/Polygon'\nimport ol_geom_Point from 'ol/geom/Point'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport ol_Feature from 'ol/Feature'\n\n/** Interaction rotate\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires drawstart, drawing, drawend, drawcancel\n * @param {olx.interaction.TransformOptions} options\n *  @param {Array<ol.Layer>} source Destination source for the drawn features\n *  @param {ol.Collection<ol.Feature>} features Destination collection for the drawn features \n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\n *  @param {integer} sides number of sides, default 0 = circle\n *  @param { ol.events.ConditionType | undefined } squareCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw square features.\n *  @param { ol.events.ConditionType | undefined } centerCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw centered features.\n *  @param { bool } canRotate Allow rotation when centered + square, default: true\n *  @param { number } clickTolerance click tolerance on touch devices, default: 6\n *  @param { number } maxCircleCoordinates Maximum number of point on a circle, default: 100\n */\nvar ol_interaction_DrawRegular = function(options) {\n  if (!options) options={};\n\n  this.squaredClickTolerance_ = options.clickTolerance ? options.clickTolerance * options.clickTolerance : 36;\n  this.maxCircleCoordinates_ = options.maxCircleCoordinates || 100;\n\n  // Collection of feature to transform \n  this.features_ = options.features;\n  // List of layers to transform \n  this.source_ = options.source;\n  // Square condition\n  this.squareFn_ = options.squareCondition;\n  // Centered condition\n  this.centeredFn_ = options.centerCondition;\n  // Allow rotation when centered + square\n  this.canRotate_ = (options.canRotate !== false);\n  // Specify custom geometry name\n  this.geometryName_ = options.geometryName\n\n  // Number of sides (default=0: circle)\n  this.setSides(options.sides);\n\n  // Style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var defaultStyle = [\n    new ol_style_Style({\n      stroke: new ol_style_Stroke({ color: white, width: width + 2 })\n    }),\n    new ol_style_Style({\n      image: new ol_style_Circle({\n        radius: width * 2,\n        fill: new ol_style_Fill({ color: blue }),\n        stroke: new ol_style_Stroke({ color: white, width: width / 2 })\n      }),\n      stroke: new ol_style_Stroke({ color: blue, width: width }),\n      fill: new ol_style_Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n\n  // Create a new overlay layer for the sketch\n  this.sketch_ = new ol_Collection();\n  this.overlayLayer_ = new ol_layer_Vector({\n    source: new ol_source_Vector({\n      features: this.sketch_,\n      useSpatialIndex: false\n    }),\n    name:'DrawRegular overlay',\n    displayInLayerSwitcher: false,\n    style: options.style || defaultStyle\n  });\n\n  ol_interaction_Interaction.call(this, {\t\n      /*\n      handleDownEvent: this.handleDownEvent_,\n      handleMoveEvent: this.handleMoveEvent_,\n      handleUpEvent: this.handleUpEvent_,\n      */\n      handleEvent: this.handleEvent_\n    });\n};\nol_ext_inherits(ol_interaction_DrawRegular, ol_interaction_Interaction);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_DrawRegular.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol_interaction_DrawRegular.prototype.setActive = function(b) {\n  this.reset();\n  ol_interaction_Interaction.prototype.setActive.call (this, b);\n}\n\n/**\n * Reset the interaction\n * @api stable\n */\nol_interaction_DrawRegular.prototype.reset = function() {\n  this.overlayLayer_.getSource().clear();\n  this.started_ = false;\n}\n\n/**\n * Set the number of sides.\n * @param {int} number of sides.\n * @api stable\n */\nol_interaction_DrawRegular.prototype.setSides = function (nb) {\n  nb = parseInt(nb);\n  this.sides_ = nb>2 ? nb : 0;\n}\n\n/**\n * Allow rotation when centered + square\n * @param {bool} \n * @api stable\n */\nol_interaction_DrawRegular.prototype.canRotate = function (b) {\n  if (b===true || b===false) this.canRotate_ = b;\n  return this.canRotate_;\n}\n\n/**\n * Get the number of sides.\n * @return {int} number of sides.\n * @api stable\n */\nol_interaction_DrawRegular.prototype.getSides = function () {\n  return this.sides_;\n}\n\n/** Default start angle array for each sides\n*/\nol_interaction_DrawRegular.prototype.startAngle = {\n  'default':Math.PI/2,\n  3: -Math.PI/2,\n  4: Math.PI/4\n};\n\n/** Get geom of the current drawing\n* @return {ol.geom.Polygon | ol.geom.Point}\n*/\nol_interaction_DrawRegular.prototype.getGeom_ = function () {\n  this.overlayLayer_.getSource().clear();\n  if (!this.center_) return false;\n\n  var g;\n  if (this.coord_) {\n    var center = this.center_;\n    var coord = this.coord_;\n\n    // Specific case: circle\n    var d, dmax, r, circle, centerPx;\n    if (!this.sides_ && this.square_ && !this.centered_) {\n      center = [(coord[0] + center[0])/2, (coord[1] + center[1])/2];\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      circle = new ol_geom_Circle(center, r, 'XY');\n      // Optimize points on the circle\n      centerPx = this.getMap().getPixelFromCoordinate(center);\n      dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n      dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / 3 ));\n      return ol_geom_Polygon_fromCircle (circle, dmax, 0);\n    } else {\n      var hasrotation = this.canRotate_ && this.centered_ && this.square_;\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      if (this.square_ && !hasrotation) {\n        //var d = [coord[0] - center[0], coord[1] - center[1]];\n        var dm = Math.max (Math.abs(d[0]), Math.abs(d[1])); \n        coord = [ \n          center[0] + (d[0]>0 ? dm:-dm),\n          center[1] + (d[1]>0 ? dm:-dm)\n        ];\n      }\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      if (r>0) {\n        circle = new ol_geom_Circle(center, r, 'XY');\n        var a;\n        if (hasrotation) a = Math.atan2(d[1], d[0]);\n        else a = this.startAngle[this.sides_] || this.startAngle['default'];\n\n        if (this.sides_) {\n          g = ol_geom_Polygon_fromCircle (circle, this.sides_, a);\n        } else {\n          // Optimize points on the circle\n          centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n          dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n          dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / (this.centered_ ? 3:5) ));\n          g = ol_geom_Polygon_fromCircle (circle, dmax, 0);\n        }\n\n        if (hasrotation) return g;\n      \n        // Scale polygon to fit extent\n        var ext = g.getExtent();\n        if (!this.centered_) center = this.center_;\n        else center = [ 2*this.center_[0]-this.coord_[0], 2*this.center_[1]-this.coord_[1] ];\n        var scx = (center[0] - coord[0]) / (ext[0] - ext[2]);\n        var scy = (center[1] - coord[1]) / (ext[1] - ext[3]);\n        if (this.square_) {\n          var sc = Math.min(Math.abs(scx),Math.abs(scy));\n          scx = Math.sign(scx)*sc;\n          scy = Math.sign(scy)*sc;\n        }\n        var t = [ center[0] - ext[0]*scx, center[1] - ext[1]*scy ];\n      \n        g.applyTransform(function(g1, g2, dim) {\n          for (var i=0; i<g1.length; i+=dim) {\n            g2[i] = g1[i]*scx + t[0];\n            g2[i+1] = g1[i+1]*scy + t[1];\n          }\n          return g2;\n        });\n        return g;\n      }\n    }\n  }\n\n  // No geom => return a point\n  return new ol_geom_Point(this.center_);\n};\n\n/** Draw sketch\n* @return {ol.Feature} The feature being drawn.\n*/\nol_interaction_DrawRegular.prototype.drawSketch_ = function(evt) {\n  this.overlayLayer_.getSource().clear();\n  if (evt) {\n    this.square_ = this.squareFn_ ? this.squareFn_(evt) : evt.originalEvent.shiftKey;\n    this.centered_ = this.centeredFn_ ? this.centeredFn_(evt) : evt.originalEvent.metaKey || evt.originalEvent.ctrlKey;\n    var g = this.getGeom_();\n    if (g) {\n      var f = this.feature_;\n      if (this.geometryName_) f.setGeometryName(this.geometryName_)\n\n      //f.setGeometry (g);\n      if (g.getType()==='Polygon') f.getGeometry().setCoordinates(g.getCoordinates());\n      this.overlayLayer_.getSource().addFeature(f);\n      if (this.coord_ \n        && this.square_ \n        && ((this.canRotate_ && this.centered_ && this.coord_) || (!this.sides_ && !this.centered_))) {\n        this.overlayLayer_.getSource().addFeature(new ol_Feature(new ol_geom_LineString([this.center_,this.coord_])));\n      }\n      return f;\n    }\n  }\n};\n\n/** Draw sketch (Point)\n*/\nol_interaction_DrawRegular.prototype.drawPoint_ = function(pt, noclear) {\n  if (!noclear) this.overlayLayer_.getSource().clear();\n  this.overlayLayer_.getSource().addFeature(new ol_Feature(new ol_geom_Point(pt)));\n};\n\n\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n */\nol_interaction_DrawRegular.prototype.handleEvent_ = function(evt) {\n  var dx, dy;\n  // Event date time\n  this._eventTime = new Date();\n  switch (evt.type) {\n    case \"pointerdown\": {\n      this.downPx_ = evt.pixel;\n      this.start_(evt);\n      // Test long touch\n      var dt = 500;\n      this._longTouch = false;\n      setTimeout(function() {\n        this._longTouch = (new Date() - this._eventTime > .9*dt);\n        if (this._longTouch) this.handleMoveEvent_(evt);\n      }.bind(this), dt);\n      break;\n    }\n    case \"pointerup\": {\n      // Started and fisrt move\n      if (this.started_ && this.coord_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          // The pointer has moved\n          if ( this.lastEvent == \"pointermove\" || this.lastEvent == \"keydown\" ) {\n            this.end_(evt);\n          }\n          // On touch device there is no move event : terminate = click on the same point\n          else {\n            dx = this.upPx_[0] - evt.pixel[0];\n            dy = this.upPx_[1] - evt.pixel[1];\n            if ( dx*dx + dy*dy <= this.squaredClickTolerance_) {\n              this.end_(evt);\n            } else  {\n              this.handleMoveEvent_(evt);\n              this.drawPoint_(evt.coordinate,true);\n            }\n          }\n        }\n      }\n      this.upPx_ = evt.pixel;\t\n      break;\n    }\n    case \"pointerdrag\": {\n      if (this.started_) {\n        var centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n        dx = centerPx[0] - evt.pixel[0];\n        dy = centerPx[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          this.reset();\n        }\n      }\n      return !this._longTouch;\n      // break;\n    }\n    case \"pointermove\": {\n      if (this.started_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy > this.squaredClickTolerance_) {\n          this.handleMoveEvent_(evt);\n          this.lastEvent = evt.type;\n        }\n      }\n      break;\n    }\n    default: {\n      this.lastEvent = evt.type;\n      // Prevent zoom in on dblclick\n      if (this.started_ && evt.type==='dblclick') {\n        //evt.stopPropagation();\n        return false;\n      }\n      break;\n    }\n  }\n  return true;\n}\n\n/** Stop drawing.\n */\nol_interaction_DrawRegular.prototype.finishDrawing = function() {\n  if (this.started_ && this.coord_) {\n    this.end_({ pixel: this.upPx_, coordinate: this.coord_});\n  }\n};\n\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol_interaction_DrawRegular.prototype.handleMoveEvent_ = function(evt) {\n  if (this.started_) {\n    this.coord_ = evt.coordinate;\n    this.coordPx_ = evt.pixel;\n    var f = this.drawSketch_(evt);\n    this.dispatchEvent({ \n      type:'drawing', \n      feature: f, \n      pixel: evt.pixel, \n      startCoordinate: this.center_,\n      coordinate: evt.coordinate, \n      square: this.square_, \n      centered: this.centered_ \n    });\n  } else  {\n    this.drawPoint_(evt.coordinate);\n  }\n};\n\n/** Start an new draw\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol_interaction_DrawRegular.prototype.start_ = function(evt) {\n  if (!this.started_) {\n    this.started_ = true;\n    this.center_ = evt.coordinate;\n    this.coord_ = null;\n    var geom = new ol_geom_Polygon([[evt.coordinate,evt.coordinate,evt.coordinate]]);\n    var f = this.feature_ = new ol_Feature(geom);\n    this.drawSketch_(evt);\n    this.dispatchEvent({ type:'drawstart', feature: f, pixel: evt.pixel, coordinate: evt.coordinate });\n  } else {\n    this.coord_ = evt.coordinate;\n  }\n};\n\n/** End drawing\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol_interaction_DrawRegular.prototype.end_ = function(evt) {\n  this.coord_ = evt.coordinate;\n  this.started_ = false;\n  // Add new feature\n  if (this.coord_ && this.center_[0]!=this.coord_[0] && this.center_[1]!=this.coord_[1]) {\n    var f = this.feature_;\n    if (this.geometryName_) f.setGeometryName(this.geometryName_)\n\n    f.setGeometry(this.getGeom_());\n    if (this.source_) this.source_.addFeature(f);\n    else if (this.features_) this.features_.push(f);\n    this.dispatchEvent({ type:'drawend', feature: f, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  } else {\n    this.dispatchEvent({ type:'drawcancel', feature: null, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  }\n\n  this.center_ = this.coord_ = null;\n  this.drawSketch_();\n};\n\nexport default ol_interaction_DrawRegular\n","/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\nimport ol_interaction_Draw from 'ol/interaction/Draw'\nimport ol_interaction_Select from 'ol/interaction/Select'\n\n/** Interaction to draw holes in a polygon.\n * It fires a drawstart, drawend event when drawing the hole\n * and a modifystart, modifyend event before and after inserting the hole in the feature geometry.\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires drawstart\n * @fires drawend\n * @fires modifystart\n * @fires modifyend\n * @param {olx.interaction.DrawHoleOptions} options extend olx.interaction.DrawOptions\n * \t@param {Array<ol.layer.Vector> | function | undefined} options.layers A list of layers from which polygons should be selected. Alternatively, a filter function can be provided. default: all visible layers\n * \t@param { ol.style.Style | Array<ol.style.Style> | StyleFunction | undefined }\tStyle for the selected features, default: default edit style\n */\nvar ol_interaction_DrawHole = function(options) {\n  if (!options) options = {};\n  var self = this;\n\n  // Select interaction for the current feature\n  this._select = new ol_interaction_Select({ style: options.style });\n  this._select.setActive(false);\n\n  // Geometry function that test points inside the current\n  var geometryFn, geomFn = options.geometryFunction;\n  if (geomFn) {\n    geometryFn = function(c,g) {\n      g = self._geometryFn (c, g);\n      return geomFn (c,g);\n    }\n  } else {\n    geometryFn = function(c,g) { return self._geometryFn (c, g); }\n  }\n\n  // Create draw interaction\n  options.type = \"Polygon\";\n  options.geometryFunction = geometryFn;\n  ol_interaction_Draw.call(this, options);\n\n  // Layer filter function\n  if (options.layers) {\n    if (typeof (options.layers) === 'function') {\n      this.layers_ = options.layers;\n    } else if (options.layers.indexOf) {\n      this.layers_ = function(l) {\n        return (options.layers.indexOf(l) >= 0); \n      };\n    }\n  }\n\n  // Start drawing if inside a feature\n  this.on('drawstart', this._startDrawing.bind(this));\n  // End drawing add the hole to the current Polygon\n  this.on('drawend', this._finishDrawing.bind(this));\n};\nol_ext_inherits(ol_interaction_DrawHole, ol_interaction_Draw);\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_DrawHole.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeInteraction(this._select);\n  if (map) map.addInteraction(this._select);\n  ol_interaction_Draw.prototype.setMap.call (this, map);\n};\n\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol_interaction_DrawHole.prototype.setActive = function(b) {\n  this._select.getFeatures().clear();\n  ol_interaction_Draw.prototype.setActive.call (this, b);\n};\n\n/**\n * Remove last point of the feature currently being drawn \n * (test if points to remove before).\n */\nol_interaction_DrawHole.prototype.removeLastPoint = function() {\n  if (this._feature && this._feature.getGeometry().getCoordinates()[0].length>2) {\n    ol_interaction_Draw.prototype.removeLastPoint.call(this);\n  }\n};\n\n/** \n * Get the current polygon to hole\n * @return {ol.Feature}\n */\nol_interaction_DrawHole.prototype.getPolygon = function() {\n  return this._polygon;\n  // return this._select.getFeatures().item(0).getGeometry();\n};\n\n/**\n * Get current feature to add a hole and start drawing\n * @param {ol_interaction_Draw.Event} e\n * @private\n */\nol_interaction_DrawHole.prototype._startDrawing = function(e) {\n  var map = this.getMap();\n  var layersFilter = this.layers_;\n  this._feature = e.feature;\n  var coord = e.feature.getGeometry().getCoordinates()[0][0];\n  // Check object under the pointer\n  var features = map.getFeaturesAtPixel(\n    map.getPixelFromCoordinate(coord), {\n      layerFilter: layersFilter\n    }\n  );\n  this._current = null;\n  if (features) {\n    for (var k=0; k<features.length; k++) {\n      var poly = features[k].getGeometry();\n      if (poly.getType() === \"Polygon\"\n        && poly.intersectsCoordinate(coord)) {\n        this._polygonIndex = false;\n        this._polygon = poly;\n        this._current = features[k];\n      }\n      else if (poly.getType() === \"MultiPolygon\"\n        && poly.intersectsCoordinate(coord)) {\n        for (var i=0, p; p=poly.getPolygon(i); i++) {\n          if (p.intersectsCoordinate(coord)) {\n            this._polygonIndex = i;\n            this._polygon = p;\n            this._current = features[k];\n            break;\n          }\n        }\n      }\n      if (this._current) break;\n    }\n  }\n  this._select.getFeatures().clear();\n  if (!this._current) {\n    this.setActive(false);\n    this.setActive(true);\n  } else {\n    this._select.getFeatures().push(this._current);\n  }\n};\n\n/**\n * Stop drawing and add the sketch feature to the target feature. \n * @param {ol_interaction_Draw.Event} e\n * @private\n */\nol_interaction_DrawHole.prototype._finishDrawing = function(e) {\n  // The feature is the hole\n  e.hole = e.feature;\n  // Get the current feature\n  e.feature = this._select.getFeatures().item(0);\n  this.dispatchEvent({ type: 'modifystart', features: [ this._current ] });\n  // Create the hole\n  var c = e.hole.getGeometry().getCoordinates()[0];\n  if (c.length > 3) {\n    if (this._polygonIndex!==false) {\n      var geom = e.feature.getGeometry();\n      var newGeom = new ol_geom_MultiPolygon([]);\n      for (var i=0, pi; pi=geom.getPolygon(i); i++) {\n        if (i===this._polygonIndex) {\n          pi.appendLinearRing(new ol_geom_LinearRing(c));\n          newGeom.appendPolygon(pi);\n        } else {\n          newGeom.appendPolygon(pi);\n        }\n      }\n      e.feature.setGeometry(newGeom);\n    } else {\n      this.getPolygon().appendLinearRing(new ol_geom_LinearRing(c));\n    }\n  }\n  this.dispatchEvent({ type: 'modifyend', features: [ this._current ] });\n  // reset\n  this._feature = null;\n  this._select.getFeatures().clear();\n};\n\n/**\n * Function that is called when a geometry's coordinates are updated.\n * @param {Array<ol.coordinate>} coordinates\n * @param {ol_geom_Polygon} geometry\n * @return {ol_geom_Polygon}\n * @private\n */\nol_interaction_DrawHole.prototype._geometryFn = function(coordinates, geometry) {\n  var coord = coordinates[0].pop();\n  if (!this.getPolygon() || this.getPolygon().intersectsCoordinate(coord)) {\n    this.lastOKCoord = [coord[0],coord[1]];\n  }\n  coordinates[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]);\n\n  if (geometry) {\n    geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n  } else {\n    geometry = new ol_geom_Polygon(coordinates);\n  }\n  return geometry;\n};\n\nexport default ol_interaction_DrawHole\n","import ol_ext_inherits from '../util/ext'\nimport {shiftKeyOnly as ol_events_condition_shiftKeyOnly} from 'ol/events/condition'\nimport {click as ol_events_condition_click} from 'ol/events/condition'\nimport ol_interaction_Draw from 'ol/interaction/Draw'\nimport ol_geom_LineString from 'ol/geom/LineString'\nimport ol_geom_Polygon from 'ol/geom/Polygon'\nimport ol_interaction_Select from 'ol/interaction/Select'\n\nimport ol_control_Bar from './Bar'\nimport ol_control_Button from './Button'\nimport ol_control_Toggle from './Toggle'\nimport ol_control_TextButton from './TextButton'\nimport ol_interaction_Delete from '../interaction/Delete'\nimport ol_ext_element from '../util/element'\nimport ol_interaction_Offset from '../interaction/Offset'\nimport ol_interaction_Split from '../interaction/Split'\nimport ol_interaction_Transform from '../interaction/Transform'\nimport ol_interaction_ModifyFeature from '../interaction/ModifyFeature'\nimport ol_interaction_DrawRegular from '../interaction/DrawRegular'\nimport ol_interaction_DrawHole from '../interaction/DrawHole'\n\n/** Control bar for editing in a layer\n * @constructor\n * @extends {ol_control_Bar}\n * @fires info\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {boolean} options.edition false to remove the edition tools, default true\n *\t@param {Object} options.interactions List of interactions to add to the bar \n *    ie. Select, Delete, Info, DrawPoint, DrawLine, DrawPolygon\n *    Each interaction can be an interaction or true (to get the default one) or false to remove it from bar\n *\t@param {ol.source.Vector} options.source Source for the drawn features. \n */\nvar ol_control_EditBar = function(options) {\n  options = options || {};\n  options.interactions = options.interactions || {};\n\n  // New bar\n\tol_control_Bar.call(this, {\n    className: (options.className ? options.className+' ': '') + 'ol-editbar',\n    toggleOne: true,\n\t\ttarget: options.target\n  });\n\n  this._source = options.source;\n  // Add buttons / interaction\n  this._interactions = {};\n  this._setSelectInteraction(options);\n  if (options.edition!==false) this._setEditInteraction(options);\n  this._setModifyInteraction(options);\n};\nol_ext_inherits(ol_control_EditBar, ol_control_Bar);\n\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_EditBar.prototype.setMap = function (map) {\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().removeInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().removeInteraction(this._interactions.ModifySelect);\n  }\n  \n  ol_control_Bar.prototype.setMap.call(this, map);\n\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().addInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().addInteraction(this._interactions.ModifySelect);\n  }\n};\n\n/** Get an interaction associated with the bar\n * @param {string} name \n */\nol_control_EditBar.prototype.getInteraction = function (name) {\n  return this._interactions[name];\n};\n\n/** Get the option title */\nol_control_EditBar.prototype._getTitle = function (option) {\n  return (option && option.title) ? option.title : option;\n};\n\n/** Add selection tool:\n * 1. a toggle control with a select interaction\n * 2. an option bar to delete / get information on the selected feature\n * @private\n */\nol_control_EditBar.prototype._setSelectInteraction = function (options) {\n  var self = this;\n  \n  // Sub bar\n  var sbar = new ol_control_Bar();\n  var selectCtrl;\n\n  // Delete button\n  if (options.interactions.Delete !== false) {\n    if (options.interactions.Delete instanceof ol_interaction_Delete) {\n      this._interactions.Delete = options.interactions.Delete; \n    } else {\n      this._interactions.Delete = new ol_interaction_Delete();\n    }\n    var del = this._interactions.Delete;\n    del.setActive(false);\n    if (this.getMap()) this.getMap().addInteraction(del);\n    sbar.addControl (new ol_control_Button({\n      className: 'ol-delete',\n      title: this._getTitle(options.interactions.Delete) || \"Delete\",\n      handleClick: function(e) {\n        // Delete selection\n        del.delete(selectCtrl.getInteraction().getFeatures());\n        console.log('del')\n        var evt = {\n          type: 'select',\n          selected: [],\n          deselected: selectCtrl.getInteraction().getFeatures().getArray().slice(),\n          mapBrowserEvent: e.mapBrowserEvent\n        };\n        selectCtrl.getInteraction().getFeatures().clear();\n        selectCtrl.getInteraction().dispatchEvent(evt);\n      }\n    }));\n  }\n\n  // Info button\n  if (options.interactions.Info !== false) {\n    sbar.addControl (new ol_control_Button({\n      className: 'ol-info',\n      title: this._getTitle(options.interactions.Info) || \"Show informations\",\n      handleClick: function() {\n        self.dispatchEvent({ \n          type: 'info', \n          features: selectCtrl.getInteraction().getFeatures() \n        });\n      }\n    }));\n  }\n\n  // Select button\n  if (options.interactions.Select !== false) {\n    if (options.interactions.Select instanceof ol_interaction_Select) {\n      this._interactions.Select = options.interactions.Select\n    } else {\n      this._interactions.Select = new ol_interaction_Select({\n        condition: ol_events_condition_click\n      });\n    }\n    var sel = this._interactions.Select;\n    selectCtrl = new ol_control_Toggle({\n      className: 'ol-selection',\n      title: this._getTitle(options.interactions.Select) || \"Select\",\n      interaction: sel,\n      bar: sbar.getControls().length ? sbar : undefined,\n      autoActivate:true,\n      active:true\n    });\n\n    this.addControl(selectCtrl);\n    sel.on('change:active', function() {\n      sel.getFeatures().clear();\n    });\n  }\n};\n\n\n/** Add editing tools\n * @private\n */ \nol_control_EditBar.prototype._setEditInteraction = function (options) {\n  if (options.interactions.DrawPoint !== false) {\n    if (options.interactions.DrawPoint instanceof ol_interaction_Draw) {\n      this._interactions.DrawPoint = options.interactions.DrawPoint;\n    } else {\n      this._interactions.DrawPoint = new ol_interaction_Draw({\n        type: 'Point',\n        source: this._source\n      });\n    }\n    var pedit = new ol_control_Toggle({\n      className: 'ol-drawpoint',\n      title: this._getTitle(options.interactions.DrawPoint) || 'Point',\n      interaction: this._interactions.DrawPoint\n    });\n    this.addControl ( pedit );\n  }\n\n  if (options.interactions.DrawLine !== false) {\n    if (options.interactions.DrawLine instanceof ol_interaction_Draw) {\n      this._interactions.DrawLine = options.interactions.DrawLine\n    } else {\n      this._interactions.DrawLine = new ol_interaction_Draw ({\n        type: 'LineString',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          if (geometry) geometry.setCoordinates(coordinates);\n          else geometry = new ol_geom_LineString(coordinates);\n          this.nbpts = geometry.getCoordinates().length;\n          return geometry;\n        }\n      });\n    }\n    var ledit = new ol_control_Toggle({\n      className: 'ol-drawline',\n      title: this._getTitle(options.interactions.DrawLine) || 'LineString',\n      interaction: this._interactions.DrawLine,\n      // Options bar associated with the control\n      bar: new ol_control_Bar ({\n        controls:[ \n          new ol_control_TextButton({\n            html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n            title: this._getTitle(options.interactions.UndoDraw) || \"delete last point\",\n            handleClick: function() {\n              if (ledit.getInteraction().nbpts>1) ledit.getInteraction().removeLastPoint();\n            }\n          }),\n          new ol_control_TextButton ({\n            html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n            title: this._getTitle(options.interactions.FinishDraw) || \"finish\",\n            handleClick: function() {\n              // Prevent null objects on finishDrawing\n              if (ledit.getInteraction().nbpts>2) ledit.getInteraction().finishDrawing();\n            }\n          })\n        ]\n      }) \n    });\n\n    this.addControl ( ledit );\n  }\n\n  if (options.interactions.DrawPolygon !== false) {\n    if (options.interactions.DrawPolygon instanceof ol_interaction_Draw){\n      this._interactions.DrawPolygon = options.interactions.DrawPolygon\n    } else {\n      this._interactions.DrawPolygon = new ol_interaction_Draw ({\n        type: 'Polygon',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          this.nbpts = coordinates[0].length;\n          if (geometry) geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n          else geometry = new ol_geom_Polygon(coordinates);\n          return geometry;\n        }\n      });\n    }\n    this._setDrawPolygon(\n      'ol-drawpolygon', \n      this._interactions.DrawPolygon, \n      this._getTitle(options.interactions.DrawPolygon) || 'Polygon', \n      options\n    );\n  }\n\n  // Draw hole\n  if (options.interactions.DrawHole !== false) {\n    if (options.interactions.DrawHole instanceof ol_interaction_DrawHole){\n      this._interactions.DrawHole = options.interactions.DrawHole;\n    } else {\n      this._interactions.DrawHole = new ol_interaction_DrawHole ();\n    }\n    this._setDrawPolygon(\n      'ol-drawhole', \n      this._interactions.DrawHole, \n      this._getTitle(options.interactions.DrawHole) || 'Hole', \n      options\n    );\n  }\n\n  // Draw regular\n  if (options.interactions.DrawRegular !== false) {\n    if (options.interactions.DrawRegular instanceof ol_interaction_DrawRegular) {\n      this._interactions.DrawRegular = options.interactions.DrawRegular\n    } else {\n      this._interactions.DrawRegular = new ol_interaction_DrawRegular ({\n        source: this._source,\n        sides: 4\n      });\n    }\n    var regular = this._interactions.DrawRegular;\n\n    var div = document.createElement('DIV');\n\n    var down = ol_ext_element.create('DIV', { parent: div });\n    ol_ext_element.addListener(down, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() -1;\n      if (sides < 2) sides = 2;\n      regular.setSides (sides);\n      text.textContent = sides>2 ? sides+' pts' : 'circle';\n    }.bind(this));\n\n    var text = ol_ext_element.create('TEXT', { html:'4 pts', parent: div });\n    \n    var up = ol_ext_element.create('DIV', { parent: div });\n    ol_ext_element.addListener(up, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() +1;\n      if (sides<3) sides=3;\n      regular.setSides(sides);\n      text.textContent = sides+' pts';\n    }.bind(this));\n\n    var ctrl = new ol_control_Toggle({\n      className: 'ol-drawregular',\n      title: this._getTitle(options.interactions.DrawRegular) || 'Regular',\n      interaction: this._interactions.DrawRegular,\n      // Options bar associated with the control\n      bar: new ol_control_Bar ({\n        controls:[ \n          new ol_control_TextButton({\n            html: div\n          })\n        ]\n      }) \n    });\n    this.addControl (ctrl);\n  }\n\n};\n\n/**\n * @private\n */\nol_control_EditBar.prototype._setDrawPolygon = function (className, interaction, title, options) {\n  var fedit = new ol_control_Toggle ({\n    className: className,\n    title: title,\n    interaction: interaction,\n    // Options bar associated with the control\n    bar: new ol_control_Bar({\n      controls:[ \n        new ol_control_TextButton ({\n          html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n          title: this._getTitle(options.interactions.UndoDraw) || 'undo last point',\n          handleClick: function(){\n            if (fedit.getInteraction().nbpts>1) fedit.getInteraction().removeLastPoint();\n          }\n        }),\n        new ol_control_TextButton({\n          html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          title: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          handleClick: function() {\n            // Prevent null objects on finishDrawing\n            if (fedit.getInteraction().nbpts>3) fedit.getInteraction().finishDrawing();\n          }\n        })\n      ]\n    }) \n  });\n  this.addControl (fedit);\n};\n\n/** Add modify tools\n * @private\n */ \nol_control_EditBar.prototype._setModifyInteraction = function (options) {\n  // Modify on selected features\n  if (options.interactions.ModifySelect !== false && options.interactions.Select !== false) {\n    if (options.interactions.ModifySelect instanceof ol_interaction_ModifyFeature) {\n      this._interactions.ModifySelect = options.interactions.ModifySelect;\n    } else {\n      this._interactions.ModifySelect = new ol_interaction_ModifyFeature({\n        features: this.getInteraction('Select').getFeatures()\n      });\n    }\n    if (this.getMap()) this.getMap().addInteraction(this._interactions.ModifySelect);\n    // Activate with select\n    this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    this._interactions.Select.on('change:active', function() {\n      this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    }.bind(this));\n  }\n\n  if (options.interactions.Transform !== false) {\n    if (options.interactions.Transform instanceof ol_interaction_Transform) {\n      this._interactions.Transform = options.interactions.Transform;\n    } else {\n      this._interactions.Transform = new ol_interaction_Transform ({\n        addCondition: ol_events_condition_shiftKeyOnly\n      });\n    }\n    var transform = new ol_control_Toggle ({\n      html: '<i></i>',\n      className: 'ol-transform',\n      title: this._getTitle(options.interactions.Transform) || 'Transform',\n      interaction: this._interactions.Transform\n    });\n    this.addControl (transform);\n  }\n\n  if (options.interactions.Split !== false) {\n    if (options.interactions.Split instanceof ol_interaction_Split) {\n      this._interactions.Split = options.interactions.Split;\n    } else {\n      this._interactions.Split = new ol_interaction_Split ({\n          sources: this._source\n      });\n    }\n    var split = new ol_control_Toggle ({\n      className: 'ol-split',\n      title: this._getTitle(options.interactions.Split) || 'Split',\n      interaction: this._interactions.Split\n    });\n    this.addControl (split);\n  }\n\n  if (options.interactions.Offset !== false) {\n    if (options.interactions.Offset instanceof ol_interaction_Offset) {\n      this._interactions.Offset = options.interactions.Offset;\n    } else {\n      this._interactions.Offset = new ol_interaction_Offset ({\n          source: this._source\n      });\n    }\n    var offset = new ol_control_Toggle ({\n      html: '<i></i>',\n      className: 'ol-offset',\n      title: this._getTitle(options.interactions.Offset) || 'Offset',\n      interaction: this._interactions.Offset\n    });\n    this.addControl (offset);\n  }\n\n};\n\nexport default ol_control_EditBar\n","/*\tCopyright (c) 2015 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Control from 'ol/control/Control'\n\n/**\n * @classdesc Swipe Control.\n *\n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} Control options.\n *\t@param {ol.layer} options.layers layer to swipe\n *\t@param {ol.layer} options.rightLayer layer to swipe on right side\n *\t@param {string} options.className control class name\n *\t@param {number} options.position position propertie of the swipe [0,1], default 0.5\n *\t@param {string} options.orientation orientation propertie (vertical|horizontal), default vertical\n */\nvar ol_control_Swipe = function(options) {\n\toptions = options || {};\n\n\tvar button = document.createElement('button');\n\n\tvar element = document.createElement('div');\n  element.className = (options.className || \"ol-swipe\") + \" ol-unselectable ol-control\";\n  element.appendChild(button);\n\n\telement.addEventListener(\"mousedown\", this.move.bind(this));\n\telement.addEventListener(\"touchstart\", this.move.bind(this));\n\n\tol_control_Control.call(this, {\n    element: element\n\t});\n\n\t// An array of listener on layer postcompose\n\tthis.precomposeRight_ = this.precomposeRight.bind(this);\n\tthis.precomposeLeft_ = this.precomposeLeft.bind(this);\n\tthis.postcompose_ = this.postcompose.bind(this);\n\n\tthis.layers = [];\n\tif (options.layers) this.addLayer(options.layers, false);\n\tif (options.rightLayers) this.addLayer(options.rightLayers, true);\n\n\tthis.on('propertychange', function() {\n    if (this.getMap()) this.getMap().renderSync();\n\t\tif (this.get('orientation') === \"horizontal\") {\n      this.element.style.top = this.get('position')*100+\"%\";\n\t\t\tthis.element.style.left = \"\";\n\t\t} else {\n      if (this.get('orientation') !== \"vertical\") this.set('orientation', \"vertical\");\n\t\t\tthis.element.style.left = this.get('position')*100+\"%\";\n\t\t\tthis.element.style.top = \"\";\n\t\t}\n\t\tthis.element.classList.remove(\"horizontal\", \"vertical\");\n\t\tthis.element.classList.add(this.get('orientation'));\n\t}.bind(this));\n\n\tthis.set('position', options.position || 0.5);\n\tthis.set('orientation', options.orientation || 'vertical');\n};\nol_ext_inherits(ol_control_Swipe, ol_control_Control);\n\n/**\n * Set the map instance the control associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_Swipe.prototype.setMap = function(map) {\n\tvar i;\n\tvar l;\n\n\tif (this.getMap()) {\n\t\tfor (i=0; i<this.layers.length; i++) {\n\t\t\tl = this.layers[i];\n\t\t\tif (l.right) l.layer.un(['precompose','prerender'], this.precomposeRight_);\n\t\t\telse l.layer.un(['precompose','prerender'], this.precomposeLeft_);\n\t\t\tl.layer.un(['postcompose','postrender'], this.postcompose_);\n\t\t}\n\t\tthis.getMap().renderSync();\n\t}\n\n\tol_control_Control.prototype.setMap.call(this, map);\n\n\tif (map) {\n    this._listener = [];\n\t\tfor (i=0; i<this.layers.length; i++) {\n      l = this.layers[i];\n\t\t\tif (l.right) l.layer.on(['precompose','prerender'], this.precomposeRight_);\n\t\t\telse l.layer.on(['precompose','prerender'], this.precomposeLeft_);\n\t\t\tl.layer.on(['postcompose','postrender'], this.postcompose_);\n\t\t}\n\t\tmap.renderSync();\n\t}\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.isLayer_ = function(layer){\n  for (var k=0; k<this.layers.length; k++) {\n    if (this.layers[k].layer === layer) return k;\n\t}\n\treturn -1;\n};\n\n/** Add a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*\t@param {bool} add layer in the right part of the map, default left.\n*/\nol_control_Swipe.prototype.addLayer = function(layers, right) {\n  if (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++) {\n\t\tvar l = layers[i];\n\t\tif (this.isLayer_(l) < 0) {\n      this.layers.push({ layer:l, right:right });\n\t\t\tif (this.getMap()) {\n        if (right) l.on(['precompose','prerender'], this.precomposeRight_);\n\t\t\t\telse l.on(['precompose','prerender'], this.precomposeLeft_);\n\t\t\t\tl.on(['postcompose','postrender'], this.postcompose_);\n\t\t\t\tthis.getMap().renderSync();\n\t\t\t}\n\t\t}\n\t}\n};\n\n/** Remove a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n */\nol_control_Swipe.prototype.removeLayer = function(layers) {\n  if (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++) {\n    var k = this.isLayer_(layers[i]);\n\t\tif (k >=0 && this.getMap()) {\n      if (this.layers[k].right) layers[i].un(['precompose','prerender'], this.precomposeRight_);\n\t\t\telse layers[i].un(['precompose','prerender'], this.precomposeLeft_);\n\t\t\tlayers[i].un(['postcompose','postrender'], this.postcompose_);\n\t\t\tthis.layers.splice(k,1);\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t}\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.move = function(e) {\n\tvar self = this;\n\tvar l;\n\tswitch (e.type) {\n    case 'touchcancel':\n\t\tcase 'touchend':\n\t\tcase 'mouseup': {\n      self.isMoving = false;\n\t\t\t[\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n\t\t\t\t.forEach(function(eventName) {\n\t\t\t\t\tdocument.removeEventListener(eventName, self.move);\n\t\t\t\t});\n\t\t\tbreak;\n\t\t}\n\t\tcase 'mousedown':\n\t\tcase 'touchstart': {\n\t\t\tself.isMoving = true;\n\t\t\t[\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n\t\t\t\t.forEach(function(eventName) {\n\t\t\t\t\tdocument.addEventListener(eventName, self.move.bind(self));\n\t\t\t\t});\n\t\t}\n\t\t// fallthrough\n\t\tcase 'mousemove':\n\t\tcase 'touchmove': {\n      if (self.isMoving) {\n        if (self.get('orientation') === \"vertical\") {\n          var pageX = e.pageX\n\t\t\t\t\t\t|| (e.touches && e.touches.length && e.touches[0].pageX)\n\t\t\t\t\t\t|| (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n          if (!pageX) break;\n          pageX -= self.getMap().getTargetElement().getBoundingClientRect().left +\n            window.pageXOffset - document.documentElement.clientLeft;\n\n\t\t\t\t\tl = self.getMap().getSize()[0];\n\t\t\t\t\tl = Math.min(Math.max(0, 1-(l-pageX)/l), 1);\n\t\t\t\t\tself.set('position', l);\n\t\t\t\t} else {\n          var pageY = e.pageY\n\t\t\t\t\t\t|| (e.touches && e.touches.length && e.touches[0].pageY)\n\t\t\t\t\t\t|| (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n\t\t\t\t\tif (!pageY) break;\n\t\t\t\t\tpageY -= self.getMap().getTargetElement().getBoundingClientRect().top +\n\t\t\t\t\t\twindow.pageYOffset - document.documentElement.clientTop;\n\n\t\t\t\t\tl = self.getMap().getSize()[1];\n\t\t\t\t\tl = Math.min(Math.max(0, 1-(l-pageY)/l), 1);\n\t\t\t\t\tself.set('position', l);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.precomposeLeft = function(e) {\n  var ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\tctx.beginPath();\n\tif (this.get('orientation') === \"vertical\") ctx.rect (0,0, canvas.width*this.get('position'), canvas.height);\n\telse ctx.rect (0,0, canvas.width, canvas.height*this.get('position'));\n\tctx.clip();\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.precomposeRight = function(e) {\n  var ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\tctx.beginPath();\n\tif (this.get('orientation') === \"vertical\") ctx.rect (canvas.width*this.get('position'), 0, canvas.width, canvas.height);\n\telse ctx.rect (0,canvas.height*this.get('position'), canvas.width, canvas.height);\n\tctx.clip();\n};\n\n/** @private\n*/\nol_control_Swipe.prototype.postcompose = function(e) {\n  e.context.restore();\n};\n\nexport default ol_control_Swipe\n","import ol_source_Vector from 'ol/source/Vector'\n\n(function () {\n  var clear = ol_source_Vector.prototype.clear;\n\n  /** Overwrite ol/source/Vector clear to fire clearstart / clearend event\n   */\n  ol_source_Vector.prototype.clear = function(opt_fast) {\n    this.dispatchEvent({ type: 'clearstart' });\n    clear.call(this, opt_fast)\n    this.dispatchEvent({ type: 'clearend' });\n  };\n})();\n","import ol_ext_inherits from '../util/ext'\nimport ol_interaction_Interaction from 'ol/interaction/Interaction'\nimport ol_layer_Vector from 'ol/layer/Vector'\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\nimport '../source/Vector' \n\n/** Undo/redo interaction\n * @constructor\n * @extends {ol_interaction_Interaction}\n * @fires undo\n * @fires redo\n * @param {*} options\n */\nvar ol_interaction_UndoRedo = function(options) {\n  if (!options) options = {};\n\n\tol_interaction_Interaction.call(this, {\t\n    handleEvent: function() { \n      return true; \n    }\n  });\n\n  this._undoStack = [];\n  this._redoStack = [];\n  // Block counter\n  this._block = 0;\n  // Start recording\n  this._record = true;\n  // Custom definitions\n  this._defs = {};\n};\nol_ext_inherits(ol_interaction_UndoRedo, ol_interaction_Interaction);\n\n/** Add a custom undo/redo\n * @param {string} action the action key name\n * @param {function} undoFn function called when undoing\n * @param {function} redoFn function called when redoing\n * @api\n */\nol_interaction_UndoRedo.prototype.define = function(action, undoFn, redoFn) {\n  this._defs['_'+action] = { undo: undoFn, redo: redoFn };\n};\n\n/** Set a custom undo/redo\n * @param {string} action the action key name\n * @param {any} prop an object that will be passed in the undo/redo fucntions of the action\n * @return {boolean} true if the action is defined\n */\nol_interaction_UndoRedo.prototype.push = function(action, prop) {\n  if (this._defs['_'+action]) {\n    this._undoStack.push({type: '_'+action, prop: prop });\n    return true;\n  } else {\n    return false;\n  }\n};\n\n/** Activate or deactivate the interaction, ie. records or not events on the map.\n * @param {boolean} active\n * @api stable\n */\nol_interaction_UndoRedo.prototype.setActive = function(active) {\n  ol_interaction_Interaction.prototype.setActive.call (this, active);\n  this._record = active;\n};\n\n/**\n * Remove the interaction from its current map, if any, and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol_interaction_UndoRedo.prototype.setMap = function(map) {\n  ol_interaction_Interaction.prototype.setMap.call (this, map);\n  // Watch sources\n  this._watchSources();\n  this._watchInteractions();\n};\n\n/** Watch for changes in the map sources\n * @private\n */\nol_interaction_UndoRedo.prototype._watchSources = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._sourceListener) {\n    this._sourceListener.forEach(function(l) { ol_Observable_unByKey(l); })\n  }\n  this._sourceListener = [];\n\n  // Ges vector layers \n  function getVectorLayers(layers, init) {\n    if (!init) init = [];\n    layers.forEach(function(l) {\n      if (l instanceof ol_layer_Vector) {\n        init.push(l);\n      } else if (l.getLayers) {\n        getVectorLayers(l.getLayers(), init);\n      }\n    });\n    return init;\n  }\n\n  if (map) {\n    // Watch the vector sources in the map \n    var vectors = getVectorLayers(map.getLayers());\n    vectors.forEach((function(l) {\n      var s = l.getSource();\n      this._sourceListener.push( s.on(['addfeature', 'removefeature'], this._onAddRemove.bind(this)) );\n      this._sourceListener.push( s.on('clearstart', this.blockStart.bind(this)) );\n      this._sourceListener.push( s.on('clearend', this.blockEnd.bind(this)) );\n    }).bind(this));\n\n    // Watch new inserted/removed\n    this._sourceListener.push( map.getLayers().on(['add', 'remove'], this._watchSources.bind(this) ) );\n  }\n};\n\n/** Watch for interactions\n * @private\n */\nol_interaction_UndoRedo.prototype._watchInteractions = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._interactionListener) {\n    this._interactionListener.forEach(function(l) { ol_Observable_unByKey(l); })\n  }\n  this._interactionListener = [];\n\n  if (map) {\n    // Watch the interactions in the map \n    map.getInteractions().forEach((function(i) {\n      this._interactionListener.push(i.on(\n        ['setattributestart', 'modifystart', 'rotatestart', 'translatestart', 'scalestart', 'deletestart', 'deleteend', 'beforesplit', 'aftersplit'], \n        this._onInteraction.bind(this)\n      ));\n    }).bind(this));\n\n    // Watch new inserted / unwatch removed\n    this._interactionListener.push( map.getInteractions().on(\n      ['add', 'remove'], \n      this._watchInteractions.bind(this)\n    ));\n  }\n};\n\n/** A feature is added / removed\n */\nol_interaction_UndoRedo.prototype._onAddRemove = function(e) {\n  if (this._record) {\n    this._undoStack.push({type: e.type, source: e.target, feature: e.feature });\n    this._redoStack = [];\n  }\n};\n\nol_interaction_UndoRedo.prototype._onInteraction = function(e) {\n  var fn = this._onInteraction[e.type];\n  if (fn) fn.call(this,e);\n};\n\n/** Set attribute\n * @private\n */\nol_interaction_UndoRedo.prototype._onInteraction.setattributestart = function(e) {\n  this.blockStart();\n  var newp = Object.assign({}, e.properties);\n  e.features.forEach(function(f) {\n    var oldp = {};\n    for (var p in newp) {\n      oldp[p] = f.get(p);\n    }\n    this._undoStack.push({\n      type: 'changeattribute', \n      feature: f, \n      newProperties: newp,\n      oldProperties: oldp\n    });\n  }.bind(this));\n  this.blockEnd();\n};\n\nol_interaction_UndoRedo.prototype._onInteraction.rotatestart = \nol_interaction_UndoRedo.prototype._onInteraction.translatestart = \nol_interaction_UndoRedo.prototype._onInteraction.scalestart = \nol_interaction_UndoRedo.prototype._onInteraction.modifystart = function (e) {\n  this.blockStart();\n  e.features.forEach(function(m) {\n    this._undoStack.push({type: 'changefeature', feature: m, oldFeature: m.clone()  });\n  }.bind(this));\n  this.blockEnd();\n};\n\n/** Start an undo block\n * @api\n */\nol_interaction_UndoRedo.prototype.blockStart = function () {\n  this._undoStack.push({ type: 'blockstart' });\n  this._redoStack = [];\n};\n\n/** @private\n */\nol_interaction_UndoRedo.prototype._onInteraction.beforesplit =\nol_interaction_UndoRedo.prototype._onInteraction.deletestart =\nol_interaction_UndoRedo.prototype.blockStart;\n\n/** End an undo block\n * @api\n */\nol_interaction_UndoRedo.prototype.blockEnd = function () {\n  this._undoStack.push({ type: 'blockend' });\n};\n\n/** @private\n */\nol_interaction_UndoRedo.prototype._onInteraction.aftersplit =\nol_interaction_UndoRedo.prototype._onInteraction.deleteend =\nol_interaction_UndoRedo.prototype.blockEnd;\n\n/** handle undo/redo\n * @private\n */\nol_interaction_UndoRedo.prototype._handleDo = function(e, undo) {\n  // Not active\n  if (!this.getActive()) return;\n\n  // Stop recording while undoing\n  this._record = false;\n  switch (e.type) {\n    case 'addfeature': {\n      if (undo) e.source.removeFeature(e.feature);\n      else e.source.addFeature(e.feature);\n      break;\n    }\n    case 'removefeature': {\n      if (undo) e.source.addFeature(e.feature);\n      else e.source.removeFeature(e.feature);\n      break;\n    }\n    case 'changefeature': {\n      var geom = e.feature.getGeometry();\n      e.feature.setGeometry(e.oldFeature.getGeometry());\n      e.oldFeature.setGeometry(geom);\n      break;\n    }\n    case 'changeattribute': {\n      var newp = e.newProperties;\n      var oldp = e.oldProperties;\n      for (var p in oldp) {\n        if (oldp === undefined) e.feature.unset(p);\n        else e.feature.set(p, oldp[p]);\n      }\n      e.oldProperties = newp;\n      e.newProperties = oldp;\n      break;\n    }\n    case 'blockstart': {\n      this._block += undo ? -1 : 1;\n      break;\n    }\n    case 'blockend': {\n      this._block += undo ? 1 : -1;\n      break;\n    }\n    default: {\n      if (this._defs[e.type]) {\n        if (undo) this._defs[e.type].undo(e.prop);\n        else this._defs[e.type].redo(e.prop);\n      } else {\n        console.warn('[UndoRedoInteraction]: \"'+e.type.substr(1)+'\" is not defined.');\n      }\n    }\n  }\n\n  // Handle block\n  if (this._block<0) this._block = 0;\n  if (this._block) {\n    if (undo) this.undo();\n    else this.redo();\n  }\n  this._record = true;\n\n  // Dispatch event\n  this.dispatchEvent( { \n    type: undo ? 'undo' : 'redo',\n    action: e\n  });\n};\n\n/** Undo last operation\n * @api\n */\nol_interaction_UndoRedo.prototype.undo = function() {\n  var e = this._undoStack.pop();\n  if (!e) return;\n  this._redoStack.push(e);\n  this._handleDo(e, true);\n};\n\n/** Redo last operation\n * @api\n */\nol_interaction_UndoRedo.prototype.redo = function() {\n  var e = this._redoStack.pop();\n  if (!e) return;\n  this._undoStack.push(e);\n  this._handleDo(e, false);\n};\n\n/** Clear undo stack\n * @api\n */\nol_interaction_UndoRedo.prototype.clear = function() {\n  this._undoStack = [];\n  this._redoStack = [];\n};\n\n/** Check if undo is avaliable\n * @return {number} the number of undo \n * @api\n */\nol_interaction_UndoRedo.prototype.hasUndo = function() {\n  return this._undoStack.length;\n};\n\n/** Check if redo is avaliable\n * @return {number} the number of redo\n * @api\n */\nol_interaction_UndoRedo.prototype.hasRedo = function() {\n  return this._redoStack.length;\n};\n\nexport default ol_interaction_UndoRedo\n","/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nvar Disposable = function Disposable() {\n  /**\n   * The object has already been disposed.\n   * @type {boolean}\n   * @private\n   */\n  this.disposed_ = false;\n};\n\n/**\n * Clean up.\n */\nDisposable.prototype.dispose = function dispose () {\n  if (!this.disposed_) {\n    this.disposed_ = true;\n    this.disposeInternal();\n  }\n};\n\n/**\n * Extension point for disposable objects.\n * @protected\n */\nDisposable.prototype.disposeInternal = function disposeInternal () {};\n\nexport default Disposable;\n\n//# sourceMappingURL=Disposable.js.map","/**\n * @module ol/TileRange\n */\n\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n */\nvar TileRange = function TileRange(minX, maxX, minY, maxY) {\n\n  /**\n   * @type {number}\n   */\n  this.minX = minX;\n\n  /**\n   * @type {number}\n   */\n  this.maxX = maxX;\n\n  /**\n   * @type {number}\n   */\n  this.minY = minY;\n\n  /**\n   * @type {number}\n   */\n  this.maxY = maxY;\n\n};\n\n/**\n * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @return {boolean} Contains tile coordinate.\n */\nTileRange.prototype.contains = function contains (tileCoord) {\n  return this.containsXY(tileCoord[1], tileCoord[2]);\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Contains.\n */\nTileRange.prototype.containsTileRange = function containsTileRange (tileRange) {\n  return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n     this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n};\n\n/**\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @return {boolean} Contains coordinate.\n */\nTileRange.prototype.containsXY = function containsXY (x, y) {\n  return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Equals.\n */\nTileRange.prototype.equals = function equals (tileRange) {\n  return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n     this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n */\nTileRange.prototype.extend = function extend (tileRange) {\n  if (tileRange.minX < this.minX) {\n    this.minX = tileRange.minX;\n  }\n  if (tileRange.maxX > this.maxX) {\n    this.maxX = tileRange.maxX;\n  }\n  if (tileRange.minY < this.minY) {\n    this.minY = tileRange.minY;\n  }\n  if (tileRange.maxY > this.maxY) {\n    this.maxY = tileRange.maxY;\n  }\n};\n\n/**\n * @return {number} Height.\n */\nTileRange.prototype.getHeight = function getHeight () {\n  return this.maxY - this.minY + 1;\n};\n\n/**\n * @return {import(\"./size.js\").Size} Size.\n */\nTileRange.prototype.getSize = function getSize () {\n  return [this.getWidth(), this.getHeight()];\n};\n\n/**\n * @return {number} Width.\n */\nTileRange.prototype.getWidth = function getWidth () {\n  return this.maxX - this.minX + 1;\n};\n\n/**\n * @param {TileRange} tileRange Tile range.\n * @return {boolean} Intersects.\n */\nTileRange.prototype.intersects = function intersects (tileRange) {\n  return this.minX <= tileRange.maxX &&\n     this.maxX >= tileRange.minX &&\n     this.minY <= tileRange.maxY &&\n     this.maxY >= tileRange.minY;\n};\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {TileRange=} tileRange TileRange.\n * @return {TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\nexport default TileRange;\n\n//# sourceMappingURL=TileRange.js.map","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\nvar MapBrowserPointerEvent = /*@__PURE__*/(function (MapBrowserEvent) {\n  function MapBrowserPointerEvent(type, map, pointerEvent, opt_dragging, opt_frameState) {\n\n    MapBrowserEvent.call(this, type, map, pointerEvent.originalEvent, opt_dragging, opt_frameState);\n\n    /**\n     * @const\n     * @type {import(\"./pointer/PointerEvent.js\").default}\n     */\n    this.pointerEvent = pointerEvent;\n\n  }\n\n  if ( MapBrowserEvent ) MapBrowserPointerEvent.__proto__ = MapBrowserEvent;\n  MapBrowserPointerEvent.prototype = Object.create( MapBrowserEvent && MapBrowserEvent.prototype );\n  MapBrowserPointerEvent.prototype.constructor = MapBrowserPointerEvent;\n\n  return MapBrowserPointerEvent;\n}(MapBrowserEvent));\n\nexport default MapBrowserPointerEvent;\n\n//# sourceMappingURL=MapBrowserPointerEvent.js.map","/**\n * @module ol/Object\n */\nimport {getUid} from './util.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of this type.\n */\nexport var ObjectEvent = /*@__PURE__*/(function (Event) {\n  function ObjectEvent(type, key, oldValue) {\n    Event.call(this, type);\n\n    /**\n     * The name of the property whose value is changing.\n     * @type {string}\n     * @api\n     */\n    this.key = key;\n\n    /**\n     * The old value. To get the new value use `e.target.get(e.key)` where\n     * `e` is the event object.\n     * @type {*}\n     * @api\n     */\n    this.oldValue = oldValue;\n\n  }\n\n  if ( Event ) ObjectEvent.__proto__ = Event;\n  ObjectEvent.prototype = Object.create( Event && Event.prototype );\n  ObjectEvent.prototype.constructor = ObjectEvent;\n\n  return ObjectEvent;\n}(Event));\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @fires ObjectEvent\n * @api\n */\nvar BaseObject = /*@__PURE__*/(function (Observable) {\n  function BaseObject(opt_values) {\n    Observable.call(this);\n\n    // Call {@link module:ol/util~getUid} to ensure that the order of objects' ids is\n    // the same as the order in which they were created.  This also helps to\n    // ensure that object properties are always added in the same order, which\n    // helps many JavaScript engines generate faster code.\n    getUid(this);\n\n    /**\n     * @private\n     * @type {!Object<string, *>}\n     */\n    this.values_ = {};\n\n    if (opt_values !== undefined) {\n      this.setProperties(opt_values);\n    }\n  }\n\n  if ( Observable ) BaseObject.__proto__ = Observable;\n  BaseObject.prototype = Object.create( Observable && Observable.prototype );\n  BaseObject.prototype.constructor = BaseObject;\n\n  /**\n   * Gets a value.\n   * @param {string} key Key name.\n   * @return {*} Value.\n   * @api\n   */\n  BaseObject.prototype.get = function get (key) {\n    var value;\n    if (this.values_.hasOwnProperty(key)) {\n      value = this.values_[key];\n    }\n    return value;\n  };\n\n  /**\n   * Get a list of object property names.\n   * @return {Array<string>} List of property names.\n   * @api\n   */\n  BaseObject.prototype.getKeys = function getKeys () {\n    return Object.keys(this.values_);\n  };\n\n  /**\n   * Get an object of all property names and values.\n   * @return {Object<string, *>} Object.\n   * @api\n   */\n  BaseObject.prototype.getProperties = function getProperties () {\n    return assign({}, this.values_);\n  };\n\n  /**\n   * @param {string} key Key name.\n   * @param {*} oldValue Old value.\n   */\n  BaseObject.prototype.notify = function notify (key, oldValue) {\n    var eventType;\n    eventType = getChangeEventType(key);\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    eventType = ObjectEventType.PROPERTYCHANGE;\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  };\n\n  /**\n   * Sets a value.\n   * @param {string} key Key name.\n   * @param {*} value Value.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.set = function set (key, value, opt_silent) {\n    if (opt_silent) {\n      this.values_[key] = value;\n    } else {\n      var oldValue = this.values_[key];\n      this.values_[key] = value;\n      if (oldValue !== value) {\n        this.notify(key, oldValue);\n      }\n    }\n  };\n\n  /**\n   * Sets a collection of key-value pairs.  Note that this changes any existing\n   * properties and adds new ones (it does not remove any existing properties).\n   * @param {Object<string, *>} values Values.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.setProperties = function setProperties (values, opt_silent) {\n    for (var key in values) {\n      this.set(key, values[key], opt_silent);\n    }\n  };\n\n  /**\n   * Unsets a property.\n   * @param {string} key Key name.\n   * @param {boolean=} opt_silent Unset without triggering an event.\n   * @api\n   */\n  BaseObject.prototype.unset = function unset (key, opt_silent) {\n    if (key in this.values_) {\n      var oldValue = this.values_[key];\n      delete this.values_[key];\n      if (!opt_silent) {\n        this.notify(key, oldValue);\n      }\n    }\n  };\n\n  return BaseObject;\n}(Observable));\n\n\n/**\n * @type {Object<string, string>}\n */\nvar changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\nexport default BaseObject;\n\n//# sourceMappingURL=Object.js.map","/**\n * @module ol/Collection\n */\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nvar Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n */\nexport var CollectionEvent = /*@__PURE__*/(function (Event) {\n  function CollectionEvent(type, opt_element) {\n    Event.call(this, type);\n\n    /**\n     * The element that is added to or removed from the collection.\n     * @type {*}\n     * @api\n     */\n    this.element = opt_element;\n\n  }\n\n  if ( Event ) CollectionEvent.__proto__ = Event;\n  CollectionEvent.prototype = Object.create( Event && Event.prototype );\n  CollectionEvent.prototype.constructor = CollectionEvent;\n\n  return CollectionEvent;\n}(Event));\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @fires CollectionEvent\n *\n * @template T\n * @api\n */\nvar Collection = /*@__PURE__*/(function (BaseObject) {\n  function Collection(opt_array, opt_options) {\n\n    BaseObject.call(this);\n\n    var options = opt_options || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.unique_ = !!options.unique;\n\n    /**\n     * @private\n     * @type {!Array<T>}\n     */\n    this.array_ = opt_array ? opt_array : [];\n\n    if (this.unique_) {\n      for (var i = 0, ii = this.array_.length; i < ii; ++i) {\n        this.assertUnique_(this.array_[i], i);\n      }\n    }\n\n    this.updateLength_();\n\n  }\n\n  if ( BaseObject ) Collection.__proto__ = BaseObject;\n  Collection.prototype = Object.create( BaseObject && BaseObject.prototype );\n  Collection.prototype.constructor = Collection;\n\n  /**\n   * Remove all elements from the collection.\n   * @api\n   */\n  Collection.prototype.clear = function clear () {\n    while (this.getLength() > 0) {\n      this.pop();\n    }\n  };\n\n  /**\n   * Add elements to the collection.  This pushes each item in the provided array\n   * to the end of the collection.\n   * @param {!Array<T>} arr Array.\n   * @return {Collection<T>} This collection.\n   * @api\n   */\n  Collection.prototype.extend = function extend (arr) {\n    for (var i = 0, ii = arr.length; i < ii; ++i) {\n      this.push(arr[i]);\n    }\n    return this;\n  };\n\n  /**\n   * Iterate over each element, calling the provided callback.\n   * @param {function(T, number, Array<T>): *} f The function to call\n   *     for every element. This function takes 3 arguments (the element, the\n   *     index and the array). The return value is ignored.\n   * @api\n   */\n  Collection.prototype.forEach = function forEach (f) {\n    var array = this.array_;\n    for (var i = 0, ii = array.length; i < ii; ++i) {\n      f(array[i], i, array);\n    }\n  };\n\n  /**\n   * Get a reference to the underlying Array object. Warning: if the array\n   * is mutated, no events will be dispatched by the collection, and the\n   * collection's \"length\" property won't be in sync with the actual length\n   * of the array.\n   * @return {!Array<T>} Array.\n   * @api\n   */\n  Collection.prototype.getArray = function getArray () {\n    return this.array_;\n  };\n\n  /**\n   * Get the element at the provided index.\n   * @param {number} index Index.\n   * @return {T} Element.\n   * @api\n   */\n  Collection.prototype.item = function item (index) {\n    return this.array_[index];\n  };\n\n  /**\n   * Get the length of this collection.\n   * @return {number} The length of the array.\n   * @observable\n   * @api\n   */\n  Collection.prototype.getLength = function getLength () {\n    return this.get(Property.LENGTH);\n  };\n\n  /**\n   * Insert an element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  Collection.prototype.insertAt = function insertAt (index, elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    this.array_.splice(index, 0, elem);\n    this.updateLength_();\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem));\n  };\n\n  /**\n   * Remove the last element of the collection and return it.\n   * Return `undefined` if the collection is empty.\n   * @return {T|undefined} Element.\n   * @api\n   */\n  Collection.prototype.pop = function pop () {\n    return this.removeAt(this.getLength() - 1);\n  };\n\n  /**\n   * Insert the provided element at the end of the collection.\n   * @param {T} elem Element.\n   * @return {number} New length of the collection.\n   * @api\n   */\n  Collection.prototype.push = function push (elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    var n = this.getLength();\n    this.insertAt(n, elem);\n    return this.getLength();\n  };\n\n  /**\n   * Remove the first occurrence of an element from the collection.\n   * @param {T} elem Element.\n   * @return {T|undefined} The removed element or undefined if none found.\n   * @api\n   */\n  Collection.prototype.remove = function remove (elem) {\n    var arr = this.array_;\n    for (var i = 0, ii = arr.length; i < ii; ++i) {\n      if (arr[i] === elem) {\n        return this.removeAt(i);\n      }\n    }\n    return undefined;\n  };\n\n  /**\n   * Remove the element at the provided index and return it.\n   * Return `undefined` if the collection does not contain this index.\n   * @param {number} index Index.\n   * @return {T|undefined} Value.\n   * @api\n   */\n  Collection.prototype.removeAt = function removeAt (index) {\n    var prev = this.array_[index];\n    this.array_.splice(index, 1);\n    this.updateLength_();\n    this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev));\n    return prev;\n  };\n\n  /**\n   * Set the element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  Collection.prototype.setAt = function setAt (index, elem) {\n    var n = this.getLength();\n    if (index < n) {\n      if (this.unique_) {\n        this.assertUnique_(elem, index);\n      }\n      var prev = this.array_[index];\n      this.array_[index] = elem;\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.REMOVE, prev));\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.ADD, elem));\n    } else {\n      for (var j = n; j < index; ++j) {\n        this.insertAt(j, undefined);\n      }\n      this.insertAt(index, elem);\n    }\n  };\n\n  /**\n   * @private\n   */\n  Collection.prototype.updateLength_ = function updateLength_ () {\n    this.set(Property.LENGTH, this.array_.length);\n  };\n\n  /**\n   * @private\n   * @param {T} elem Element.\n   * @param {number=} opt_except Optional index to ignore.\n   */\n  Collection.prototype.assertUnique_ = function assertUnique_ (elem, opt_except) {\n    for (var i = 0, ii = this.array_.length; i < ii; ++i) {\n      if (this.array_[i] === elem && i !== opt_except) {\n        throw new AssertionError(58);\n      }\n    }\n  };\n\n  return Collection;\n}(BaseObject));\n\n\nexport default Collection;\n\n//# sourceMappingURL=Collection.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Control from 'ol/control/Control'\n\nimport ol_ext_element from '../util/element'\n\n/** A simple push button control\n* @constructor\n* @extends {ol_control_Control}\n* @param {Object=} options Control options.\n*\t@param {String} options.className class of the control\n*\t@param {String} options.title title of the control\n*\t@param {String} options.name an optional name, default none\n*\t@param {String} options.html html to insert in the control\n*\t@param {function} options.handleClick callback when control is clicked (or use change:active event)\n*/\nvar ol_control_Button = function(options)\n{\toptions = options || {};\n\n\tvar element = document.createElement(\"div\");\n\telement.className = (options.className || '') + \" ol-button ol-unselectable ol-control\";\n\tvar self = this;\n\n\tvar bt = this.button_ = document.createElement(/ol-text-button/.test(options.className) ? \"div\": \"button\");\n\tbt.type = \"button\";\n\tif (options.title) bt.title = options.title;\n\tif (options.html instanceof Element) bt.appendChild(options.html)\n\telse bt.innerHTML = options.html || \"\";\n\tvar evtFunction = function(e) {\n\t\tif (e && e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t\tif (options.handleClick) {\n\t\t\toptions.handleClick.call(self, e);\n\t\t}\n\t};\n\tbt.addEventListener(\"click\", evtFunction);\n\tbt.addEventListener(\"touchstart\", evtFunction);\n\telement.appendChild(bt);\n\n\t// Try to get a title in the button content\n\tif (!options.title && bt.firstElementChild) {\n\t\tbt.title = bt.firstElementChild.title;\n\t}\n\n\tol_control_Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\n\tif (options.title) {\n\t\tthis.set(\"title\", options.title);\n\t}\n\tif (options.title) this.set(\"title\", options.title);\n\tif (options.name) this.set(\"name\", options.name);\n};\nol_ext_inherits(ol_control_Button, ol_control_Control);\n\n/** Set the control visibility\n* @param {boolean} b \n*/\nol_control_Button.prototype.setVisible = function (val) {\n\tif (val) ol_ext_element.show(this.element);\n\telse ol_ext_element.hide(this.element);\n}\n\n/**\n * Set the button title\n * @param {string} title\n * @returns {undefined}\n */\nol_control_Button.prototype.setTitle = function(title) {\n    this.button_.setAttribute('title', title);\n};\n\n/**\n * Set the button html\n * @param {string} html\n * @returns {undefined}\n */\nol_control_Button.prototype.setHtml = function(html) {\n\tol_ext_element.setHTML (this.button_, html);\n};\n\nexport default ol_control_Button\n","/**\n * @module ol/ImageBase\n */\nimport {abstract} from './util.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @abstract\n */\nvar ImageBase = /*@__PURE__*/(function (EventTarget) {\n  function ImageBase(extent, resolution, pixelRatio, state) {\n\n    EventTarget.call(this);\n\n    /**\n     * @protected\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.extent = extent;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number|undefined}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = state;\n\n  }\n\n  if ( EventTarget ) ImageBase.__proto__ = EventTarget;\n  ImageBase.prototype = Object.create( EventTarget && EventTarget.prototype );\n  ImageBase.prototype.constructor = ImageBase;\n\n  /**\n   * @protected\n   */\n  ImageBase.prototype.changed = function changed () {\n    this.dispatchEvent(EventType.CHANGE);\n  };\n\n  /**\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  ImageBase.prototype.getExtent = function getExtent () {\n    return this.extent;\n  };\n\n  /**\n   * @abstract\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   */\n  ImageBase.prototype.getImage = function getImage () {\n    return abstract();\n  };\n\n  /**\n   * @return {number} PixelRatio.\n   */\n  ImageBase.prototype.getPixelRatio = function getPixelRatio () {\n    return this.pixelRatio_;\n  };\n\n  /**\n   * @return {number} Resolution.\n   */\n  ImageBase.prototype.getResolution = function getResolution () {\n    return /** @type {number} */ (this.resolution);\n  };\n\n  /**\n   * @return {import(\"./ImageState.js\").default} State.\n   */\n  ImageBase.prototype.getState = function getState () {\n    return this.state;\n  };\n\n  /**\n   * Load not yet loaded URI.\n   * @abstract\n   */\n  ImageBase.prototype.load = function load () {\n    abstract();\n  };\n\n  return ImageBase;\n}(EventTarget));\n\n\nexport default ImageBase;\n\n//# sourceMappingURL=ImageBase.js.map","/**\n * @module ol/ImageCanvas\n */\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error=))} Loader\n */\n\n\nvar ImageCanvas = /*@__PURE__*/(function (ImageBase) {\n  function ImageCanvas(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n    var state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n    ImageBase.call(this, extent, resolution, pixelRatio, state);\n\n    /**\n     * Optional canvas loader function.\n     * @type {?Loader}\n     * @private\n     */\n    this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = canvas;\n\n    /**\n     * @private\n     * @type {Error}\n     */\n    this.error_ = null;\n\n  }\n\n  if ( ImageBase ) ImageCanvas.__proto__ = ImageBase;\n  ImageCanvas.prototype = Object.create( ImageBase && ImageBase.prototype );\n  ImageCanvas.prototype.constructor = ImageCanvas;\n\n  /**\n   * Get any error associated with asynchronous rendering.\n   * @return {Error} Any error that occurred during rendering.\n   */\n  ImageCanvas.prototype.getError = function getError () {\n    return this.error_;\n  };\n\n  /**\n   * Handle async drawing complete.\n   * @param {Error=} err Any error during drawing.\n   * @private\n   */\n  ImageCanvas.prototype.handleLoad_ = function handleLoad_ (err) {\n    if (err) {\n      this.error_ = err;\n      this.state = ImageState.ERROR;\n    } else {\n      this.state = ImageState.LOADED;\n    }\n    this.changed();\n  };\n\n  /**\n   * @inheritDoc\n   */\n  ImageCanvas.prototype.load = function load () {\n    if (this.state == ImageState.IDLE) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.loader_(this.handleLoad_.bind(this));\n    }\n  };\n\n  /**\n   * @return {HTMLCanvasElement} Canvas element.\n   */\n  ImageCanvas.prototype.getImage = function getImage () {\n    return this.canvas_;\n  };\n\n  return ImageCanvas;\n}(ImageBase));\n\n\nexport default ImageCanvas;\n\n//# sourceMappingURL=ImageCanvas.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n\nimport ol_ext_inherits from '../util/ext'\nimport ol_control_Control from 'ol/control/Control'\n\n/** Control bar for OL3\n * The control bar is a container for other controls. It can be used to create toolbars.\n * Control bars can be nested and combined with ol.control.Toggle to handle activate/deactivate.\n *\n * @constructor\n * @extends {ol_control_Control}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {bool} options.group is a group, default false\n *\t@param {bool} options.toggleOne only one toggle control is active at a time, default false\n *\t@param {bool} options.autoDeactivate used with subbar to deactivate all control when top level control deactivate, default false\n *\t@param {Array<_ol_control_>} options.controls a list of control to add to the bar\n */\nvar ol_control_Bar = function(options) {\n  if (!options) options={};\n\tvar element = document.createElement(\"div\");\n      element.classList.add('ol-unselectable', 'ol-control', 'ol-bar');\n\tif (options.className) {\n\t\tvar classes = options.className.split(' ').filter(function(className) {\n\t\t\treturn className.length > 0;\n\t\t});\n\t\telement.classList.add.apply(element.classList, classes)\n\t}\n\tif (options.group) element.classList.add('ol-group');\n\n\tol_control_Control.call(this, {\n    element: element,\n\t\ttarget: options.target\n\t});\n\n\tthis.set('toggleOne', options.toggleOne);\n\tthis.set('autoDeactivate', options.autoDeactivate);\n\n\tthis.controls_ = [];\n\tif (options.controls instanceof Array) {\n    for (var i=0; i<options.controls.length; i++) {\n      this.addControl(options.controls[i]);\n\t\t}\n\t}\n};\nol_ext_inherits(ol_control_Bar, ol_control_Control);\n\n/** Set the control visibility\n* @param {boolean} b\n*/\nol_control_Bar.prototype.setVisible = function (val) {\n\tif (val) this.element.style.display = '';\n\telse this.element.style.display = 'none';\n}\n\n/** Get the control visibility\n* @return {boolean} b\n*/\nol_control_Bar.prototype.getVisible = function () {\n  return this.element.style.display != 'none';\n}\n\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol_control_Bar.prototype.setMap = function (map) {\n  ol_control_Control.prototype.setMap.call(this, map);\n\n\tfor (var i=0; i<this.controls_.length; i++) {\n    var c = this.controls_[i];\n\t\t// map.addControl(c);\n\t\tc.setMap(map);\n\t}\n};\n\n/** Get controls in the panel\n*\t@param {Array<_ol_control_>}\n*/\nol_control_Bar.prototype.getControls = function () {\n  return this.controls_;\n};\n\n/** Set tool bar position\n*\t@param {top|left|bottom|right} pos\n*/\nol_control_Bar.prototype.setPosition = function (pos) {\n  this.element.classList.remove('ol-left', 'ol-top', 'ol-bottom', 'ol-right');\n\tpos=pos.split ('-');\n\tfor (var i=0; i<pos.length; i++) {\n    switch (pos[i]) {\n      case 'top':\n\t\t\tcase 'left':\n\t\t\tcase 'bottom':\n\t\t\tcase 'right':\n\t\t\t\tthis.element.classList.add(\"ol-\"+pos[i]);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t}\n};\n\n/** Add a control to the bar\n*\t@param {_ol_control_} c control to add\n*/\nol_control_Bar.prototype.addControl = function (c) {\n  this.controls_.push(c);\n\tc.setTarget(this.element);\n\tif (this.getMap()) {\n    this.getMap().addControl(c);\n\t}\n\t// Activate and toogleOne\n\tc.on ('change:active', this.onActivateControl_.bind(this));\n\tif (c.getActive && c.getActive()) {\n    c.dispatchEvent({ type:'change:active', key:'active', oldValue:false, active:true });\n\t}\n};\n\n/** Deativate all controls in a bar\n* @param {_ol_control_} except a control\n*/\nol_control_Bar.prototype.deactivateControls = function (except) {\n  for (var i=0; i<this.controls_.length; i++) {\n  if (this.controls_[i] !== except && this.controls_[i].setActive) {\n    this.controls_[i].setActive(false);\n\t\t}\n\t}\n};\n\n\nol_control_Bar.prototype.getActiveControls = function () {\n  var active = [];\n\tfor (var i=0, c; c=this.controls_[i]; i++) {\n    if (c.getActive && c.getActive()) active.push(c);\n\t}\n\treturn active;\n}\n\n/** Auto activate/deactivate controls in the bar\n* @param {boolean} b activate/deactivate\n*/\nol_control_Bar.prototype.setActive = function (b) {\n  if (!b && this.get(\"autoDeactivate\")) {\n    this.deactivateControls();\n\t}\n\tif (b) {\n    var ctrls = this.getControls();\n\t\tfor (var i=0, sb; (sb = ctrls[i]); i++) {\n      if (sb.get(\"autoActivate\")) sb.setActive(true);\n\t\t}\n\t}\n}\n\n/** Post-process an activated/deactivated control\n*\t@param {ol.event} e :an object with a target {_ol_control_} and active flag {bool}\n*/\nol_control_Bar.prototype.onActivateControl_ = function (e) {\n\tif (this.get('toggleOne')) {\n    if (e.active) {\n      var n;\n\t\t\tvar ctrl = e.target;\n\t\t\tfor (n=0; n<this.controls_.length; n++) {\n        if (this.controls_[n]===ctrl) break;\n\t\t\t}\n\t\t\t// Not here!\n\t\t\tif (n==this.controls_.length) return;\n\t\t\tthis.deactivateControls (this.controls_[n]);\n\t\t} else {\n      // No one active > test auto activate\n\t\t\tif (!this.getActiveControls().length) {\n        for (var i=0, c; c=this.controls_[i]; i++) {\n          if (c.get(\"autoActivate\")) {\n            c.setActive(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n/**\n * @param {string} name of the control to search\n * @return {ol.control.Control}\n */\nol_control_Bar.prototype.getControlsByName = function(name) {\n\tvar controls = this.getControls();\n\treturn controls.filter(\n\t\tfunction(control) {\n\t\t\treturn (control.get('name') === name);\n\t\t}\n\t);\n};\n\nexport default ol_control_Bar\n"],"sourceRoot":""}